# ===================================
# Push Delivery Worker (Render Blueprint)
# שירות Node קטן לשליחת Web Push באמצעות web-push
# ===================================

services:
  - type: web
    name: code-keeper-push-worker
    env: docker
    plan: starter
    dockerfilePath: push_worker/Dockerfile
    # מומלץ: חבר קבוצה של משתני סביבה (Environment Group) כדי לטעון סודות אוטומטית בכל דפלוי
    # צור פעם אחת ברנדר קבוצה בשם: code-keeper-push-worker-secrets
    # עם המפתחות: PUSH_DELIVERY_TOKEN, WORKER_VAPID_PUBLIC_KEY, WORKER_VAPID_PRIVATE_KEY, WORKER_VAPID_SUB_EMAIL
    envVarGroups:
      - name: code-keeper-push-worker-secrets
    envVars:
      - key: PORT
        value: 8080
      # הזינו את הסודות האמיתיים ב-Render UI (לא בקובץ):
      - key: PUSH_DELIVERY_TOKEN
        sync: false
      - key: VAPID_PUBLIC_KEY
        sync: false
      - key: VAPID_PRIVATE_KEY
        sync: false
      - key: VAPID_SUB_EMAIL
        value: support@example.com
    autoDeploy: true
    healthCheckPath: /healthz
