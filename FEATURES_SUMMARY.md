# מסמך מסכם - כל הפיצ'רים של CodeBot

> תיעוד מקיף של כל התכונות והיכולות של הבוט וה-Web App
> תאריך עדכון: נובמבר 2025
> גרסה: 1.0.0

---

## 📖 תוכן עניינים

1. [סקירה כללית](#סקירה-כללית)
2. [ארכיטקטורה ומבנה הפרויקט](#ארכיטכטורה-ומבנה-הפרויקט)
3. [פיצ'רים של הבוט (Telegram)](#פיצרים-של-הבוט-telegram)
4. [פיצ'רים של ה-Web App](#פיצרים-של-ה-web-app)
5. [טכנולוגיות ותשתית](#טכנולוגיות-ותשתית)
6. [אבטחה ומעקב](#אבטחה-ומעקב)

---

## 🎯 סקירה כללית

**CodeBot (Code Keeper Bot)** הוא פתרון מקיף לניהול, ארגון ושיתוף קטעי קוד דרך בוט טלגרם ואפליקציית ווב מתקדמת.

### מידע כללי על הפרויקט
- **שפת תכנות**: Python 3.11+
- **מסד נתונים**: MongoDB
- **Web Framework**: Flask
- **רישיון**: MIT
- **Repository**: [amirbiron/CodeBot](https://github.com/amirbiron/CodeBot)

### תכונות מרכזיות
- ✅ ניהול קבצי קוד עם ניהול גרסאות
- ✅ סינטקס הייליטינג ל-100+ שפות תכנות
- ✅ אינטגרציה מלאה עם GitHub ו-Google Drive
- ✅ חיפוש מתקדם (Regex, Fuzzy, Full-Text)
- ✅ מערכת גיבויים אוטומטית
- ✅ קהילת משתמשים ושיתוף קוד
- ✅ ממשק ווב מתקדם עם PWA
- ✅ מעקב אחר ביצועים ולוגים מובנים

---

## 🏗️ ארכיטכטורה ומבנה הפרויקט

### מבנה התיקיות הראשי

```
CodeBot/
├── main.py                          # נקודת הכניסה של הבוט (3,965 שורות)
├── bot_handlers.py                  # מטפלי פקודות ראשיים (3,375 שורות)
├── conversation_handlers.py         # זרימות שיחה (4,688 שורות)
├── github_menu_handler.py           # אינטגרציית GitHub (7,185 שורות)
├── backup_menu_handler.py           # מערכת גיבויים (834 שורות)
├── refactoring_engine.py            # מנוע רפקטורינג (701 שורות)
├── search_engine.py                 # מנוע חיפוש (885 שורות)
├── code_processor.py                # עיבוד וזיהוי קוד (1,071 שורות)
├── file_manager.py                  # ניהול קבצים (1,263 שורות)
├── cache_manager.py                 # שכבת מטמון (824 שורות)
├── observability.py                 # לוגים מובנים (824 שורות)
├── metrics.py                       # מטריקות Prometheus (900 שורות)
│
├── /database/                       # שכבת גישה למסד הנתונים
│   ├── repository.py                # DAL ראשי (89 KB)
│   ├── manager.py                   # מנהל פעולות DB (38 KB)
│   ├── collections_manager.py       # ניהול אוספים (54 KB)
│   └── bookmarks_manager.py         # ניהול סימניות (36 KB)
│
├── /handlers/                       # מטפלי שיחות מודולריים
│   ├── documents.py                 # טיפול במסמכים (42 KB)
│   ├── file_view.py                 # צפייה בקבצים (65 KB)
│   ├── save_flow.py                 # זרימת שמירה (21 KB)
│   └── drive/                       # אינטגרציית Google Drive
│
├── /services/                       # לוגיקה עסקית
│   ├── webserver.py                 # הגדרות Flask (15 KB)
│   ├── google_drive_service.py      # שירות Google Drive (39 KB)
│   ├── snippet_library_service.py   # ספריית קוד (37 KB)
│   ├── github_service.py            # שירות GitHub
│   └── backup_service.py            # שירות גיבויים
│
├── /webapp/                         # אפליקציית Web
│   ├── app.py                       # Flask App ראשי (244 KB)
│   ├── bookmarks_api.py             # API סימניות (26 KB)
│   ├── collections_api.py           # API אוספים (33 KB)
│   ├── sticky_notes_api.py          # API פתקים (26 KB)
│   ├── /static/                     # קבצים סטטיים (CSS, JS)
│   └── /templates/                  # תבניות HTML
│
├── /tests/                          # בדיקות מקיפות
├── /docs/                           # תיעוד Sphinx
├── /docker/                         # Docker & Docker Compose
├── /config/                         # קבצי הגדרות
└── /monitoring/                     # כלי מוניטורינג
```

### רכיבי המערכת

1. **Telegram Bot** - ממשק משתמש ראשי דרך טלגרם
2. **Flask Web App** - ממשק ווב ו-API
3. **MongoDB** - מסד נתונים מסמכים
4. **Redis** - שכבת מטמון
5. **Prometheus + Grafana** - ניטור וויזואליזציה
6. **Sentry** - מעקב שגיאות
7. **OpenTelemetry** - מעקב אחר ביצועים

---

## 🤖 פיצ'רים של הבוט (Telegram)

### 1️⃣ ניהול קבצים בסיסי

#### שמירת קבצים
- **הוספת קוד חדש** (`➕ הוסף קוד חדש`)
  - הדבקת קוד ישירה
  - העלאת מסמך (עד 20MB)
  - מצב קוד ארוך (מספר הודעות עם `/done`)
  - זיהוי אוטומטי של שפת התכנות
  - הוספת הערות ותיאור
  - תמיכה ב-ZIP files
  - תמיכה בקידודים שונים (UTF-8, Windows-1255, ISO-8859-8)
  - אזהרות על secrets (API keys, tokens)
  - טיפול בקבצים כפולים (החלפה, שינוי שם, ביטול)

#### פעולות על קבצים
- `/show <filename>` - הצגת קוד עם הדגשת תחביר
- `/edit <filename>` - עריכת קוד
- `/delete <filename>` - העברה לסל מחזור
- `/download <filename>` - הורדת קובץ
- `/versions <filename>` - היסטוריית גרסאות
- `/info <filename>` - מידע מפורט על הקובץ

#### תפריט פעולות אינטראקטיבי
כל קובץ כולל את הכפתורים הבאים:
- 👁️ **צפייה בקוד** - הצגה עם סינטקס הייליטינג
- ✏️ **עריכת קוד** - שינוי תוכן
- 📝 **שינוי שם** - שינוי שם הקובץ
- 📝 **עריכת הערה** - הוספה/עריכת תיאור
- 📥 **הורדה** - הורדה כקובץ
- 🔄 **שכפול** - יצירת עותק
- 🗑️ **מחיקה** - העברה לסל
- 📚 **היסטוריה** - צפייה בגרסאות
- 📊 **סטטיסטיקה** - מטריקות הקובץ
- ⭐ **מועדפים** - הוספה/הסרה ממועדפים

---

### 2️⃣ ארגון וגילוי קבצים

#### תצוגות שונות
- **כל הקבצים** (`📚 הצג את כל הקבצים שלי`)
  - רשימה עם דפדוף (10 פריטים לעמוד)
  - הצגת שם, שפה, גודל, תאריך
  - כפתורי פעולה מהירים

- **קבצים גדולים** (`📂 קבצים גדולים`)
  - תצוגה נפרדת לקבצים >4096 תווים
  - טיפול מיוחד ודפדוף

- **לפי ריפו** (`🗂 לפי ריפו`)
  - קיבוץ קבצים לפי repositories מ-GitHub
  - ספירת קבצים לכל ריפו
  - סינון לפי repository

#### מערכת מועדפים
- `/favorite <filename>` או `/fav <filename>` - הוספה/הסרה
- `/favorites` - הצגת כל המועדפים
- ⭐ כפתור הוספה למועדפים
- 💔 כפתור הסרה ממועדפים
- תצוגה ייעודית עם דפדוף

#### חיפוש מתקדם
**פקודה:** `/search <query> [options]`

**סוגי חיפוש:**
- **Text Search** - התאמת מחרוזת בסיסית
- **Regex Search** - חיפוש מבוסס תבניות
- **Fuzzy Search** - התאמה משוערת
- **Content Search** - חיפוש בתוך תוכן הקבצים
- **Function Search** - מציאת הגדרות פונקציות

**פילטרים:**
- סינון לפי שפת תכנות
- סינון לפי תגיות
- טווח תאריכים (from/to)
- טווח גודל קובץ (min/max)
- קבצים עם פונקציות/מחלקות
- תבנית שם קובץ

**אינדקס חיפוש:**
- Word index לחיפוש מהיר
- Function index
- Language index
- Tag index
- בנייה מחדש אוטומטית כל 24 שעות

---

### 3️⃣ ניהול גרסאות והיסטוריה

#### ניהול גרסאות
- גרסאות אוטומטיות בכל שמירה
- `/versions <filename>` - צפייה בכל הגרסאות
- השוואת גרסאות
- הצגת: מספר גרסה, תאריך, גודל

#### פעולות על גרסאות
- 👁 **צפייה בגרסה** - הצגת גרסה ספציפית
- ↩️ **שחזור גרסה** - חזרה לגרסה ישנה
- הגדלת מספר גרסה בכל עריכה

#### סל מחזור (`🗑️ סל מיחזור`)
- מחיקה רכה (soft delete)
- צפייה בקבצים שנמחקו עם דפדוף
- ♻️ **שחזור** - החזרת קבצים
- 🧨 **ניקוי סופי** - מחיקה לצמיתות
- ניקוי אוטומטי לאחר תקופת תפוגה

---

### 4️⃣ שיתוף וייצוא קוד

#### פקודת שיתוף (`/share <filename>`)
**אפשרויות שיתוף:**
- **GitHub Gist** - יצירת Gist ציבורי/פרטי
- **Pastebin** - העלאה ל-Pastebin (תפוגה חודש)
- **קישור פנימי** - מערכת שיתוף פנימית של הבוט

**שיתוף מרובה קבצים:**
- בחירת מספר קבצים לשיתוף
- יצירת Gist/Pastebin משולב
- ייצוא Batch

#### עזרה לשיתוף
- `/share_help` - הוראות שימוש בתכונות שיתוף
- הדרכה לפי פלטפורמה

#### אינטגרציה עם WebApp
- 🌐 כפתור "צפה ב-WebApp"
- קישורים ישירים לצפייה בקבצים
- כתובות URL ציבוריות

---

### 5️⃣ אינטגרציית GitHub (`🔧 GitHub`)

#### אימות
- 🔑 **הגדרת GitHub Token**
- אחסון אסימוני OAuth
- אימות אסימון
- 🚪 **התנתקות מ-GitHub**

#### ניהול Repositories
- **📁 בחירת Repository** - בחירת repo פעיל
- **🆕 יצירת Repo מ-ZIP** - יצירת repo חדש מקובץ ZIP
- **📂 הגדרת תיקיית יעד** - הגדרת תיקייה להעלאות
- **🗃️ עיון ב-Repository** - ניווט במבנה הריפו
  - עיון ב-branches ו-tags
  - צפייה בקבצים ותיקיות
  - ניווט בעץ התיקיות
  - צפייה בתוכן קבצים

#### פעולות קבצים
- **📤 העלאת קובץ** - העלאת קובץ חדש לריפו
  - העלאה ישירה
  - הדבקת קוד והעלאה
  - מקבצים שמורים
  - מקבצי ZIP
  - עיון בתוכן ZIP והעלאה סלקטיבית
- **📥 הורדת קובץ** - הורדה מהריפו
- **🧨 מחיקה** - מחיקת קובץ/ריפו שלם (מנהל בלבד)

#### תכונות Repository
- **⬇️ הורדת Repository** - שכפול כ-ZIP
- **📥 ייבוא ZIP מריפו** - ייבוא תוכן הריפו
- **🔍 ניתוח Repo** - ניתוח קוד ומטריקות
- **✅ אימות Repo** - בדיקת תקינות

#### גיבוי ושחזור (`🧰 גיבוי ושחזור`)
- יצירת גיבוי repository (ZIP)
- שחזור מ-ZIP ל-repository
- גרסאות repository
- בחירת branch לפעולות
- מצב Purge (החלפה מלאה מול עדכון)

#### התראות (`🔔 התראות חכמות`)
- התראות על אירועי GitHub
- התראות Commit
- התראות Issue/PR
- הגדרות התראות ניתנות להתאמה

---

### 6️⃣ מערכת גיבויים (`📦 גיבוי ושחזור`)

#### גיבוי מערכת מלא
- **יצירת גיבוי מלא** - ZIP של כל קבצי המשתמש
  - כולל metadata.json
  - מידע על גרסאות
  - דחיסה גבוהה (ZIP_DEFLATED, level 9)
  - הורדה אוטומטית לאחר יצירה

#### ניהול גיבויים
- **רשימת גיבויים** (`🗂 גיבויים אחרונים`)
  - רשימה עם דפדוף
  - הצגת: שם, גרסה, תאריך, גודל, מספר קבצים
  - תיוג repository (לגיבויי GitHub)
  - מערכת דירוג (🏆 מצוין, 👍 טוב, 🤷 סביר)
  - הערות/תיאורים לגיבויים

#### פעולות גיבוי
- **⬇️ הורדת גיבוי** - הורדת קובץ ZIP
- **♻️ שחזור מגיבוי** - שחזור קבצים מ-ZIP
- **🗑 מחיקת גיבוי** - הסרת גיבוי
- **🏷 דירוג גיבוי** - תיוג איכות
- **📝 הוספת הערה** - הוספת תיאור

#### מצב מחיקה מרובה
- בחירת מספר גיבויים
- מחיקה בצובר (Bulk)
- דיאלוג אישור
- מעקב אחר מחיקות

#### ייבוא/ייצוא ZIP
- **ייבוא ZIP** - ייבוא קבצי ZIP חיצוניים
  - זיהוי אוטומטי של repo מ-metadata
  - ניתוח שם repo ממבנה הZIP
  - תיוג קבצים עם repository

- **יצירת חבילת ZIP** - איגוד מספר קבצים
  - הוספת קבצים בהדרגה
  - סיום והורדה

---

### 7️⃣ אינטגרציית Google Drive (`☁️ Google Drive`)

#### אימות
- זרימת אימות OAuth2
- אחסון וריענון אסימונים
- הצגת סטטוס חיבור

#### תכונות גיבוי
- גיבוי ידני ל-Google Drive
- גיבויים אוטומטיים מתוזמנים
  - מרווחים: יומי, שבועי, חודשי
  - לוח זמנים ניתן להתאמה
  - ביצוע כעבודת רקע
- היסטוריית גיבויים ב-Drive
- ניהול תיקיות Drive

#### פעולות שחזור
- שחזור מגיבוי Drive
- רשימת גיבויי Drive זמינים
- אפשרויות שחזור סלקטיביות

---

### 8️⃣ ניתוח ואימות קוד

#### פקודת ניתוח (`/analyze <filename>`)
**מספק:**
- מטריקות מורכבות קוד
- זיהוי פונקציות/מחלקות
- ציון איכות קוד
- ספירת שורות וסטטיסטיקות
- תובנות ספציפיות לשפה
- הצעות Best Practices

#### פקודת אימות (`/validate <filename>`)
**בודק:**
- אימות Syntax
- מבנה קוד
- שגיאות נפוצות
- בעיות אבטחה
- תאימות Style

---

### 9️⃣ מערכת רפקטורינג (`/refactor <filename>`)

#### סוגי רפקטורינג
- **📦 פיצול קובץ גדול** - פירוק למודולים קטנים
- **🔧 חילוץ פונקציות** - חילוץ פונקציות לשימוש חוזר
- **🎨 המרה למחלקות** - רפקטורינג מונחה עצמים
- **🔀 מיזוג קוד דומה** - יישום עקרון DRY
- **💉 Dependency Injection** - שיפור יכולת בדיקה

#### זרימת רפקטורינג
1. בחירת קובץ וסוג רפקטורינג
2. ניתוח מבנה הקוד ע"י AI
3. יצירת הצעת רפקטורינג
4. תצוגה מקדימה של שינויים
5. אישור/עריכה/ביטול
6. שמירה אוטומטית של קוד מרופקטר

#### אימות
- אימות לפני רפקטורינג
- אימות לאחר רפקטורינג
- בדיקות בטיחות
- יכולת Rollback

---

### 🔟 תכונות קהילה

#### מרכז קהילה (`📚 מרכז קהילה`)
פורטל ראשי למשאבי קהילה

#### ספריית קהילה (`📳 ממשקי משתמשים`)
- **עיון בקטלוג** - צפייה ברכיבי UI שהוגשו
- **הגשת מוצר** - הגשת UI/רכיב שלך
  - איסוף כותרת
  - איסוף תיאור
  - איסוף URL
  - איסוף לוגו/תמונה
- **מערכת אישור מנהלים**
  - `/community_queue` - צפייה בהגשות ממתינות
  - `/community_approve <id>` - אישור הגשה
  - `/community_reject <id>` - דחייה עם סיבה
  - כפתורי אישור Inline למנהלים

#### ספריית סניפטים (`📃 ספריית סניפטים`)
- **עיון בסניפטים** - צפייה בספריית קטעי קוד
- **הגשת סניפט** - שיתוף קוד לשימוש חוזר
  - מצב רגיל (הודעה אחת)
  - מצב ארוך (מספר הודעות)
  - איסוף כותרת
  - איסוף תיאור
  - איסוף קוד
  - זיהוי אוטומטי של שפה
- **ניהול מנהלים**
  - `/snippet_queue` - צפייה בסניפטים ממתינים
  - `/snippet_approve <id>` - אישור סניפט
  - `/snippet_reject <id>` - דחייה עם סיבה
  - כפתורי אישור/דחייה Inline

#### אינטגרציה עם WebApp
- צופה סניפטים ציבורי
- דפדפן ספריית קהילה
- ממשק חיפוש וסינון
- קישורים ישירים מהבוט ל-webapp

---

### 1️⃣1️⃣ פעולות Batch

#### תפריט Batch (נגיש מהקשרים שונים)
- **Batch לפי Repositories** - פעולות קבוצתיות לפי repo
- **Batch לפי קבצים** - פעולות מרובות קבצים
- **Batch לפי ZIPs** - פעולות ZIP מרובות

#### פעולות Batch
- ממשק בחירה מרובה
- הורדה בצובר
- מחיקה בצובר
- ייצוא בצובר
- העלאה לGitHub בצובר

---

### 1️⃣2️⃣ תכונות ניהוליות

#### פקודות מנהל
- `/broadcast <message>` - שליחת הודעה לכל המשתמשים
- `/dm <user_id> <message>` - הודעה ישירה למשתמש (שומר רווחים)
- `/info` - הצגת סטטיסטיקות בוט
- `/tags` - ניהול מערכת תגיות
- `/recent` - הצגת פעילות אחרונה

#### ניטור ו-Observability (מנהלים בלבד, ChatOps)
- `/status` - בדיקת תקינות מערכת
- `/health` - מטריקות תקינות מפורטות
- `/observe` - ניטור בזמן אמת
- `/triage` - לוח בקרת שגיאות
- `/system_info` - מידע מערכת
- `/metrics` - מטריקות ביצועים
- `/predict` - ניתוח תקינות חיזוי
- `/accuracy` - דוח דיוק חיזויים
- `/sen` - קישור למעקב שגיאות Sentry
- `/errors` - סיכום שגיאות אחרונות
- `/uptime` - סטטיסטיקות זמן פעילות
- `/alerts` - לוח בקרת התראות פעילות
- `/incidents` - היסטוריית תקריות

#### ChatOps - ניהול התראות
- `/silence <rule>` - השתקת התראות
- `/unsilence <rule>` - הסרת השתקה
- `/silences` - צפייה בהשתקות פעילות

#### בקרת מגבלת תעריפים GitHub
- `/rate_limit` - בדיקת מגבלות API של GitHub
- `/enable_backoff` - הפעלת backoff למגבלת תעריפים
- `/disable_backoff` - השבתת backoff למגבלת תעריפים

---

### 1️⃣3️⃣ אלמנטים של ממשק משתמש

#### מקלדת ראשית
```
➕ הוסף קוד חדש
📚 הצג את כל הקבצים שלי
🔧 GitHub
📚 מרכז קהילה
📥 ייבוא ZIP מריפו
🗜️ יצירת ZIP
🗂 לפי ריפו
📂 קבצים גדולים
ℹ️ הסבר על הבוט
```

#### תפריט פרטי קובץ
מציג בקרות קובץ מקיפות:
- צפייה, עריכה, הורדה
- שינוי שם, הוספת הערה
- שיתוף, שכפול
- החלפת מועדפים
- היסטוריה, מחיקה
- קישור WebApp

#### דפדוף
- כל רשימות הקבצים תומכות בדפדוף
- גודל עמוד ניתן להתאמה (ברירת מחדל: 10)
- כפתורי ניווט (⬅️ ➡️)
- הצגת מונה עמודים

---

### 1️⃣4️⃣ תכונות נוספות

#### מערכת עזרה
- `/start` - הודעת פתיחה ותפריט ראשי
- `ℹ️ הסבר על הבוט` - הסבר על הבוט (מרובה עמודים)
- עזרה רגישת הקשר
- טיפים על תכונות

#### מעקב פעילות
- לוגינג פעילות משתמש
- חותמת זמן של פעילות אחרונה
- סטטיסטיקות שימוש
- אנליטיקס תכונות

#### תכונות אבטחה
- זיהוי Secrets (מפתחות API, אסימונים)
- הצפנת אסימונים
- בידוד משתמשים
- פקודות למנהלים בלבד עם בדיקת הרשאות
- הגבלת קצב לפעולות רגישות

#### טיפול בשגיאות
- הודעות שגיאה ידידותיות
- לוגיקת retry אוטומטית
- דיווח שגיאות למנהלים
- אינטגרציה עם Sentry
- מערכת התראות לשגיאות קריטיות

#### בינאום (i18n)
- ממשק בשפה עברית
- תמיכה RTL (מימין לשמאל)
- מחוונים עם אמוג'י
- הודעות מותאמות מקומיות

#### אופטימיזציה לביצועים
- מטמון קבצים
- טעינה עצלה (Lazy Loading) לקבצים גדולים
- אופטימיזציית אינדקס חיפוש
- דפדוף למערכי נתונים גדולים
- עיבוד עבודות רקע

#### מטפלים מיוחדים
- מטפל מסמכים (סוגי קבצים שונים)
- ניתוב שאילתות Callback
- ניהול מצב שיחה
- timeout אוטומטי לביטול
- זיהוי כפילויות

---

### 1️⃣5️⃣ אינטגרציות API

#### APIs של WebApp
- API צופה קבצים
- API חיפוש
- API ספריית קהילה
- API ספריית סניפטים
- API אוספים
- API סימניות
- אסימוני אימות

#### שירותים חיצוניים
- אינטגרציית GitHub API
- Google Drive API
- Pastebin API
- מעקב שגיאות Sentry
- מטריקות Prometheus

---

### 📊 סיכום פיצ'רים לפי קטגוריה

- **ניהול קבצים:** 25+ תכונות
- **אינטגרציית GitHub:** 15+ תכונות
- **גיבוי ושחזור:** 10+ תכונות
- **ניתוח קוד:** 10+ תכונות
- **תכונות קהילה:** 8+ תכונות
- **ניהול ומוניטורינג:** 20+ פקודות
- **חיפוש וגילוי:** 8+ מצבי חיפוש
- **שיתוף וייצוא:** 6+ שיטות
- **ממשק משתמש:** 50+ כפתורים אינטראקטיביים

**סה"כ:** 150+ תכונות ופקודות נפרדות!

---

## 🌐 פיצ'רים של ה-Web App

### 1️⃣ אימות וניהול משתמשים

#### כניסה וניהול Session
1. **אימות Telegram OAuth** (`/auth/telegram`)
   - כניסה דרך Widget של Telegram
   - אימות מאובטח עם אימות HMAC
2. **אימות מבוסס אסימון** (`/auth/token`)
   - אסימוני כניסה חד-פעמיים מהבוט
   - טיפול בתפוגת אסימון
3. **כניסה מתמשכת** (זכור אותי)
   - משך session של 30 יום
   - כניסה אוטומטית מבוססת Cookie
   - החלפה בהגדרות
4. **יציאה** (`/logout`)
   - ניקוי session ו-cookies
   - התנתקות מכל המכשירים

#### תפקידי משתמש
- **משתמשים רגילים**: גישה סטנדרטית
- **משתמשי Premium**: תכונות משופרות (מבוסס ENV)
- **משתמשי מנהל**: גישה ניהולית מלאה (מבוסס ENV)

---

### 2️⃣ ניהול קבצים

#### צפייה ועיון בקבצים (`/files`)

**תכונות ראשיות:**

1. **קטגוריות קבצים** (תצוגות ניתנות לסינון):
   - כל הקבצים
   - נפתחו לאחרונה (מעקב MRU)
   - לפי Repository (אינטגרציית GitHub)
   - מועדפים ⭐
   - אוספי Workspace
   - קבצים גדולים (>100KB)
   - קבצים אחרים

2. **חיפוש וסינון**:
   - חיפוש שם/תיאור
   - סינון שפה
   - סינון מבוסס תגיות
   - אפשרויות מיון מרובות (תאריך, שם, גודל)

3. **הצגת קבצים**:
   - תצוגת Grid/רשימה
   - אייקוני קבצים לפי שפה
   - גודל וספירת שורות
   - חותמות זמן יצירה/עדכון
   - חותמת זמן של פתיחה אחרונה

#### תצוגת קובץ בודד (`/file/<file_id>`)

**תכונות תצוגה:**
1. **הדגשת Syntax** (Pygments)
   - 100+ שפות תכנות
   - מספרי שורות
   - אופטימיזציה לערכת נושא כהה
2. **פעולות קוד**:
   - העתקה ללוח
   - הורדת קובץ
   - עריכת קובץ
   - מחיקת קובץ
   - שיתוף קובץ
3. **הצגת Metadata של קובץ**:
   - שם קובץ, שפה, תיאור
   - תגיות, גודל, ספירת שורות
   - תאריכי יצירה/עדכון
   - היסטוריית גרסאות

#### פעולות קבצים

**1. העלאת קבצים** (`/upload`)
- העלאת קבצים מבוססת Web
- תמיכה ב-Drag-and-drop
- סוגי קבצים מרובים
- זיהוי שפה אוטומטי

**2. עריכת קבצים** (`/edit/<file_id>`)
- עורך קוד בדפדפן
- הדגשת Syntax
- שמירת שינויים
- מעקב גרסאות

**3. הורדת קבצים** (`/download/<file_id>`)
- הורדת קובץ ישירה
- שימור תוכן מקורי

**4. שיתוף קבצים** (`/api/share/<file_id>`)
- יצירת קישור לשיתוף
- גישה מבוססת אסימון
- צפייה בקבצים משותפים (`/shared/<token>`)

---

### 3️⃣ תכונות חיפוש מתקדמות

#### חיפוש תוכן גלובלי (`/api/search/global`)

**סוגי חיפוש:**
1. **Content Search**: חיפוש טקסט מלא בקוד
2. **Text Search**: התאמת טקסט רגיל
3. **Regex Search**: תבניות ביטויים רגולריים (עם הגנת ReDoS)
4. **Fuzzy Search**: התאמה משוערת
5. **Function Search**: מציאת הגדרות פונקציות

**פילטרי חיפוש:**
- שפת תכנות
- תגיות
- טווח תאריכים (from/to)
- גודל קובץ (min/max)
- יש פונקציות/מחלקות
- תבנית שם קובץ

**יכולות חיפוש:**
- הצעות השלמה אוטומטית בזמן אמת (`/api/search/suggestions`)
- הדגשת Syntax של התאמות
- תצוגות מקדימות של קטעים עם הקשר
- ניקוד רלוונטיות
- סדרי מיון מרובים (רלוונטיות, תאריך, שם, גודל)
- תמיכה בדפדוף
- מטמון Redis לביצועים

**תכונות מתקדמות:**
- הגבלת קצב (30 בקשות/דקה)
- אימות שאילתה וסניטיזציה
- מניעת התקפות ReDoS עבור regex
- הדגשת תוצאות חיפוש
- תמיכה ברב-לשוניות

---

### 4️⃣ מערכת סימניות (`/api/bookmarks/`)

#### תכונות סימניה מרכזיות
1. **החלפת סימניות** (`POST /<file_id>/toggle`)
   - הוספה/הסרת סימניות בשורות ספציפיות
   - סמנים מקודדי צבע (צהוב, אדום, ירוק, כחול, סגול)
   - עיגון מספר שורה
   - תמיכה במזהה עוגן עבור כותרות Markdown
   - הערות אישיות לכל סימניה

2. **צפייה בסימניות**:
   - קבלת כל הסימניות לקובץ (`GET /<file_id>`)
   - קבלת כל סימניות המשתמש (`GET /all`)
   - תמיכה בדפדוף
   - זיהוי סימניות לא חוקיות

3. **עדכון סימניות**:
   - עדכון הערה (`PUT /<file_id>/<line>/note`)
   - עדכון צבע (`PUT /<file_id>/<line>/color`)
   - מחיקת סימניה (`DELETE /<file_id>/<line>`)
   - ניקוי כל סימניות הקובץ (`DELETE /<file_id>/clear`)

4. **תכונות מתקדמות**:
   - בדיקת סנכרון לשינויי קובץ (`POST /<file_id>/sync`)
   - סטטיסטיקות סימניות (`GET /stats`)
   - ייצוא סימניות כ-JSON (`GET /export`)
   - העדפות משתמש (צבע ברירת מחדל) (`GET/PUT /prefs`)

**צבעי סימניה זמינים:**
- 🟡 צהוב
- 🔴 אדום
- 🟢 ירוק
- 🔵 כחול
- 🟣 סגול

---

### 5️⃣ פתקים דביקים (`/api/sticky-notes/`)

**מערכת הערות Markdown אינטראקטיבית:**

1. **יצירת הערות** (`POST /<file_id>`)
   - הערות צפות על תצוגה מקדימה של Markdown
   - מיקום מותאם (x, y)
   - גודל מותאם (width, height)
   - התאמת צבע
   - עיגון שורה
   - עוגני כותרת Markdown

2. **צפייה בהערות** (`GET /<file_id>`)
   - טעינת כל ההערות לקובץ
   - אחזור מבוסס Scope
   - מעקב שם קובץ צולב

3. **עדכון הערות** (`PUT /note/<note_id>`)
   - עריכת תוכן
   - העברת מיקום
   - שינוי גודל
   - שינוי צבע
   - מזעור/הגדלה
   - זיהוי קונפליקטים (סנכרון מרובה מכשירים)

4. **מחיקת הערות** (`DELETE /note/<note_id>`)

5. **פעולות Batch** (`POST /batch`)
   - עדכון מספר הערות בבת אחת
   - מותאם לסנכרון מרובה מכשירים

**תכונות הערה:**
- מיקום ניתן לגרירה
- חלונות ניתנים לשינוי גודל
- ניתן למזעור
- תמיכה בטקסט עשיר (מגבלת 5000 תווים)
- הגנת הגבלת קצב
- סנכרון בזמן אמת במכשירים

---

### 6️⃣ האוספים שלי (`/api/collections/`, `/collections`)

**מערכת ניהול אוספים אישית:**

#### פעולות אוסף
1. **יצירת אוסף** (`POST /`)
   - ידני או חכם (מבוסס כללים)
   - שם מותאם, תיאור
   - התאמת אייקון וצבע
   - סימון מועדף
   - סדר מיון מותאם

2. **רשימת אוספים** (`GET /`)
   - צפייה בכל האוספים
   - ברירת מחדל "שולחן עבודה" (Workspace) נוצרת אוטומטית
   - תמיכה בדפדוף

3. **קבלת אוסף** (`GET /<collection_id>`)
   - מידע מפורט על אוסף
   - ספירת פריטים
   - Metadata

4. **עדכון אוסף** (`PUT /<collection_id>`)
   - עריכת שם, תיאור
   - שינוי אייקון, צבע
   - עדכון כללים
   - החלפת מועדף

5. **מחיקת אוסף** (`DELETE /<collection_id>`)

#### ניהול פריטי אוסף
1. **קבלת פריטים** (`GET /<collection_id>/items`)
   - רשימת פריטים עם דפדוף
   - כולל פריטים מחושבים (חכמים)
   - Metadata של קובץ

2. **הוספת פריטים** (`POST /<collection_id>/items`)
   - הוספה בצובר של קבצים
   - עם הערות לכל פריט

3. **הסרת פריטים** (`DELETE /<collection_id>/items`)
   - הסרה בצובר

4. **סידור מחדש של פריטים** (`PUT /<collection_id>/reorder`)
   - סדר פריטים מותאם

#### שיתוף אוספים
1. **הפעלה/השבתה של שיתוף** (`POST /<collection_id>/share`)
   - יצירת קישור שיתוף ציבורי
   - גישה מבוססת אסימון

2. **תצוגת אוסף ציבורי** (`GET /shared/<token>`)
   - צפייה אנונימית
   - רשימת קבצים עם Metadata
   - קישורי הורדה

3. **פעולות קובץ משותף**:
   - צפייה בקובץ (`GET /shared/<token>/files/<file_id>`)
   - הורדת קובץ (`GET /shared/<token>/files/<file_id>/download`)
   - ייצוא כ-ZIP (`GET /shared/<token>/export`)

4. **אנליטיקס שיתוף**:
   - מעקב צפייה
   - מעקב הורדה
   - לוגינג IP ו-user agent

#### דפי UI
- דף אוספים ראשי (`/collections`)
- תצוגת אוסף ספציפי (`/collections/<collection_id>`)
- צופה אוסף משותף (`/collections/shared/<token>`)

---

### 7️⃣ ספריית סניפטים (`/snippets`, `/api/snippets/`)

**מאגר קטעי קוד קהילתי:**

#### תכונות ציבוריות
1. **עיון בסניפטים** (`GET /snippets`, `GET /api/snippets`)
   - רשימה עם דפדוף
   - חיפוש לפי כותרת/שפה
   - סינון לפי שפת תכנות
   - ברירת מחדל 30 פריטים לעמוד

2. **צפייה בשפות סניפט** (`GET /api/snippets/languages`)
   - קבלת כל השפות הזמינות
   - רשימה ממוינת

#### מערכת הגשה
1. **הגשת סניפט** (`/snippets/submit`, `POST /api/snippets/submit`)
   - כותרת, תיאור, קוד, שפה
   - ייחוס משתמש
   - סטטוס אישור ממתין
   - התראת מנהל דרך Telegram

#### ניהול מנהלים (משתמשי מנהל בלבד)
1. **סניפטים ממתינים** (`/admin/snippets/pending`)
   - רשימת כל ההגשות הממתינות
   - פעולות מהירות

2. **אישור סניפט** (`/admin/snippets/approve`)
   - אישור ופרסום
   - מעקב מנהל

3. **דחיית סניפט** (`/admin/snippets/reject`)
   - דחייה עם סיבה
   - התראת משתמש

4. **צפייה בסניפט** (`/admin/snippets/view`)
   - תצוגה מקדימה מלאה של סניפט
   - הצגת Metadata

5. **עריכת סניפט** (`/admin/snippets/edit`)
   - שינוי כותרת, תיאור, קוד, שפה

6. **מחיקת סניפט** (`POST /admin/snippets/delete`)
   - הסרה קבועה

---

### 8️⃣ ספריית קהילה (`/community-library`, `/api/community-library/`)

**משאבים משותפים מהקהילה:**

1. **עיון בפריטים** (`GET /community-library`, `GET /api/community-library`)
   - חיפוש לפי שאילתה
   - סינון לפי תגיות
   - דפדוף

2. **Proxy לוגו** (`GET /api/community-library/logo/<file_id>`)
   - Proxy מאובטח של קובץ Telegram
   - ללא חשיפת אסימון בוט
   - תגובות במטמון

---

### 9️⃣ לוח בקרה וסטטיסטיקות (`/dashboard`)

**לוח בקרת אנליטיקס אישי:**

#### הצגת סטטיסטיקות
1. **ספירת קבצים**: סה"כ קבצים פעילים
2. **אחסון כולל**: גודל מצטבר בבייטים
3. **שפות מובילות**: 5 השפות הנפוצות ביותר עם ספירות
4. **פעילות אחרונה**: 5 הקבצים האחרונים

#### פעולות מהירות
- פתיחת בוט Telegram
- צפייה בכל הקבצים
- רענון סטטיסטיקות

#### נקודות קצה API
- **קבלת סטטיסטיקות** (`/api/stats`): JSON סטטיסטיקות משתמש
- **סטטיסטיקות ציבוריות** (`/api/public_stats`): סטטיסטיקות מצרפיות אנונימיות
- **מידע משתמש** (`/api/me`): פרטי משתמש נוכחי
- **Uptime** (`/api/uptime`): מידע על זמן פעילות מערכת

---

### 🔟 עמוד הגדרות (`/settings`)

**העדפות והגדרות משתמש:**

#### סקציית חשבון
- הצגת User ID
- שם משתמש Telegram
- שם מלא
- סטטוס חשבון (Regular/Premium/Admin)

#### ניהול Session
- החלפת כניסה מתמשכת
- הצגת משך session (30 יום)
- יציאה מכל המכשירים

#### העדפות תצוגה
1. **גודל פונט**:
   - בקרות הגדלה/הקטנה
   - הצגת קנה מידה נוכחי (0.8x - 1.4x)
   - אחסון לכל מכשיר

2. **בחירת ערכת נושא**:
   - Classic (גרדיינט סגול)
   - Ocean (ערכת נושא כחולה)
   - Forest (ערכת נושא ירוקה)
   - High Contrast

3. **החלפת סימניות**:
   - הצגה/הסתרת כפתור סימניה צף
   - מחוון מצב ויזואלי

#### כלי מנהל (משתמשי מנהל בלבד)
- ניהול ספריית סניפטים
- סטטיסטיקות מערכת (בקרוב)
- ניהול משתמשים (בקרוב)
- אינטגרציית GitHub (בקרוב)

#### פרטיות ואבטחה
- מחוון הצפנת HTTPS
- אימות Telegram בלבד
- אין אחסון סיסמאות
- מידע הצפנת נתונים

---

### 1️⃣1️⃣ תכונות ממשק משתמש

#### עיצוב רספונסיבי
- מותאם למובייל (תמיכה RTL/LTR)
- תאימות טאבלט
- תכונות מלאות בדסקטופ
- תמיכה במחוות מגע

#### אלמנטים ויזואליים
1. **עיצוב Glass Morphism**:
   - אפקט זכוכית כפור בכרטיסים
   - רקעי גרדיינט
   - מעברים חלקים

2. **סרגל ניווט**:
   - לוגו ומיתוג
   - קישורי גישה מהירה (Dashboard, Files, Collections וכו')
   - אווטר/תפריט משתמש
   - אייקון גלגל הגדרות
   - תפריט המבורגר למובייל

3. **אנימציות**:
   - מעברי עמודים
   - אפקטי ריחוף כרטיס
   - אינטראקציות כפתורים
   - מצבי טעינה

4. **אייקונים**:
   - Font Awesome 6.4.0
   - אייקוני קובץ ספציפיים לשפה
   - תמיכה באמוג'י

#### הצגת קוד
1. **הדגשת Syntax**:
   - מופעל על ידי Pygments
   - 100+ שפות
   - ערכת נושא כהה מותאמת
   - מספרי שורות

2. **פעולות קוד**:
   - כפתור העתקה
   - הורדה
   - מצב מסך מלא
   - מצב עריכה

3. **תצוגה מקדימה של Markdown** (`/md/<file_id>`)
   - פלט HTML מעובד
   - שכבת עליונה של פתקים דביקים
   - ניווט כותרות
   - הדגשת בלוקים של קוד
   - תמיכה בטבלאות
   - הטמעת תמונות

4. **תצוגה מקדימה של HTML** (`/html/<file_id>`, `/raw_html/<file_id>`)
   - עיבוד iframe בטוח
   - פלט מסוניטז
   - תצוגת HTML גולמי

---

### 1️⃣2️⃣ פעולות Bulk

**פעולות קובץ עם בחירה מרובה:**

1. **Bulk Favorite** (`POST /api/files/bulk-favorite`)
   - הוספת מספר קבצים למועדפים

2. **Bulk Unfavorite** (`POST /api/files/bulk-unfavorite`)
   - הסרה ממועדפים

3. **Bulk Tag** (`POST /api/files/bulk-tag`)
   - הוספת תגיות למספר קבצים

4. **Bulk Delete** (`POST /api/files/bulk-delete`)
   - מחיקת מספר קבצים בבת אחת

5. **Create ZIP** (`POST /api/files/create-zip`)
   - ארכיון מספר קבצים
   - הורדה כ-ZIP

6. **Create Share Link** (`POST /api/files/create-share-link`)
   - יצירת קישור שיתוף מרובה קבצים

---

### 1️⃣3️⃣ סיכום נקודות קצה API

#### APIs קבצים
- `GET /api/file/<file_id>/preview` - נתוני תצוגה מקדימה של קובץ
- `GET /api/files/recent` - רשימת קבצים אחרונים
- `POST /api/files/resolve` - פתרון קובץ לפי שם
- `POST /api/favorite/toggle/<file_id>` - החלפת מועדף
- `POST /api/share/<file_id>` - שיתוף קובץ
- `POST /api/shared/save` - שמירת קובץ משותף לחשבון

#### APIs חיפוש
- `POST /api/search/global` - חיפוש גלובלי
- `GET /api/search/suggestions` - השלמה אוטומטית
- `GET /api/search/health` - סטטוס מנוע חיפוש

#### APIs משתמש
- `GET /api/me` - מידע משתמש נוכחי
- `POST /api/persistent_login` - הפעלת כניסה מתמשכת
- `POST /api/ui_prefs` - שמירת העדפות UI
- `POST /api/welcome/ack` - אישור modal פתיחה
- `POST /api/user/preferences` - עדכון העדפות

#### APIs מטמון
- `GET /api/cache/stats` - סטטיסטיקות מטמון
- `POST /api/cache/warm` - חימום מטמון

---

### 1️⃣4️⃣ תכונות אבטחה

1. **אימות**:
   - Telegram OAuth בלבד
   - אימות חתימת HMAC
   - ניהול session
   - הגנת CSRF

2. **אימות קלט**:
   - Escaping של HTML
   - מניעת SQL injection (MongoDB)
   - הגנת XSS
   - מניעת התקפות ReDoS

3. **הגבלת קצב**:
   - חיפוש: 30/דקה
   - פעולות פתקים דביקים: 60-300/דקה
   - API כללי: מגבלות הניתנות להתאמה

4. **בקרת גישה**:
   - בידוד נתונים בבעלות משתמש
   - נתיבים למנהלים בלבד
   - אימות אסימון שיתוף
   - בדיקות הרשאת קובץ

---

### 1️⃣5️⃣ תכונות ביצועים

1. **מטמון**:
   - מטמון דינמי מופעל Redis
   - TTL מודע תוכן
   - מפתחות מטמון ספציפיים למשתמש
   - ביטול מבוסס תבנית

2. **אופטימיזציה**:
   - דחיסת Gzip/Brotli
   - גרסאות נכסים סטטיים
   - כותרות ETag/Last-Modified
   - בקשות מותנות (תגובות 304)

3. **מסד נתונים**:
   - אינדקסים של MongoDB
   - צינורות צבירה
   - דפדוף מבוסס Cursor
   - אופטימיזציית שאילתות

4. **ניטור**:
   - נקודת קצה מטריקות Prometheus (`/metrics`)
   - נקודת קצה בדיקת תקינות (`/healthz`)
   - מעקב OpenTelemetry
   - לוגינג מובנה

---

### 1️⃣6️⃣ תכונות אינטגרציה

1. **אינטגרציית בוט Telegram**:
   - קישור עמוק לבוט
   - התראות מנהל
   - תמיכה ב-Webhook (`/alertmanager/webhook`)

2. **אינטגרציית GitHub**:
   - מעקב קבצי repository
   - ארגון מבוסס תגיות
   - מעקב Commit (דרך בוט)

3. **שירותים חיצוניים**:
   - מעקב שגיאות Sentry
   - העברת Webhook של Alertmanager

---

### 1️⃣7️⃣ תכונות PWA

1. **יכולת התקנה**:
   - הוספה למסך הבית
   - מצב אפליקציה עצמאית
   - אייקונים מותאמים (אייקון מגע Apple 180x180)

2. **Manifest** (`/static/manifest.json`):
   - שם אפליקציה ומיתוג
   - צבעי ערכת נושא
   - מצב תצוגה
   - סט אייקונים

3. **תמיכה לא מקוונת**:
   - Service worker מוכן
   - אסטרטגיות Cache-first

---

### 1️⃣8️⃣ דפים מיוחדים

1. **בית** (`/`) - דף נחיתה עם תכונות
2. **כניסה** (`/login`) - דף אימות
3. **404** (`/404.html`) - לא נמצא
4. **500** (`/500.html`) - שגיאת שרת
5. **תיעוד OpenAPI** (`/docs`, `/redoc`, `/openapi.yaml`) - תיעוד API

---

### 1️⃣9️⃣ פילטרי קטגוריה

**תצוגות ארגון קבצים:**
1. **כל הקבצים** - רשימת קבצים מלאה
2. **נפתחו לאחרונה** - MRU עם חותמות זמן
3. **לפי Repository** - קיבוץ repo של GitHub
4. **מועדפים** - קבצים מסומנים בכוכב בלבד
5. **Workspace** - אוסף ברירת מחדל
6. **קבצים גדולים** - קבצים >100KB
7. **קבצים אחרים** - קבצים שאינם repo, שאינם ארכיון

---

### 📊 סיכום פיצ'רים של Web App

- **ניהול קבצים:** 15+ תכונות
- **חיפוש מתקדם:** 8+ מצבים
- **סימניות ופתקים:** 20+ פעולות
- **אוספים:** 15+ תכונות ארגון
- **קהילה:** 10+ תכונות שיתוף
- **אבטחה:** 10+ מנגנוני הגנה
- **ביצועים:** 8+ אופטימיזציות
- **API Endpoints:** 50+ נקודות קצה

**סה"כ:** 130+ תכונות נפרדות ב-Web App!

---

## 🛠️ טכנולוגיות ותשתית

### Backend (Python)

#### Framework ליבה
- **Python 3.11+** (3.12 ב-Docker)
- **python-telegram-bot 22.5** - Telegram Bot API
- **Flask 3.1.2** - Web framework
- **Pydantic 2.12.3** - הגדרות ואימות

#### מסד נתונים ומטמון
- **MongoDB 4.15.3** - מסד נתונים מסמכים
- **motor 3.7.1** - מנהל מסד נתונים MongoDB אסינכרוני
- **pymongo 4.15.3** - מנהל מסד נתונים MongoDB
- **redis 7.0.0** - שכבת מטמון

#### HTTP ורשת
- **requests 2.32.5** - לקוח HTTP סינכרוני
- **aiohttp 3.13.1** - לקוח HTTP אסינכרוני
- **httpx 0.28.1** - לקוח HTTP מודרני
- **gunicorn 23.0.0** - שרת WSGI
- **uvicorn 0.38.0** - שרת ASGI

#### אינטגרציות חיצוניות
- **PyGithub 2.8.1** - GitHub API
- **google-api-python-client 2.185.0** - Google Drive
- **google-auth 2.41.1**, **google-auth-oauthlib 1.2.2** - Google Auth

#### עיבוד קוד
- **pygments 2.19.2** - הדגשת Syntax
- **python-magic 0.4.27** - זיהוי סוג קובץ
- **chardet 5.2.0** - זיהוי קידוד תווים
- **langdetect 1.0.9** - זיהוי שפה
- **textstat 0.7.10** - מטריקות קריאות טקסט
- **beautifulsoup4 4.14.2** - ניתוח HTML

#### Observability ומוניטורינג
- **structlog 25.4.0** - לוגינג מובנה
- **sentry-sdk[flask] 2.42.1** - מעקב שגיאות
- **prometheus-client 0.23.1** - איסוף מטריקות
- **psutil 7.1.2** - מטריקות מערכת
- OpenTelemetry suite (API, SDK, exporters, instrumentation)

#### אבטחה והצפנה
- **bcrypt 5.0.0** - hashing סיסמאות
- **cryptography 46.0.3** - כלי הצפנה

#### כלים
- **click 8.3.0** - framework CLI
- **arrow 1.4.0** - טיפול בתאריכים
- **python-dateutil 2.9.0** - כלי תאריכים
- **pytz 2025.2** - תמיכה באזור זמן
- **markdown 3.9** - ניתוח Markdown
- **html2text 2025.4.15** - HTML לטקסט
- **GitPython 3.1.45** - אינטגרציית Git
- **rapidfuzz 3.14.1** - התאמת מחרוזת מטושטשת
- **tenacity 9.1.2** - תבניות חוסן
- **aiofiles 25.1.0** - פעולות קובץ אסינכרוניות

#### עיבוד תמונה
- **Pillow 12.0.0** - עיבוד תמונה
- **cairosvg 2.8.2** - עיבוד SVG

#### הגבלת קצב
- **limits 5.6.0** - backends הגבלת קצב
- **Flask-Limiter 4.0.0** - הגבלת קצב Flask
- **slowapi 0.1.9** - הגבלת קצב Starlette/FastAPI

#### כלי Web Server
- **Flask-Compress 1.20** - דחיסת תגובה
- **whitenoise 6.11.0** - הגשת קבצים סטטיים

---

### Frontend (JavaScript/Node.js)

#### מנהל חבילות
- Node.js (package.json קיים)

#### הדגשת קוד ו-Markdown
- **highlight.js 11.11.1** - הדגשת Syntax
- **markdown-it 14.1.0** - מנתח Markdown
- **markdown-it-*** - הרחבות Markdown:
  - `markdown-it-admonition` - הערות
  - `markdown-it-anchor` - קישורי עוגן
  - `markdown-it-container` - מכולות
  - `markdown-it-emoji` - תמיכה באמוג'י
  - `markdown-it-footnote` - הערות שוליים
  - `markdown-it-task-lists` - רשימות משימות
  - `markdown-it-toc-done-right` - תוכן עניינים

#### עורך קוד
- **@codemirror/*** suite (6.x) - עורך קוד מודרני:
  - `state`, `view`, `commands`, `language`, `search`, `autocomplete`
  - `gutter`, `closebrackets`, `matchbrackets`, `fold`
  - `@codemirror/theme-one-dark` - ערכת נושא כהה

#### תמיכה בשפות
- **@codemirror/lang-*** עבור: Python, JavaScript, HTML, CSS, SQL, JSON, Markdown, XML

#### מתמטיקה ודיאגרמות
- **katex 0.16.25** - עיבוד מתמטיקה
- **mermaid 11.12.0** - יצירת דיאגרמות

#### כלי בנייה
- **esbuild 0.25.11** - bundler JavaScript

---

### Container ו-Deployment

#### Docker
- Python 3.12-slim base image
- בנייה רב-שלבית (builder + production)
- ביצוע משתמש non-root (UID 1000)

#### Orchestration
- Docker Compose (v3.8)
- שירותים: MongoDB, Redis, Bot, סטאק ניטור אופציונלי

#### פלטפורמות Deployment
- Render.com (מומלץ לייצור)
- Docker (VPS, self-hosted)
- פיתוח מקומי עם docker-compose

#### סטאק ניטור
- **Prometheus** - איסוף מטריקות
- **Grafana** - ויזואליזציה
- **AlertManager** - ניתוב התראות

---

### פיתוח ובדיקות

#### Framework בדיקות
- **pytest** - מריץ בדיקות
- **pytest-asyncio** - תמיכה בבדיקות אסינכרוניות
- מסמני בדיקות ביצועים

#### איכות קוד
- **black 24.4.2** - מעצב קוד
- **isort 5.13.2** - ממיין imports
- **flake8 7.0.0** - Linter
- **mypy 1.10.0** - בודק טיפוסים
- **bandit 1.7.5** - מנתח אבטחה
- **pre-commit 2.x** - Git hooks

#### תיעוד
- **Sphinx** - מחולל תיעוד
- **sphinx-rtd-theme** - ערכת נושא Read the Docs
- **sphinx-autodoc-typehints** - תיעוד רמזי טיפוס
- **sphinxcontrib-napoleon** - docstrings של Google/NumPy

---

### מודלי נתונים וסכימת מסד נתונים

#### אוספי MongoDB

**אוספים ראשיים:**
- `code_snippets` / `files` - אחסון קטעי קוד
- `users` - פרופילי משתמש
- `bookmarks` - סימניות משתמש
- `collections` - אוספי משתמש
- `sticky_notes` - פתקים מהירים
- `community_library` - סניפטים משותפים
- `snippet_library` - סניפטים מאושרים
- `backups` - metadata גיבוי
- `github_repos` - נתוני repo במטמון
- `google_drive_credentials` - אסימוני OAuth

**שדות מפתח בקטעי קוד:**
- `user_id` - בעלים
- `file_name`, `code`, `programming_language`
- `tags`, `description`
- `version`, `created_at`, `updated_at`
- `is_favorite`, `is_active`
- `deleted_at`, `deleted_expires_at` (מחיקה רכה)
- `file_size`, `lines_count` (לקבצים גדולים)

---

## 🔒 אבטחה ומעקב

### תכונות אבטחה

1. **אימות והרשאה**
   - אימות Telegram OAuth עם HMAC
   - ניהול session מבוסס Cookie
   - הצפנת אסימונים
   - בקרת גישה מבוססת תפקידים (RBAC)

2. **הגנת נתונים**
   - הצפנת secrets במסד נתונים
   - בידוד נתונים בין משתמשים
   - מחיקה רכה עם תקופת שחזור
   - גיבויים מוצפנים

3. **אבטחת API**
   - הגבלת קצב למניעת DDoS
   - אימות קלט ו-Sanitization
   - הגנת CSRF
   - הגנת XSS
   - מניעת ReDoS בביטויים רגולריים

4. **סריקות אבטחה**
   - **Bandit** - סריקת קוד סטטית לפגיעויות
   - **Safety** - בדיקת תלויות פגיעות
   - **Semgrep** - ניתוח קוד סמנטי
   - **Dependency-Check** - סריקת CVE

5. **ניטור אבטחה**
   - מעקב אחר ניסיונות כניסה כושלים
   - זיהוי Secrets בקוד
   - התראות על פעילות חשודה
   - audit logs

---

### Observability ומוניטורינג

#### לוגינג מובנה
- **structlog** - לוגים מובנים ב-JSON
- שדות הקשר אוטומטיים (user_id, request_id)
- רמות לוג ניתנות להתאמה
- סיבוב לוגים אוטומטי

#### מטריקות (Prometheus)
**מטריקות מערכת:**
- CPU, זיכרון, דיסק
- connection pool MongoDB
- connection pool Redis
- תור משימות
- זמן תגובה HTTP

**מטריקות אפליקציה:**
- בקשות בוט (לפי פקודה)
- פעולות קבצים (create, read, update, delete)
- שגיאות (לפי סוג)
- מעקב חיפושים
- פגיעות מטמון

#### Tracing (OpenTelemetry)
- מעקב אחר בקשות מקצה לקצה
- Spans אוטומטיים לפעולות DB
- Spans לקריאות API חיצוניות
- תמיכה ב-Jaeger/Zipkin

#### מעקב שגיאות (Sentry)
- דיווח שגיאות אוטומטי
- Stack traces עם הקשר
- קיבוץ שגיאות חכם
- התראות בזמן אמת
- Release tracking

#### דשבורדים (Grafana)
- דשבורד תקינות מערכת
- דשבורד ביצועי בוט
- דשבורד מטריקות משתמש
- דשבורד שגיאות והתראות
- דשבורד GitHub API rate limits

#### התראות (AlertManager)
**כללי התראה:**
- שימוש גבוה במעבד/זיכרון
- שיעור שגיאות גבוה
- זמן תגובה איטי
- מסד נתונים לא זמין
- מגבלת תעריפים של GitHub

**ערוצי התראה:**
- Telegram (לקבוצת מנהלים)
- אימייל
- Webhooks
- PagerDuty (אופציונלי)

---

### CI/CD Pipeline

#### GitHub Actions Workflows

1. **CI Pipeline** (`.github/workflows/ci.yml`)
   - בדיקות איכות קוד Python (black, isort, flake8, mypy)
   - סריקות אבטחה (bandit, safety)
   - בדיקות unit ו-integration
   - דיווח כיסוי קוד (codecov)
   - בדיקות Linting של Docker
   - בדיקות YAML

2. **Deployment** (`.github/workflows/deploy.yml`)
   - בניית Docker image
   - דחיפה ל-registry (Docker Hub, GHCR)
   - Deploy ל-Render.com
   - בדיקות תקינות אחרי deploy
   - Rollback אוטומטי על כישלון

3. **Security Scan** (`.github/workflows/security-scan.yml`)
   - סריקת פגיעויות תלויות
   - סריקת Container
   - זיהוי Secrets
   - ניתוח SAST
   - דיווח CVEs

4. **Performance Tests** (`.github/workflows/performance-tests.yml`)
   - בדיקות Benchmark
   - מסמני בדיקות light/heavy
   - מעקב משך זמן
   - השוואת ביצועים עם baseline

5. **Documentation** (`.github/workflows/docs.yml`)
   - בנייה של תיעוד Sphinx
   - Deploy ל-ReadTheDocs
   - GitHub Pages
   - בדיקת קישורים (lychee)

6. **Dependency Management** (`.github/workflows/dependabot-auto-merge.yml`)
   - עדכוני תלויות אוטומטיים (Dependabot)
   - מיזוג אוטומטי לגרסאות patch
   - התראת GitHub

---

## 📊 סטטיסטיקות פרויקט

### גודל Codebase
- **~65,000 שורות** קוד Python (מודולים ראשיים)
- **244 KB** app.py של Flask לבדו
- חבילת בדיקות מקיפה עם **100+ קבצי בדיקה**
- **40+ סעיפי תיעוד** Sphinx

### מטריקות מפתח
- **50+** מודולי Python ליבה
- **10+** מימושי שירות
- **9+** מטפלים מיוחדים
- **100+** שאילתות/פעולות מסד נתונים
- **18+** זרימות עבודה של GitHub Actions
- תמיכה ברב-לשוניות (**20+ שפות תכנות**)

---

## 🎯 תבניות ארכיטקטוניות מפתח

1. **עיצוב מודולרי**
   - הפרדת חששות (handlers, services, database)
   - מבנה ברור של תיקיות
   - קוד לשימוש חוזר

2. **Async/Await**
   - פעולות מסד נתונים אסינכרוניות
   - קריאות HTTP אסינכרוניות
   - עיבוד מקביל

3. **Dependency Injection**
   - ניהול הגדרות עם Pydantic
   - ניתן לבדיקה
   - גמיש להגדרות

4. **Observer Pattern**
   - פליטת אירועים ל-observability
   - מנויים להתראות
   - ניתוק loose

5. **Circuit Breaker**
   - חוסן ל-APIs חיצוניים
   - הגנת מגבלת קצב
   - fallback graceful

6. **Rate Limiting**
   - אלגוריתם Token Bucket
   - הגבלות לכל משתמש/גלובלי
   - יציאה graceful

7. **Caching Layer**
   - Redis לביצועים
   - ביטול חכם
   - TTL מותאם

8. **Event-Driven**
   - עדכוני Telegram מפעילים זרימות עבודה
   - ארכיטקטורת מנהל handler
   - מצב שיחה

---

## 🚀 אפשרויות Deployment

### 1. Development מקומי
```bash
# התקנת תלויות
pip install -r requirements/development.txt

# הפעלת MongoDB ו-Redis
docker-compose -f docker-compose.dev.yml up -d

# הפעלת הבוט
python main.py
```

### 2. Docker Compose (המלצה לפיתוח)
```bash
# הפעלת הסטאק המלא
docker-compose -f docker-compose.dev.yml up

# עם ניטור
docker-compose up
```

### 3. Render.com (המלצה לייצור)
```yaml
services:
  - type: worker        # בוט Telegram
  - type: web           # Flask API

databases:
  - MongoDB Atlas       # מסד נתונים מנוהל
  - Redis (אופציונלי)  # מטמון
```

### 4. VPS עם Docker
```bash
# שכפול repository
git clone https://github.com/amirbiron/CodeBot.git

# הגדרת משתני סביבה
cp .env.example .env
# עריכת .env עם ערכים בפועל

# הפעלה
docker-compose up -d
```

---

## 📚 משאבים נוספים

### תיעוד
- **ReadTheDocs**: תיעוד API מלא
- **README.md**: מדריך התחלה מהירה
- **CONTRIBUTING.md**: מדריך תרומה
- **docs/**: תיעוד מפורט של כל המודולים

### קבצי הגדרה חשובים
- `.env.example` - משתני סביבה לדוגמה
- `config.py` - ניהול הגדרות מרכזי
- `docker-compose.yml` - סטאק ייצור
- `docker-compose.dev.yml` - סטאק פיתוח
- `requirements/` - ניהול תלויות

---

## 🎉 סיכום

**CodeBot** הוא פתרון מקיף ברמת enterprise לניהול קוד עם:

✅ **150+ תכונות בבוט Telegram**
✅ **130+ תכונות ב-Web App**
✅ **100+ שפות תכנות נתמכות**
✅ **ניהול גרסאות מובנה**
✅ **אינטגרציות GitHub ו-Google Drive מלאות**
✅ **מערכת חיפוש מתקדמת (Regex, Fuzzy, Full-Text)**
✅ **קהילת משתמשים עם ספריית סניפטים**
✅ **Observability מקצועית (Logs, Metrics, Tracing)**
✅ **אבטחה חזקה עם סריקות אוטומטיות**
✅ **DevOps מקצועי (Docker, CI/CD, Monitoring)**
✅ **תיעוד מקיף ובדיקות**

הארכיטקטורה תומכת באלפי משתמשים מקבילים עם זמן תגובה מהיר, אמינות גבוהה, ותחזוקה קלה.

---

**נוצר ב-:** נובמבר 2025
**גרסה:** 1.0.0
**Repository:** [github.com/amirbiron/CodeBot](https://github.com/amirbiron/CodeBot)
**רישיון:** MIT

