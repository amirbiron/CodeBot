## Render deployment example for Prometheus + Alertmanager

# --- Common ---------------------------------------------------------------
# חובה לעדכן את הערכים האמיתיים לפני העלאה ל-Render! (קובץ זה לא רץ כפי שהוא)

# שם האפליקציה כפי שיעלה ל-Render (לא חובה בקובץ אבל עוזר לזכור)
# SERVICE_NAME=code-keeper-prometheus

# Render מספק PORT בזמן ריצה; לא נדרש לערוך. כאן רק ברירת מחדל מקומית
PORT=9090

# כתובת ה-WebApp שעליו Prometheus מגרד /metrics (ללא https://)
WEBAPP_HOST=code-keeper-webapp.onrender.com

# כתובת ה-Alertmanager (host:port). Render יוצר דומיין לפי שם השירות
ALERTMANAGER_TARGET=code-keeper-alertmanager.onrender.com:443

# --- Alertmanager service -------------------------------------------------

# שירות Alertmanager מאזין על PORT מהסביבה (ברירת מחדל 9093)
ALERTMANAGER_PORT=9093

# ה-Webhook של ה-WebApp לקבלת התראות (כולל https://)
ALERT_WEBHOOK_URL=https://code-keeper-webapp.onrender.com/alertmanager/webhook

# אופציונלי: כותרת ברירת מחדל להתראות (אם רוצים להזין)
# ALERTMANAGER_DEFAULT_TITLE=CodeKeeper Alerts

# --- סודות / ניהול -------------------------------------------------------
# את הטוקנים/סודות האמיתיים מזינים בלוח הבקרה של Render ולא בקובץ הזה.
# השדות כאן הם placeholders בלבד כדי להזכיר מה צריך להגדיר:
#   ALERT_TELEGRAM_BOT_TOKEN=
#   ALERT_TELEGRAM_CHAT_ID=
#   GRAFANA_API_TOKEN=
# (וכו')

# --- Web Push (VAPID) -----------------------------------------------------
# מפתח ציבורי/פרטי ל‑Web Push. הזן ערכים אמיתיים בפריסה.
# VAPID_PUBLIC_KEY=
# VAPID_PRIVATE_KEY=
# כתובת מייל ל‑subject (אופציונלי):
# VAPID_SUB_EMAIL=support@example.com
# הפעלה/כיבוי שולח פושים בצד השרת (ברירת מחדל: true)
# PUSH_NOTIFICATIONS_ENABLED=true

# --- Remote Push Delivery (Worker) -----------------------------------------
# הפעלת שליחה דרך Worker חיצוני במקום pywebpush בצד השרת
# PUSH_REMOTE_DELIVERY_ENABLED=false
# כתובת הבסיס של ה-Worker (ללא /send בסוף). ב-Sidecar השתמש ב-localhost:
# PUSH_DELIVERY_URL=http://127.0.0.1:18080
# PUSH_DELIVERY_URL=
# טוקן Bearer לאימות שרת→Worker
# PUSH_DELIVERY_TOKEN=
# Timeout לשיחת /send (שניות)
# PUSH_DELIVERY_TIMEOUT_SECONDS=3

# --- Sidecar (Worker באותו קונטיינר) --------------------------------------
# פורט פנימי עליו ה-Worker מאזין (לא ציבורי)
# PUSH_WORKER_PORT=18080
# ״סודות״ ל-Worker בלבד (לא לחשוף כ-VAPID_PRIVATE_KEY גלובלי):
# WORKER_VAPID_PUBLIC_KEY=
# WORKER_VAPID_PRIVATE_KEY=
# WORKER_VAPID_SUB_EMAIL=support@example.com

# --- הערות ---------------------------------------------------------------
# 1. קובץ זה הוא דוגמה בלבד. Render לא טוען אותו אוטומטית – יש להזין ידנית.
# 2. מתאים ל-blueprint הייעודי לניטור (`render.monitoring.yaml`).
# 3. להרצה מקומית ניתן להשתמש בפקודה: `export $(grep -v '^#' render.env.example)`.
# 4. מומלץ לא לשמור ערכי אמת בקובץ במאגר git.

# --- Database Health Dashboard --------------------------------------------
# Token להגנה על נתיבי /api/db/* (Authorization: Bearer <token>)
# DB_HEALTH_TOKEN=
# סף לזיהוי שאילתות איטיות (באלפיות שנייה)
# DB_HEALTH_SLOW_THRESHOLD_MS=1000
# תדירויות רענון בצד הלקוח (שניות) - לשימוש/תיעוד
# DB_HEALTH_POOL_REFRESH_SEC=5
# DB_HEALTH_OPS_REFRESH_SEC=10

# --- Query Performance Profiler --------------------------------------------
# האם הפרופיילר פעיל
# PROFILER_ENABLED=true
# סף זמן לשאילתה איטית (במילישניות)
# PROFILER_SLOW_THRESHOLD_MS=100
# מקסימום שאילתות בזיכרון
# PROFILER_MAX_BUFFER_SIZE=1000
# טוקן אימות ל-API (header: X-Profiler-Token)
# PROFILER_AUTH_TOKEN=
# allowlist IPs (מופרד בפסיקים) - אופציונלי
# PROFILER_ALLOWED_IPS=127.0.0.1,10.0.0.1
# Rate limit (בקשות לדקה)
# PROFILER_RATE_LIMIT=60
# Metrics לפרופיילר (Prometheus)
# PROFILER_METRICS_ENABLED=true
