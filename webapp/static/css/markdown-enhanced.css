/* ============================================
   עיצוב משופר לקטעים מתקפלים וכרטיסיות הסבר
   ============================================ */

/* === משתנים גלובליים === */
:root {
  --details-border: #e1e4e8;
  --details-bg: #ffffff;
  --details-hover: #f6f8fa;
  --summary-color: #24292e;
  --admonition-radius: 8px;
  --animation-speed: 0.3s;
}

/* === קטעים מתקפלים === */
.markdown-details {
  margin: 1rem 0;
  border: 1px solid var(--details-border);
  border-radius: 8px;
  background: var(--details-bg);
  overflow: hidden;
  transition: box-shadow var(--animation-speed) ease;
}

.markdown-details[open] {
  box-shadow: 0 3px 12px rgba(0, 0, 0, 0.08);
}

.markdown-summary {
  padding: 0.75rem 1rem;
  background: linear-gradient(to right, #f8f9fa, transparent);
  cursor: pointer;
  user-select: none;
  font-weight: 600;
  color: var(--summary-color);
  display: flex;
  align-items: center;
  transition: background-color var(--animation-speed) ease;
  position: relative;
}

.markdown-summary:hover {
  background: var(--details-hover);
}

.markdown-summary::before {
  content: '▶';
  display: inline-block;
  margin-left: 0.5rem;
  font-size: 0.8em;
  transition: transform var(--animation-speed) ease;
  color: #586069;
}

.markdown-details[open] .markdown-summary::before {
  transform: rotate(90deg);
}

.markdown-summary::-webkit-details-marker { display: none; }

.details-content {
  padding: 1rem;
  border-top: 1px solid var(--details-border);
  animation: slideDown var(--animation-speed) ease-out;
}

/* === כרטיסיות הסבר === */
.admonition {
  margin: 1.25rem 0;
  border-radius: var(--admonition-radius);
  overflow: hidden;
  border-right: 4px solid;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.06);
}

.admonition-title {
  padding: 0.75rem 1rem;
  font-weight: 700;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.admonition-content {
  padding: 1rem;
  background: rgba(255, 255, 255, 0.8);
}

.admonition-content > *:first-child { margin-top: 0; }
.admonition-content > *:last-child { margin-bottom: 0; }

/* סוגים */
.admonition-note { border-color: #0969da; background: #ddf4ff; }
.admonition-note .admonition-title { background: #b6e3ff; color: #0550ae; }

.admonition-tip { border-color: #1a7f37; background: #dafbe1; }
.admonition-tip .admonition-title { background: #aceebb; color: #116329; }

.admonition-warning { border-color: #9a6700; background: #fff8c5; }
.admonition-warning .admonition-title { background: #ffec99; color: #7d4e00; }

.admonition-danger { border-color: #cf222e; background: #ffebe9; }
.admonition-danger .admonition-title { background: #ffcecb; color: #a40e26; }

.admonition-info { border-color: #0969da; background: #ddf4ff; }
.admonition-info .admonition-title { background: #b6e3ff; color: #0550ae; }

.admonition-success { border-color: #1a7f37; background: #dafbe1; }
.admonition-success .admonition-title { background: #aceebb; color: #116329; }

/* סוגים נוספים */
.admonition-question { border-color: #8250df; background: #f5f0ff; }
.admonition-question .admonition-title { background: #e6dcfd; color: #5e3db3; }

.admonition-example { border-color: #1f6feb; background: #ddf4ff; }
.admonition-example .admonition-title { background: #b6e3ff; color: #0550ae; }

.admonition-quote { border-color: #57606a; background: #f6f8fa; }
.admonition-quote .admonition-title { background: #eaeef2; color: #24292f; }

.admonition-experimental { border-color: #bf8700; background: #fff1b6; }
.admonition-experimental .admonition-title { background: #ffe08a; color: #7d5b00; }

.admonition-deprecated { border-color: #8b949e; background: #f2f2f2; }
.admonition-deprecated .admonition-title { background: #e6e6e6; color: #555; }

.admonition-todo { border-color: #0969da; background: #e7f5ff; }
.admonition-todo .admonition-title { background: #cfe8ff; color: #0550ae; }

.admonition-abstract { border-color: #6e7781; background: #eef2f7; }
.admonition-abstract .admonition-title { background: #dce3ea; color: #374151; }

/* === אנימציות === */
@keyframes slideDown {
  from { opacity: 0; transform: translateY(-10px); }
  to { opacity: 1; transform: translateY(0); }
}

/* === RTL === */
[dir="rtl"] .admonition { border-right: none; border-left: 4px solid; }
[dir="rtl"] .markdown-summary::before { margin-left: 0; margin-right: 0.5rem; }

/* === מובייל === */
@media (max-width: 768px) {
  .markdown-details, .admonition { margin: 0.75rem -0.5rem; border-radius: 0; }
  .admonition-content, .details-content { padding: 0.75rem; }
}

/* === מצב כהה === */
@media (prefers-color-scheme: dark) {
  :root {
    --details-border: #30363d;
    --details-bg: #0d1117;
    --details-hover: #161b22;
    --summary-color: #c9d1d9;
  }
  .markdown-details { background: var(--details-bg); }
  .admonition-content { background: rgba(0, 0, 0, 0.3); color: #c9d1d9; }
}

/* === Header anchors & copy buttons accessibility additions === */
.header-anchor {
  margin-left: 0.5em;
  opacity: 0;
  color: #6c757d;
  text-decoration: none;
  font-size: 0.8em;
  transition: opacity 0.2s ease, color 0.2s ease;
  vertical-align: middle;
}
.header-anchor:focus {
  opacity: 1;
  outline: 2px solid #0366d6;
  outline-offset: 2px;
  border-radius: 3px;
}
h1:hover .header-anchor,
h2:hover .header-anchor,
h3:hover .header-anchor,
h4:hover .header-anchor,
h5:hover .header-anchor,
h6:hover .header-anchor { opacity: 1; }
.header-anchor:hover { color: #0366d6; transform: scale(1.05); }

.permalink-tooltip {
  background: rgba(0, 0, 0, 0.8);
  color: white;
  padding: 5px 10px;
  border-radius: 4px;
  font-size: 12px;
  white-space: nowrap;
  pointer-events: none;
  transition: opacity 0.3s ease;
  z-index: 1000;
}

/* Visually hidden but accessible to screen readers */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/* Dark/contrast/reduced motion adjustments */
@media (prefers-color-scheme: dark) {
  .header-anchor { color: #8b949e; }
  .permalink-tooltip { background: rgba(255, 255, 255, 0.9); color: #000; }
}
@media (prefers-contrast: high) {
  .header-anchor:focus { outline-width: 3px; }
}
@media (prefers-reduced-motion: reduce) {
  .header-anchor, .permalink-tooltip { transition: none; }
}
