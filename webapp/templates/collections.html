{% extends "base.html" %}
{% block title %}住驻 砖 路 Code Keeper{% endblock %}

{% block content %}
<div class="glass-card">
  <h1 class="page-title"> 住驻 砖</h1>
  <p> 住 MVP.  转爪注 专 -API. 砖 住祝 UI .</p>
  <div id="collectionsRoot" class="section">
    <button class="btn btn-primary" onclick="createDemoCollection()">爪专 住祝 </button>
    <div id="collectionsList" style="margin-top:1rem;"></div>
  </div>
</div>
<script>
async function fetchCollections(){
  const r = await fetch('/api/collections');
  if(!r.ok){ document.getElementById('collectionsList').innerText = '砖 注'; return; }
  const data = await r.json();
  if(!data.ok){ document.getElementById('collectionsList').innerText = data.error || '砖'; return; }
  const list = (data.collections||[]).map(c => `<div class="badge" style="margin:0 .5rem .5rem 0">${escapeHtml(c.name)}<small style="margin-right:.5rem;opacity:.8">(${c.items_count||0})</small></div>`).join('');
  document.getElementById('collectionsList').innerHTML = list || '<div class="badge"> 住驻</div>';
}
async function createDemoCollection(){
  const r = await fetch('/api/collections', {method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({name:'住祝 砖', mode:'manual'})});
  await fetchCollections();
}
function escapeHtml(s){ const d=document.createElement('div'); d.textContent=String(s||''); return d.innerHTML; }
fetchCollections();
</script>
{% endblock %}
