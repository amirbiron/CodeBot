{% extends "repo/base_repo.html" %}

{% block tree_content %}
<div class="tree-view" id="file-tree">
    <!-- Tree will be populated by JavaScript -->
</div>
{% endblock %}

{% block code_content %}
<div class="code-viewer-container" id="code-viewer-container">
    <!-- Breadcrumbs -->
    <div class="code-header" id="code-header" style="display: none;">
        <div class="file-header"></div>
        <nav aria-label="breadcrumb" class="file-breadcrumb">
            <ol class="breadcrumb" id="file-breadcrumb">
                <!-- Populated by JS -->
            </ol>
        </nav>
        <div class="file-actions">
            <button class="btn-icon" id="search-in-file" title="Search in file (Ctrl+F)" onclick="searchInFile()">
                <i class="bi bi-search"></i>
            </button>
            <button class="btn-icon" id="copy-path" title="Copy path">
                <i class="bi bi-clipboard"></i>
            </button>
            <a class="btn-icon" id="github-link" href="#" target="_blank" title="View on GitHub">
                <i class="bi bi-github"></i>
            </a>
        </div>
    </div>

    <!-- In-file Search Bar -->
    <div class="in-file-search" id="in-file-search" style="display: none;">
        <input type="text" id="in-file-search-input" placeholder="Search in file..." autocomplete="off">
        <span id="in-file-search-count"></span>
        <button class="btn-icon" onclick="findPrevMatch()" title="Previous"><i class="bi bi-chevron-up"></i></button>
        <button class="btn-icon" onclick="findNextMatch()" title="Next"><i class="bi bi-chevron-down"></i></button>
        <button class="btn-icon" onclick="closeInFileSearch()" title="Close"><i class="bi bi-x"></i></button>
    </div>

    <!-- Code Editor Container -->
    <div class="code-editor-wrapper" id="code-editor-wrapper" style="display: none;">
        <textarea id="code-editor"></textarea>
    </div>

    <!-- File Info Footer -->
    <div class="code-footer" id="code-footer" style="display: none;">
        <span class="file-info" id="file-info">
            <!-- Lines: 245 | Size: 8.2KB | Python -->
        </span>
    </div>

    <!-- Welcome Screen (shown when no file selected) -->
    <div class="welcome-screen" id="welcome-screen">
        <div class="welcome-icon">
            <i class="bi bi-code-square"></i>
        </div>
        <h3>ברוכים הבאים לדפדפן הקוד</h3>
        <p>בחר קובץ מהעץ משמאל, או השתמש בחיפוש למעלה</p>
        <div class="quick-actions">
            <button class="btn btn-outline-primary" onclick="focusSearch()">
                <i class="bi bi-search"></i>
                חפש קובץ (Ctrl+K)
            </button>
        </div>
        
        <!-- Recent Files -->
        <div class="recent-files" id="recent-files">
            <h5><i class="bi bi-clock-history"></i> קבצים אחרונים</h5>
            <ul class="recent-files-list" id="recent-files-list">
                <!-- Populated from localStorage -->
            </ul>
        </div>
    </div>
</div>
{% endblock %}
