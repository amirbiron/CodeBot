{% extends "base.html" %}

{% block title %}转专 住驻专转 住驻{% endblock %}

{% block content %}
<h1 class="page-title"> 爪/ 转专转 住驻专转 住驻</h1>

{% if error %}
  <div class="alert alert-warning">{{ error }}</div>
{% endif %}

{% if import_result %}
  <div class="glass-card" style="margin-bottom: 1rem;">
    <h3>转爪转 </h3>
    <ul>
      <li>住状 专砖转 拽抓: <strong>{{ import_result.total }}</strong></li>
      <li>注 ({{ import_result.dry_run and '住爪' or '驻注' }}): <strong>{{ import_result.updated }}</strong></li>
      <li>/砖: <strong>{{ import_result.skipped }}</strong></li>
      <li>爪: <strong>{{ import_result.dry_run and '拽 (Dry Run)' or '爪注 驻注' }}</strong></li>
    </ul>
    {% if import_result.errors %}
      <details>
        <summary style="cursor: pointer;">爪 砖转 (注 20 专砖转)</summary>
        <ol>
          {% for err in import_result.errors %}
            <li>{{ err }}</li>
          {% endfor %}
        </ol>
      </details>
    {% endif %}
  </div>
{% endif %}

<div class="glass-card">
  <h2 class="section-title">爪 </h2>
  <ul>
    <li>住驻 砖专 -DB: <strong>{{ stats.approved }}</strong></li>
    <li>住驻 转: <strong>{{ stats.pending }}</strong></li>
    <li>Built-in 拽: <strong>{{ builtin_count }}</strong> (专砖转 注专 -<code>services/snippet_library_service.py</code>)</li>
  </ul>
  <p style="opacity: 0.8; font-size: 0.95rem;">
    爪/  注 专拽 驻专 砖砖专 住 转.  砖转 Built-in 砖 驻转 PR 砖注 转 拽抓 专.
  </p>
</div>

<div class="glass-card" style="margin-top: 1rem;">
  <h2 class="section-title">猬锔 爪 JSON</h2>
  <p>爪 注 驻转专 转专 拽抓 JSON 注 砖转 <code>id,title,language,description,status</code>. 转 砖转祝 转 转专 爪    AI.</p>
  <form method="get" action="/admin/snippets/export-json" style="display:flex; align-items:center; gap:1rem; flex-wrap:wrap;">
    <label style="display:flex; align-items:center; gap:.35rem; margin:0;">
      <input type="checkbox" name="include_pending" value="1">
        住驻 爪 pending
    </label>
    <button class="btn btn-secondary" type="submit">猬锔 专 JSON</button>
  </form>
</div>

<div class="glass-card" style="margin-top: 1rem;">
  <h2 class="section-title">猬锔  专</h2>
  <p>注 拽抓 JSON 驻专  (注专 砖 拽).  砖专 注 砖 <code>id</code>, 转 注 转 <code>title</code>/<code>description</code>/<code>language</code>/<code>code</code> 驻 爪专.</p>
  <pre dir="ltr" style="background: rgba(255,255,255,0.05); padding: .75rem; border-radius: 8px; overflow:auto;">[
  {"id": "64fa...", "title": "转专转 砖", "language": "python"},
  {"id": "64fb...", "title": "Title en Fran莽ais"}
]</pre>
  <form method="post" action="/admin/snippets/translate" enctype="multipart/form-data" style="display:flex; flex-direction:column; gap:1rem;">
    <div>
      <label class="btn btn-light" style="cursor:pointer;">
        专 拽抓 JSON
        <input type="file" name="json_file" accept="application/json" style="display:none;">
      </label>
    </div>
    <label style="display:flex; align-items:center; gap:.35rem;">
      <input type="checkbox" name="dry_run" value="1" {% if default_dry_run %}checked{% endif %}>
      爪 拽 ( 转 -DB)
    </label>
    <button class="btn btn-primary" type="submit"> 专抓 </button>
  </form>
  <p style="opacity: 0.8; font-size: 0.95rem; margin-top: .5rem;">
    抓 转 -Dry Run   砖拽抓 驻专 转拽. 专   转 住   转 转专 驻注.
  </p>
</div>
{% endblock %}
