{% extends "base.html" %}

{% block title %} 住驻专转 住驻{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="/static/css/community_library.css?v={{ static_version }}">
<link rel="stylesheet" href="/static/css/snippets.css?v={{ static_version }}">
<!-- Highlight.js theme (matches file viewer dark style) - via jsDelivr (allowed by CSP) -->
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.9.0/styles/github-dark-dimmed.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.9.0/styles/github-dark-dimmed.min.css"></noscript>
{% endblock %}

{% block content %}
<div class="community-header">
  <div class="title">
    <h1> 住驻专转 住驻</h1>
    <p class="subtitle">专 住驻  注转拽 - 驻砖 驻 砖驻, 转专转  转专</p>
  </div>
  <div class="actions">
    <a class="btn primary" href="/snippets/submit">+ 住祝 住驻 砖</a>
  </div>
</div>
<script>window.__isAdmin = {{ 'true' if is_admin else 'false' }};</script>

<div class="community-controls">
  <input id="q" type="text" placeholder=" 驻砖 驻 转专转  转专..." />
  <div style="display:flex; gap:.5rem; align-items:center;">
    <input id="language" type="text" placeholder="砖驻 (砖: python)" list="languagesList" />
    <button id="langPickerBtn" class="btn btn-secondary" type="button" title="专 砖驻">专</button>
  </div>
  <button id="searchBtn" class="btn btn-primary">驻砖</button>
  
</div>

<div id="results" class="community-grid"></div>

<nav id="pager" style="display:flex; gap:.5rem; justify-content:center; margin-top:1rem;"></nav>
<datalist id="languagesList"></datalist>

<!-- Language picker overlay -->
<div id="langOverlay" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,.45); z-index:1000; align-items:center; justify-content:center;">
  <div style="background: var(--card-bg, rgba(255,255,255,0.08)); border:1px solid rgba(255,255,255,0.18); padding:1rem; border-radius:12px; width:min(520px, 92vw); max-height:70vh; overflow:auto; backdrop-filter: blur(6px);">
    <div style="display:flex; justify-content:space-between; align-items:center; gap:.5rem; margin-bottom:.5rem;">
      <strong>专 砖驻</strong>
      <button id="langOverlayClose" class="btn btn-secondary btn-sm" type="button">住专</button>
    </div>
    <div id="langList" style="display:grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap:.5rem;"></div>
  </div>
  <button type="button" aria-hidden="true" style="position:absolute; inset:0; background:none; border:none;" id="langOverlayBackdrop"></button>
  
</div>
{% endblock %}

{% block extra_js %}
<!-- Highlight.js core (via jsDelivr) -->
<script defer src="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.9.0/highlight.min.js"></script>
<!-- Highlight.js line numbers plugin (via jsDelivr) -->
<script defer src="https://cdn.jsdelivr.net/npm/highlightjs-line-numbers.js@2.11.0/dist/highlightjs-line-numbers.min.js"></script>
<!-- Our page script (runs after hljs is available due to defer order) -->
<script defer src="/static/js/snippets.js?v={{ static_version }}"></script>
{% endblock %}
