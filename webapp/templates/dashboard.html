{% extends "base.html" %}

{% block title %} 拽专 - Code Keeper{% endblock %}

{% block content %}
<div class="fade-in">
    <!-- Welcome Section -->
    <div class="glass-morphism p-8 rounded-2xl mb-8">
        <div class="flex justify-between items-center">
            <div>
                <h1 class="text-4xl font-bold text-white mb-2">
                    砖, {{ username }}! 
                </h1>
                <p class="text-white opacity-80">
                    专   拽专 砖
                </p>
            </div>
            <div class="text-left">
                <a href="https://t.me/CodeKeeperBot" target="_blank" class="bg-white text-purple-600 px-6 py-3 rounded-full font-semibold hover-scale inline-block">
                    <i class="fab fa-telegram"></i> 驻转 转 
                </a>
            </div>
        </div>
    </div>
    
    <!-- Statistics Cards -->
    <div class="grid md:grid-cols-4 gap-6 mb-8">
        <div class="glass-morphism p-6 rounded-2xl hover-scale">
            <div class="flex items-center justify-between mb-4">
                <div class="text-3xl text-white">
                    <i class="fas fa-file-code"></i>
                </div>
                <div class="text-left">
                    <div class="text-3xl font-bold text-white">{{ stats.total_files|default(0) }}</div>
                    <div class="text-white opacity-70">拽爪</div>
                </div>
            </div>
            <div class="text-white opacity-60 text-sm">
                转 {{ 1000 }} 转专
            </div>
            <div class="w-full bg-white bg-opacity-20 rounded-full h-2 mt-2">
                <div class="bg-white rounded-full h-2" style="width: {{ (stats.total_files|default(0) / 10)|round|int }}%"></div>
            </div>
        </div>
        
        <div class="glass-morphism p-6 rounded-2xl hover-scale">
            <div class="flex items-center justify-between mb-4">
                <div class="text-3xl text-white">
                    <i class="fas fa-code-branch"></i>
                </div>
                <div class="text-left">
                    <div class="text-3xl font-bold text-white">{{ stats.total_versions|default(0) }}</div>
                    <div class="text-white opacity-70">专住转</div>
                </div>
            </div>
            <div class="text-white opacity-60 text-sm">
                爪注 {{ (stats.total_versions|default(0) / (stats.total_files|default(1)))|round(1) }} 拽抓
            </div>
        </div>
        
        <div class="glass-morphism p-6 rounded-2xl hover-scale">
            <div class="flex items-center justify-between mb-4">
                <div class="text-3xl text-white">
                    <i class="fas fa-language"></i>
                </div>
                <div class="text-left">
                    <div class="text-3xl font-bold text-white">{{ stats.languages|length|default(0) }}</div>
                    <div class="text-white opacity-70">砖驻转</div>
                </div>
            </div>
            <div class="text-white opacity-60 text-sm">
                {% if stats.languages %}
                    {{ stats.languages[:3]|join(', ') }}
                {% else %}
                    专 住驻 拽爪
                {% endif %}
            </div>
        </div>
        
        <div class="glass-morphism p-6 rounded-2xl hover-scale">
            <div class="flex items-center justify-between mb-4">
                <div class="text-3xl text-white">
                    <i class="fas fa-clock"></i>
                </div>
                <div class="text-left">
                    <div class="text-2xl font-bold text-white">
                        {% if stats.latest_activity %}
                            {{ stats.latest_activity.strftime('%d/%m') }}
                        {% else %}
                            --/--
                        {% endif %}
                    </div>
                    <div class="text-white opacity-70">注 专</div>
                </div>
            </div>
            <div class="text-white opacity-60 text-sm">
                {% if stats.latest_activity %}
                    {{ stats.latest_activity.strftime('%H:%M') }}
                {% else %}
                     驻注转
                {% endif %}
            </div>
        </div>
    </div>
    
    <!-- Quick Actions -->
    <div class="glass-morphism p-8 rounded-2xl mb-8">
        <h2 class="text-2xl font-bold text-white mb-6">驻注转 专转</h2>
        <div class="grid md:grid-cols-4 gap-4">
            <a href="/files" class="bg-white bg-opacity-20 hover:bg-opacity-30 transition p-4 rounded-xl text-center">
                <i class="fas fa-folder-open text-3xl text-white mb-2"></i>
                <p class="text-white font-semibold">注 拽爪</p>
            </a>
            <a href="/files?language=python" class="bg-white bg-opacity-20 hover:bg-opacity-30 transition p-4 rounded-xl text-center">
                <i class="fab fa-python text-3xl text-white mb-2"></i>
                <p class="text-white font-semibold">拽爪 Python</p>
            </a>
            <a href="/files?language=javascript" class="bg-white bg-opacity-20 hover:bg-opacity-30 transition p-4 rounded-xl text-center">
                <i class="fab fa-js text-3xl text-white mb-2"></i>
                <p class="text-white font-semibold">拽爪 JavaScript</p>
            </a>
            <a href="https://t.me/CodeKeeperBot" target="_blank" class="bg-white bg-opacity-20 hover:bg-opacity-30 transition p-4 rounded-xl text-center">
                <i class="fas fa-plus-circle text-3xl text-white mb-2"></i>
                <p class="text-white font-semibold">住祝 拽抓 砖</p>
            </a>
        </div>
    </div>
    
    <!-- Recent Files -->
    {% if recent_files %}
    <div class="glass-morphism p-8 rounded-2xl">
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-2xl font-bold text-white">拽爪 专</h2>
            <a href="/files" class="text-white opacity-80 hover:opacity-100 transition">
                专  <i class="fas fa-arrow-left"></i>
            </a>
        </div>
        
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4">
            {% for file in recent_files[:6] %}
            <div class="file-card bg-white bg-opacity-10 rounded-xl p-4 hover:bg-opacity-20 transition">
                <a href="/file/{{ file._id }}" class="block">
                    <div class="flex items-start justify-between mb-2">
                        <h3 class="text-white font-semibold truncate flex-1">
                            {{ file.file_name }}
                        </h3>
                        <span class="language-badge mr-2">
                            {{ file.programming_language }}
                        </span>
                    </div>
                    <p class="text-white opacity-70 text-sm mb-2">
                        {% if file.description %}
                            {{ file.description[:50] }}{% if file.description|length > 50 %}...{% endif %}
                        {% else %}
                             转专
                        {% endif %}
                    </p>
                    <div class="flex justify-between items-center">
                        <span class="text-white opacity-60 text-xs">
                            <i class="fas fa-clock"></i> {{ file.updated_at.strftime('%d/%m %H:%M') }}
                        </span>
                        <span class="text-white opacity-60 text-xs">
                            <i class="fas fa-code"></i> {{ file.code|length if file.code else 0 }} 转
                        </span>
                    </div>
                </a>
            </div>
            {% endfor %}
        </div>
    </div>
    {% else %}
    <div class="glass-morphism p-12 rounded-2xl text-center">
        <i class="fas fa-inbox text-6xl text-white opacity-50 mb-4"></i>
        <h3 class="text-2xl font-bold text-white mb-2"> 拽爪 注</h3>
        <p class="text-white opacity-70 mb-6">转 砖专 拽注 拽 专  专</p>
        <a href="https://t.me/CodeKeeperBot" target="_blank" class="bg-white text-purple-600 px-6 py-3 rounded-full font-semibold hover-scale inline-block">
            <i class="fab fa-telegram"></i> 转 注砖
        </a>
    </div>
    {% endif %}
</div>
{% endblock %}