{% extends "base.html" %}

{% block title %}×“×™×‘×•×’ Web Push - Code Keeper Bot{% endblock %}

{% block content %}
<h1 class="page-title">
  <i class="fas fa-bug"></i>
  ×“×™×‘×•×’ Web Push
</h1>

<div class="glass-card">
  <h2 class="section-title">
    <i class="fas fa-server"></i>
    ×¡×˜×˜×•×¡ ×©×¨×ª
  </h2>
  <div class="glass-card" style="background: rgba(255, 255, 255, 0.05)">
    <div style="display: grid; grid-template-columns: 1fr; gap: 0.6rem">
      <div><strong>PUSH_NOTIFICATIONS_ENABLED:</strong> {{ 'ğŸŸ¢ true' if push_enabled else 'ğŸ”´ false' }}</div>
      <div><strong>VAPID_PUBLIC_KEY:</strong> {{ 'ğŸŸ¢ ××•×’×“×¨' if vapid_public_set else 'ğŸ”´ ×—×¡×¨' }}</div>
      <div><strong>VAPID_PRIVATE_KEY:</strong> {{ 'ğŸŸ¢ ××•×’×“×¨' if vapid_private_set else 'ğŸ”´ ×—×¡×¨' }}</div>
      <div><strong>PUSH_REMOTE_DELIVERY_ENABLED:</strong> {{ remote_enabled_env if remote_enabled_env else 'â€”' }}</div>
      <div><strong>PUSH_DELIVERY_URL:</strong> {{ remote_url if remote_url else 'â€”' }}</div>
      <div><strong>PUSH_DELIVERY_TOKEN:</strong> {{ 'ğŸŸ¢ ××•×’×“×¨' if remote_token_set else 'ğŸ”´ ×—×¡×¨' }}</div>
    </div>
  </div>
</div>

<div class="glass-card">
  <h2 class="section-title">
    <i class="fas fa-database"></i>
    ×× ×•×™×™× (DB)
  </h2>
  <div class="glass-card" style="background: rgba(255, 255, 255, 0.05)">
    {% if subs_error %}
      <div style="opacity: 0.9">ğŸ”´ ×©×’×™××” ×‘×§×¨×™××ª DB: {{ subs_error }}</div>
    {% else %}
      <div><strong>Subscriptions count (user):</strong> {{ subs_count }}</div>
      <div style="opacity: 0.85; margin-top: 0.5rem">
        ×× ×”××¡×¤×¨ 0 â€“ ××™×Ÿ ×× ×•×™ ×‘×“×¤×“×¤×Ÿ/××›×©×™×¨ ×”×–×” (××• ×©×”-Subscribe ×œ× × ×©×œ×— ×œ×©×¨×ª).
      </div>
    {% endif %}
  </div>
</div>

<div class="glass-card">
  <h2 class="section-title">
    <i class="fas fa-mobile-screen"></i>
    ×œ×§×•×— (××™×“×¢ ×›×œ×œ×™)
  </h2>
  <div class="glass-card" style="background: rgba(255, 255, 255, 0.05)">
    <div style="opacity: 0.9; word-break: break-word">
      <strong>User-Agent:</strong> {{ user_agent if user_agent else 'â€”' }}
    </div>
    <div style="opacity: 0.85; margin-top: 0.75rem">
      ×ª×–×›×•×¨×ª: ×‘-iOS ×”×ª×¨××•×ª Web Push ×‘×“×¤×“×¤×Ÿ ×¢×•×‘×“×•×ª ×¨×§ ×›×©××ª×§×™× ×™× ××ª ×”××ª×¨ ×›â€‘PWA (Add to Home Screen).
      ×‘-Telegram/Embedded WebView ×œ×¤×¢××™× ××™×Ÿ ×ª××™×›×” ×‘-ServiceWorker/PushManager.
    </div>
  </div>
</div>

<div class="glass-card">
  <h2 class="section-title">
    <i class="fas fa-vial"></i>
    ×‘×“×™×§×•×ª
  </h2>
  <div class="glass-card" style="background: rgba(255, 255, 255, 0.05)">
    <div style="display: flex; gap: 0.5rem; flex-wrap: wrap">
      <form action="/settings/push-test" method="post" style="margin: 0">
        <button type="submit" class="btn btn-primary">
          ×©×œ×— ×¤×•×© ×‘×“×™×§×” (×©×¨×ª)
        </button>
      </form>
      <a href="/settings#push" class="btn btn-secondary">×—×–×¨×” ×œ×”×’×“×¨×•×ª</a>
    </div>
    <div style="opacity: 0.85; margin-top: 0.75rem">
      ×”×‘×“×™×§×” ×”×–×• ××—×–×™×¨×” JSON ×©×œ <code>/api/push/test</code>. ×× ××™×Ÿ ×× ×•×™×™× â€“ ×ª×§×‘×œ <code>no_subscriptions</code>.
    </div>
  </div>
</div>
{% endblock %}

