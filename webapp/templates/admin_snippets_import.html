{% extends "base.html" %}

{% block title %} 住驻 住{% endblock %}

{% block content %}
<h1 class="page-title">  住驻 住</h1>

<div class="glass-card">
  <p>拽  转  住 (Markdown)   转转 URL 砖 GitHub/Gist/Raw. 注专转 转 转专转 (##/###), 砖专转 <strong>"  砖砖:"</strong> 拽 专 -```...``` 转爪专 住驻 转.</p>

  {% if error %}
    <div class="alert alert-warning">{{ error }}</div>
  {% endif %}

  <form method="post" action="/admin/snippets/import">
    <div class="form-group">
      <label>拽砖专 住 (驻爪)</label>
      <input class="form-control" type="url" name="source_url" value="{{ source_url or '' }}" placeholder="https://...">
      <small class="form-text text-muted">  拽砖专   转, 注 转 住 转转 (转 转 -GitHub/Gist raw).</small>
    </div>

    <div class="form-group">
      <label>转  拽 (Markdown)</label>
      <textarea class="form-control" name="content" rows="18" dir="ltr" placeholder="# 转专转\n**  砖砖:** ...\n\n```python\nprint('hello')\n```">{{ content or '' }}</textarea>
    </div>

    <div class="form-row" style="display:flex; gap: .75rem; align-items:center; flex-wrap: wrap;">
      <label style="display:flex; align-items:center; gap:.35rem;">
        <input type="checkbox" name="auto_approve" {% if auto_approve is not defined or auto_approve %}checked{% endif %}>
        砖专 转 专 爪专
      </label>
      <label style="display:flex; align-items:center; gap:.35rem;">
        <input type="checkbox" name="dry_run" {% if dry_run %}checked{% endif %}>
        专爪转 拽 ( 转 -DB)
      </label>
      <button class="btn btn-primary" type="submit"> 专抓 </button>
      <a class="btn btn-secondary" href="/snippets">专 住驻专转 住驻</a>
    </div>
  </form>
</div>

{% if result %}
  <div class="glass-card" style="margin-top:1rem;">
    <h3>住</h3>
    <ul>
      <li>爪 住: <strong>{{ result.parsed }}</strong></li>
      <li>爪专: <strong>{{ result.created }}</strong></li>
      <li>砖专: <strong>{{ result.approved }}</strong></li>
      <li> (驻 驻 转专转): <strong>{{ result.skipped }}</strong></li>
      <li>砖专 : <strong>{{ '' if result.auto_approve else '' }}</strong></li>
      <li>爪 拽: <strong>{{ '' if result.dry_run else '' }}</strong></li>
    </ul>
    <details>
      <summary style="cursor:pointer;">爪 转专转 砖</summary>
      <ol>
        {% for t in result.titles %}
          <li>{{ t }}</li>
        {% endfor %}
      </ol>
    </details>
  </div>
{% endif %}
{% endblock %}
