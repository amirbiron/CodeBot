# הצעות חדשות לשיפור ה‑WebApp (ללא כפילות מול Issue #747)

תאריך: 2025‑10‑17
מטרה: להציע שיפורים מעשיים ושדרוגי UX/פיצ׳רים שאינם מופיעים במסמך ההצעות ב‑Issue #747, ושהם מתאימים לסטאק הקיים (Flask + Jinja + MongoDB + Redis + סטטיקה פשוטה, ללא בנדלר).

הערה: נושאים שכבר כוסו ב‑#747 (כמו ETag/304, אינדקסים ב‑Mongo, Rate‑Limit, CSRF, Multi‑select, TOC ל‑Markdown, PWA לקריאה‑בלבד ועוד) אינם חוזרים כאן.

---

## אבטחה וציות

1) CSP עם nonces ו‑strict‑dynamic + הוצאת inline JS
- למה: מקטין משמעותית סיכוני XSS ומאפשר CSP הדוק בלי לשבור פונקציונליות.
- מה מוסיפים: מעבר מסקריפטים inline ל‑`/static/js/*.js`, הזרקת nonce לבקשה, `Content‑Security‑Policy: script-src 'self' 'nonce-…' 'strict-dynamic'`.
- איך בקצרה: פילטר `before_request` שמייצר nonce, החלפה הדרגתית של inline לסטטי, בדיקות ידניות בעמודים כבדים (files/view_file/md_preview).
- אימפקט/מאמץ: גבוה/בינוני‑גבוה.

2) בידוד תצוגות ציבוריות/HTML Preview
- למה: לצמצם blast‑radius לקוד HTML/JS שמוצג למשתמש.
- מה מוסיפים: כותרות COOP/COEP/CORP לתצוגות ציבוריות, שקילת Subdomain נפרד ל‑`shared`/`raw_html` או חיזוק sandbox.
- איך בקצרה: הוספת headers יעודיים ב‑routes הציבוריים; אפשרות מעבר בהדרגה לתת‑דומיין.
- אימפקט/מאמץ: גבוה/בינוני.

3) קישורי הורדה חתומים קצרי‑מועד
- למה: צמצום זליגה/הפצה לא מבוקרת של קבצים שהורדו.
- מה מוסיפים: URL עם חתימה/תפוגה (HMAC + exp) ל‑`/download/<id>`; ביטול על פי משתמש.
- אימפקט/מאמץ: בינוני/בינוני.

4) סריקת סודות בהעלאה
- למה: מניעת שמירת מפתחות/סודות בטעות.
- מה מוסיפים: בדיקת patterns נפוצים (AWS, GH PAT, Slack, וכו׳) בצד שרת; התראה/חסימה עם opt‑out פר‑משתמש.
- אימפקט/מאמץ: גבוה/בינוני.

5) יומן ביקורת (Audit Log) וניהול סשנים
- למה: אחריותיות ושקיפות לשינויים רגישים.
- מה מוסיפים: לוג טיפולים: יצירה/מחיקה/שיתוף/ייצוא; מסך “מכשירים מחוברים” עם ניתוק.
- אימפקט/מאמץ: בינוני/בינוני.

6) Permissions‑Policy מינימלית
- למה: הקטנת שטח תקיפה של APIs דפדפניים לא נחוצים.
- מה מוסיפים: `Permissions-Policy: geolocation=(), camera=(), microphone=(), …` לפי צורך.
- אימפקט/מאמץ: בינוני/נמוך.

---

## ביצועים ונראות רשת

7) Fingerprint לקבצי סטטיקה + Cache אימותי
- למה: שיפור מטמון דפדפן והפחתת בקשות חוזרות.
- מה מוסיפים: שמות קבצים עם hash (או query‑version) ו‑`Cache-Control: public, max-age=31536000, immutable` ל‑`/static`.
- אימפקט/מאמץ: גבוה/בינוני.

8) גופנים מקומיים (self‑host) עם `font-display: swap`
- למה: טעינת טקסט מיידית ללא FOUT מורגש.
- מה מוסיפים: הורדת Heebo לאחסון מקומי, CSS עם `@font-face` ו‑`swap`.
- אימפקט/מאמץ: בינוני/נמוך.

9) Prefetch חכם לניווט/דפדוף
- למה: הורדת זמן מ‑click ל‑render בעמודי `files`.
- מה מוסיפים: Prefetch ל‑`next_cursor`/עמוד הבא בעת idle, ביטול דינמי ברשת איטית.
- אימפקט/מאמץ: בינוני/נמוך.

10) מטמון לקוח לחיפוש גלובלי (Stale‑While‑Revalidate קליינט)
- למה: תוצאות מיידיות לשאילתות חוזרות.
- מה מוסיפים: שמירת snapshot ב‑IndexedDB/LocalStorage עם מפתח (`query+filters`), רענון ברקע.
- אימפקט/מאמץ: בינוני/נמוך‑בינוני.

11) מצב "חיסכון בנתונים" (prefers‑reduced‑data)
- למה: הפחתת משקל/אנימציות במכשירים חלשים או רשת יקרה.
- מה מוסיפים: CSS/JS שמנטרלים רקעים כבדים ואנימציות, טעינה עצלה לקבצים כבדים.
- אימפקט/מאמץ: בינוני/נמוך.

---

## UX ונוחות שימוש

12) העלאה בגרירה/הדבקה ישירות מ‑`/files`
- למה: זירוז זרימת עבודה יומיומית.
- מה מוסיפים: Drop‑zone בפס העליון + תמיכה ב‑paste לקוד.
- אימפקט/מאמץ: גבוה/בינוני.

13) פאנל פרטי קובץ בצד (Slide‑over) ברשימה
- למה: חיסכון בניווט קדימה/אחורה.
- מה מוסיפים: קליק/חצי מקלדת פותחים פרטים, תגיות, פעולות – בלי עזיבת העמוד.
- אימפקט/מאמץ: גבוה/בינוני.

14) מסך עזרה לקיצורים – `?`
- למה: גילוייות לקיצורי מקלדת קיימים.
- מה מוסיפים: overlay עם רשימת קיצורים והדגמה קצרה.
- אימפקט/מאמץ: בינוני/נמוך.

15) שדרוג חיפוש בקוד (צפיין קבצים)
- למה: שליטה מדויקת יותר על חיפוש במסמך.
- מה מוסיפים: טוגלים ל‑Case Sensitive, Whole Word, Regex + “Jump to line”.
- אימפקט/מאמץ: בינוני/נמוך.

16) Minimap ניסיוני לצפיין קוד
- למה: ניווט מהיר בקבצים ארוכים.
- מה מוסיפים: פס סקירה צר (Canvas/CSS) עם חיווי למופעי חיפוש.
- אימפקט/מאמץ: בינוני/בינוני.

17) מצב הדפסה נקי (Code/Markdown)
- למה: ייצוא/שיתוף כ‑PDF מודפס יפה.
- מה מוסיפים: stylesheet יעודי להדפסה + כפתור "הדפסה נקייה".
- אימפקט/מאמץ: בינוני/נמוך.

---

## Markdown ותצוגה

18) קטעי Markdown מתקפלים (Collapsible)
- למה: שליטה ויזואלית במסמכים ארוכים.
- מה מוסיפים: כפתור collapse לכותרות H2/H3 (JS קליל מעל ה‑DOM).
- אימפקט/מאמץ: בינוני/נמוך.

19) תמיכה ב‑Callouts/Admonitions קלים
- למה: הדגשת הערות/טיפים/אזהרות בקריאה.
- מה מוסיפים: הרחבת markdown‑it ל‑admonitions (רק CSS/HTML בטוחים).
- אימפקט/מאמץ: בינוני/נמוך.

---

## שיתוף וחשיפה

20) מטא‑דאטה עשיר לשיתופים (OpenGraph/Twitter)
- למה: תצוגה מקדימה עשירה בקישורים ציבוריים.
- מה מוסיפים: `<meta property="og:*">` דינמי עם שם קובץ, שפה, קטע ראשון כתיאור ותמונת Preview מינימלית.
- אימפקט/מאמץ: גבוה/בינוני.

21) QR לקישורים ציבוריים
- למה: שיתוף מהיר מסלולרי/מסכים משניים.
- מה מוסיפים: כפתור “QR” שמייצר קוד ומאפשר הורדה.
- אימפקט/מאמץ: בינוני/נמוך.

22) ספירת צפיות בסיסית לקישורים ציבוריים
- למה: מדד שימוש/שיתוף.
- מה מוסיפים: מונה צפיות על share‑id (ללא מידע אישי), הצגה בפרטי הקישור.
- אימפקט/מאמץ: בינוני/נמוך‑בינוני.

---

## ניהול תוכן וארגון

23) ניהול תגיות מתקדם (מיזוג/שנוי שם/מחיקה גורפת)
- למה: סדר וניקיון לאורך זמן.
- מה מוסיפים: מסך לניהול תגיות פר‑משתמש, פעולות על קבוצות.
- אימפקט/מאמץ: גבוה/בינוני.

24) זיהוי כפילויות/דמיון בהעלאה
- למה: מניעת כפילויות וייעול חיפוש.
- מה מוסיפים: Hash תוכן + סימון “דומה לקיים” (שורת השוואה מהירה), אפשרות קישור במקום שכפול.
- אימפקט/מאמץ: בינוני/בינוני.

25) השוואה בין שני קבצים שונים (לא רק בין גרסאות)
- למה: חקר הבדלים בין קטעים קרובים.
- מה מוסיפים: בחירה מרובה בשני קבצים ופתיחת Diff side‑by‑side.
- אימפקט/מאמץ: בינוני/בינוני.

---

## אמינות ותצפיות

26) Sentry/אירועי שגיאות (לקוח+שרת) עם השחרת נתונים
- למה: איתור תקלות מהיר.
- מה מוסיפים: SDK בצד לקוח ושרת, מסיכות לשדות רגישים, דגימה נמוכה.
- אימפקט/מאמץ: גבוה/בינוני.

27) Request‑Id מקצה לקצה
- למה: קורלציה בין לקוח לשרת.
- מה מוסיפים: יצירת `X‑Request‑Id` בלקוח לכל בקשת fetch, העברה והחזרה מהשרת ללוגים מרוכזים.
- אימפקט/מאמץ: בינוני/נמוך.

28) דף בריאות מורחב לאדמין
- למה: תמונת מצב מלאה של תלויות.
- מה מוסיפים: בדיקות Mongo/Redis/Drive/Telegram, זמני round‑trip ומצב מטמון.
- אימפקט/מאמץ: בינוני/נמוך‑בינוני.

---

## מובייל / Mini‑App

29) Pull‑to‑refresh וניווט מחוות בסיסי
- למה: התנהגות טבעית במובייל.
- מה מוסיפים: האזנה ל‑`touch` לגלילת יתר וטריגר רענון; התאמות back‑button.
- אימפקט/מאמץ: בינוני/נמוך‑בינוני.

---

## סדר ביצוע קצר (הצעה)
- אבטחה וחיסון ממשק: (1,2,3,6,5)
- ביצועים/נראות: (7,8,9,10)
- UX מהיר: (12,14,15,17)
- ארגון/תוכן: (23,24,25)
- תצפיות/אמינות: (26,27,28)
- מובייל: (29)

> כל סעיף כאן עומד בפני עצמו; ההמלצה היא להתחיל מחיזוק אבטחה/נראות (ROI מיידי), ואז לשיפורי UX קטנים שמורגשים מייד.