

<!DOCTYPE html>
<html class="writer-html5" lang="he" data-content_root="../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>utils &mdash; ×ª×™×¢×•×“ Code Keeper Bot 1.0.0</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=2d7a82d5" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=0062297a"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/translations.js?v=714bf7a6"></script>
      <script src="https://unpkg.com/mermaid@10.2.0/dist/mermaid.min.js"></script>
      <script>mermaid.initialize({startOnLoad:true});</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="××™× ×“×§×¡" href="../genindex.html" />
    <link rel="search" title="×—×™×¤×•×©" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Code Keeper Bot
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">×œ××¤×ª×—×™× ×•×œ×¡×•×›× ×™ AI:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quickstart-ai.html">×”×ª×—×œ×” ××”×™×¨×” - ×¡×•×›× ×™ AI</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../quickstart-ai.html#id1">××˜×¨×”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart-ai.html#id2">××” ××¡×•×¨</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart-ai.html#id3">××” ××•×ª×¨ ×•××•××œ×¥</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart-ai.html#id4">×¤×•×¨××˜×™ ×¦×™×˜×•×˜ ×§×•×“</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart-ai.html#tmp">××—×™×§×” ×‘×˜×•×—×” (×¨×§ ×‘-/tmp)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart-ai.html#pr">×§×•××™×˜×™× ×•-PR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart-ai.html#id5">×§×™×©×•×¨×™× ××”×™×¨×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart-ai.html#cheatsheet-github-cli-gh">Cheatsheet â€“ GitHub CLI (gh)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">×”×ª×—×œ×” ××”×™×¨×” - ××¤×ª×—×™×</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#id2">××˜×¨×”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#id3">×©×œ×‘ 1: ×”×ª×§× ×”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#env">×©×œ×‘ 2: ×”×’×“×¨×ª .env</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#id4">×©×œ×‘ 3: ×”×¨×¦×”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#id5">××” ×”×œ××”?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart-contrib.html">Quickstart ×œ×ª×¨×•××”</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../quickstart-contrib.html#id1">××˜×¨×”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart-contrib.html#id2">×¦×¢×“×™ ×”×›× ×”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart-contrib.html#id3">×¡×‘×™×‘×ª ×¤×™×ª×•×—</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart-contrib.html#id4">×”×¨×¦×ª ×˜×¡×˜×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart-contrib.html#stubs">×¢×œ ×”â€‘Stubs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart-contrib.html#id5">×§×™×©×•×¨×™×</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ai-guidelines.html">×”× ×—×™×•×ª ××œ××•×ª ×œ×¡×•×›× ×™ AI</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ai-guidelines.html#id1">××’×‘×œ×•×ª ×§×¨×™×˜×™×•×ª</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ai-guidelines.html#id2">×”×¨×¦×ª ×¤×§×•×“×•×ª</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ai-guidelines.html#id3">×›×œ×™ ×§×‘×¦×™× ×××•×©×¨×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ai-guidelines.html#id4">×¢×§×¨×•× ×•×ª ×¢×¨×™×›×ª ×§×•×“</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ai-guidelines.html#pull-requests">×§×•××™×˜×™× ×•-Pull Requests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ai-guidelines.html#id5">×¢×‘×•×“×” ×¢× ×˜×¡×˜×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ai-guidelines.html#id6">×§×™×©×•×¨×™× ××”×™×¨×™×</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../agents/rate-limiting.html">ğŸš¦ ××¢×¨×›×ª Rate Limiting ×œ×¡×•×›× ×™ AI ×•×œ×•×•×‘</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../agents/rate-limiting.html#shadow-mode">××¡×˜×¨×˜×’×™×” â€“ Shadow Mode ×ª×—×™×œ×”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../agents/rate-limiting.html#id1">××©×ª× ×™ ×¡×‘×™×‘×” ×•×§×•× ×¤×™×’</a></li>
<li class="toctree-l2"><a class="reference internal" href="../agents/rate-limiting.html#id2">××™× ×˜×’×¨×¦×™×” â€“ ×‘×•×˜ ×˜×œ×’×¨×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../agents/rate-limiting.html#flask-webapp">××™× ×˜×’×¨×¦×™×” â€“ Flask/WebApp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../agents/rate-limiting.html#id3">×”×—×¨×’×•×ª ×—×©×•×‘×•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../agents/rate-limiting.html#prometheus">× ×™×˜×•×¨ ×•××“×“×™× (Prometheus)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../agents/rate-limiting.html#id4">××‘×˜×—×” ×•×”×’× ×•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../agents/rate-limiting.html#pydantic-settings">×§×•× ×¤×™×’×•×¨×¦×™×” (Pydantic Settings)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../agents/rate-limiting.html#id5">×ª×§×œ×•×ª × ×¤×•×¦×•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../agents/rate-limiting.html#id6">×§×™×©×•×¨×™×</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../doc-authoring.html">Doc Authoring Guide (Sphinx/RTD)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../doc-authoring.html#id1">××˜×¨×•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../doc-authoring.html#id2">××“×™× ×™×•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../doc-authoring.html#id3">×˜×™×¤×™× ××”×™×¨×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../doc-authoring.html#id4">×§×™×©×•×¨×™×</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../style-glossary.html">Style &amp; Naming Glossary</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../style-glossary.html#id1">××˜×¨×•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../style-glossary.html#id2">××™×¤×•×™ ××•× ×—×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../style-glossary.html#id3">×›×œ×œ×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../style-glossary.html#id4">×¢×•×’× ×™ ×ª×™×¢×•×“</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../versioning-stable-anchors.html">Versioning &amp; Stable Anchors</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../versioning-stable-anchors.html#id1">××“×™× ×™×•×ª ×¢×•×’× ×™× ×™×¦×™×‘×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../versioning-stable-anchors.html#whats-new">Whatâ€™s New</a></li>
<li class="toctree-l2"><a class="reference internal" href="../versioning-stable-anchors.html#anchors">×“×•×’××ª Anchors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../versioning-stable-anchors.html#id2">×§×™×©×•×¨×™×</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../whats-new.html">Whatâ€™s New</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../whats-new.html#id1">2025-10-15</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../architecture.html">××¨×›×™×˜×§×˜×•×¨×”</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../architecture.html#id2">×¡×§×™×¨×” ×›×œ×œ×™×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../architecture.html#id3">×ª×¨×©×™× ×¨×›×™×‘×™× (×ª××¦×™×ª×™)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../architecture.html#id4">××‘× ×” ×ª×™×§×™×•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../architecture.html#id5">×–×¨×™××•×ª ××¨×›×–×™×•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../architecture.html#id6">×§×™×©×•×¨×™×</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">××“×¨×™×š ×ª×¨×•××”</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../contributing.html#id2">××˜×¨×”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing.html#id3">×›×œ×œ×™× ×›×œ×œ×™×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing.html#workflow">Workflow ×‘×¡×™×¡×™</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing.html#pre-commit">Pre-commit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing.html#conventional-commits">Conventional Commits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing.html#id4">×“×•×’×××•×ª ×©×™××•×©×™×•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing.html#id5">×§×™×©×•×¨×™×</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../branch-protection-and-pr-rules.html">Branch Protection &amp; PR Rules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../branch-protection-and-pr-rules.html#id1">××˜×¨×”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../branch-protection-and-pr-rules.html#id2">×›×œ×œ×™ ×¢× ×¤×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../branch-protection-and-pr-rules.html#pr">×—×•×§×™ PR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../branch-protection-and-pr-rules.html#ci-required-checks">CI â€“ Required Checks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../branch-protection-and-pr-rules.html#id3">×§×™×©×•×¨×™×</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">××“×¨×™×›×™× ×‘×¡×™×¡×™×™×:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">×”×ª×§× ×” ×•×”×’×“×¨×”</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#id2">×“×¨×™×©×•×ª ××¢×¨×›×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#id3">×”×ª×§× ×” ××”×™×¨×”</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#id4">1. ×©×›×¤×œ ××ª ×”×¨×™×¤×•×–×™×˜×•×¨×™</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#id5">2. ×”×ª×§×Ÿ ×ª×œ×•×™×•×ª</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#id6">3. ×”×’×“×¨ ××©×ª× ×™ ×¡×‘×™×‘×”</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#id7">4. ×”×¤×¢×œ ××ª ×”×‘×•×˜</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#docker">×”×ª×§× ×” ×¢× Docker</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#image">1. ×‘× ×” ××ª ×”-Image</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#docker-compose">2. ×”×¤×¢×œ ×¢× Docker Compose</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#mongodb">×”×’×“×¨×ª MongoDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#telegram-bot">×”×’×“×¨×ª Telegram Bot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#id8">×”×’×“×¨×•×ª ××ª×§×“××•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#id9">×‘×“×™×§×ª ×”×ª×§× ×”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#id10">×¤×ª×¨×•×Ÿ ×‘×¢×™×•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#id11">×ª××™×›×”</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Rate Limiting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../configuration.html#environment-variables">Environment variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration.html#databases-and-cache-pooling-timeouts">Databases and Cache (Pooling/Timeouts)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration.html#http-clients">HTTP Clients</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration.html#http-sync-sync-http">×©×™××•×© ×‘â€‘http_sync (Sync HTTP)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration.html#flask">Flask</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration.html#telegram-bot">Telegram Bot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration.html#metrics">Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration.html#security">Security</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration.html#id1">Databases and Cache (Pooling/Timeouts)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration.html#id2">HTTP Clients</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration.html#id3">×©×™××•×© ×‘-http_sync (Sync HTTP)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html#config-via-pydantic-settings">Config via Pydantic Settings</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../configuration.html#id4">×”×™×¨×¨×›×™×™×ª ×˜×¢×™× ×”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration.html#id5">×•×œ×™×“×¦×™×•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration.html#env-example">.env.example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration.html#id6">×©×™××•×© ×œ×¡×•×›× ×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration.html#id7">×¤×¨××˜×¨×™ ×§×•× ×¤×™×’×•×¨×¦×™×” ××¨×›×–×™×™× (×—×“×©×™×)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration.html#id8">××™×—×•×“ ×ª×™×¢×•×“ ×§×•× ×¤×™×’×•×¨×¦×™×”</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../environment-variables.html">××©×ª× ×™ ×¡×‘×™×‘×” - ×¨×¤×¨× ×¡</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../environment-variables.html#id2">×˜×‘×œ×” ××¨×›×–×™×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environment-variables.html#id3">×“×•×’×××•×ª ×§×•× ×¤×™×’×•×¨×¦×™×”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environment-variables.html#id4">×§×™×©×•×¨×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../environment-variables.html#scopes-github">×˜×‘×œ×ª Scopes ×œ×¤×™×¦â€™×¨×™× ×©×œ GitHub</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../performance-scaling.html">×‘×™×¦×•×¢×™× ×•×”×¨×—×‘×” (Performance &amp; Scaling)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../performance-scaling.html#pagination">×¢×™××•×“ (Pagination)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../performance-scaling.html#projection">Projection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../performance-scaling.html#id1">×“×’×©×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../performance-scaling.html#connection-pooling-timeouts">×›×•×•× ×•×Ÿ Connection Pooling ×•-Timeouts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../performance-scaling.html#env">×‘×“×™×§×•×ª ××”×™×¨×•×ª ××—×¨×™ ×©×™× ×•×™ ENV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../performance-scaling.html#id2">×”× ×—×™×•×ª ×œ×¤×™ ×¡×‘×™×‘×”</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../large-files-runbook.html">×˜×™×¤×•×œ ×‘×§×‘×¦×™× ×’×“×•×œ×™× (Large Files)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../large-files-runbook.html#id1">××’×‘×œ×•×ª ×•×¤×•×œ×‘×§×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../large-files-runbook.html#id2">×”× ×—×™×•×ª ×”×¤×¢×œ×”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../large-files-runbook.html#id3">× ×™×˜×•×¨</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/main.html">main module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/config.html">config module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/bot_handlers.html">bot_handlers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/conversation_handlers.html">conversation_handlers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/database.html">database package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/database.html#submodules">Submodules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/database.bookmark.html">database.bookmark module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/database.bookmarks_manager.html">database.bookmarks_manager module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/database.manager.html">database.manager module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/database.models.html">database.models module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/database.repository.html">database.repository module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/services.html">services package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/services.html#submodules">Submodules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/services.backoff_state.html">services.backoff_state module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/services.backup_service.html">services.backup_service module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/services.code_service.html">services.code_service module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/services.github_service.html">services.github_service module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/services.google_drive_service.html">services.google_drive_service module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/services.investigation_service.html">services.investigation_service module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/services.webserver.html">services.webserver module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/handlers.html">handlers package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/handlers.html#subpackages">Subpackages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/handlers.github.html">handlers.github package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/handlers.html#submodules">Submodules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/handlers.file_view.html">handlers.file_view module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/handlers.pagination.html">handlers.pagination module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/handlers.save_flow.html">handlers.save_flow module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/handlers.states.html">handlers.states module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/utils.html">utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/utils.html#utils.CodeErrorLogger"><code class="docutils literal notranslate"><span class="pre">CodeErrorLogger</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.CodeErrorLogger.__init__"><code class="docutils literal notranslate"><span class="pre">CodeErrorLogger.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.CodeErrorLogger.log_code_processing_error"><code class="docutils literal notranslate"><span class="pre">CodeErrorLogger.log_code_processing_error()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.CodeErrorLogger.log_code_activity"><code class="docutils literal notranslate"><span class="pre">CodeErrorLogger.log_code_activity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.CodeErrorLogger.log_validation_failure"><code class="docutils literal notranslate"><span class="pre">CodeErrorLogger.log_validation_failure()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.CodeErrorLogger.log_sanitization_success"><code class="docutils literal notranslate"><span class="pre">CodeErrorLogger.log_sanitization_success()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/utils.html#utils.TimeUtils"><code class="docutils literal notranslate"><span class="pre">TimeUtils</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.TimeUtils.format_relative_time"><code class="docutils literal notranslate"><span class="pre">TimeUtils.format_relative_time()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.TimeUtils.parse_date_string"><code class="docutils literal notranslate"><span class="pre">TimeUtils.parse_date_string()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.TimeUtils.get_time_ranges"><code class="docutils literal notranslate"><span class="pre">TimeUtils.get_time_ranges()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/utils.html#utils.TextUtils"><code class="docutils literal notranslate"><span class="pre">TextUtils</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.TextUtils.truncate_text"><code class="docutils literal notranslate"><span class="pre">TextUtils.truncate_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.TextUtils.escape_markdown"><code class="docutils literal notranslate"><span class="pre">TextUtils.escape_markdown()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.TextUtils.clean_filename"><code class="docutils literal notranslate"><span class="pre">TextUtils.clean_filename()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.TextUtils.extract_hashtags"><code class="docutils literal notranslate"><span class="pre">TextUtils.extract_hashtags()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.TextUtils.highlight_text"><code class="docutils literal notranslate"><span class="pre">TextUtils.highlight_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.TextUtils.format_file_size"><code class="docutils literal notranslate"><span class="pre">TextUtils.format_file_size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.TextUtils.pluralize_hebrew"><code class="docutils literal notranslate"><span class="pre">TextUtils.pluralize_hebrew()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/utils.html#utils.SecurityUtils"><code class="docutils literal notranslate"><span class="pre">SecurityUtils</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.SecurityUtils.generate_secure_token"><code class="docutils literal notranslate"><span class="pre">SecurityUtils.generate_secure_token()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.SecurityUtils.hash_content"><code class="docutils literal notranslate"><span class="pre">SecurityUtils.hash_content()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.SecurityUtils.validate_user_input"><code class="docutils literal notranslate"><span class="pre">SecurityUtils.validate_user_input()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.SecurityUtils.sanitize_code"><code class="docutils literal notranslate"><span class="pre">SecurityUtils.sanitize_code()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/utils.html#utils.TelegramUtils"><code class="docutils literal notranslate"><span class="pre">TelegramUtils</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.TelegramUtils.send_typing_action"><code class="docutils literal notranslate"><span class="pre">TelegramUtils.send_typing_action()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.TelegramUtils.send_document_action"><code class="docutils literal notranslate"><span class="pre">TelegramUtils.send_document_action()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.TelegramUtils.safe_answer"><code class="docutils literal notranslate"><span class="pre">TelegramUtils.safe_answer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.TelegramUtils.get_user_mention"><code class="docutils literal notranslate"><span class="pre">TelegramUtils.get_user_mention()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.TelegramUtils.split_long_message"><code class="docutils literal notranslate"><span class="pre">TelegramUtils.split_long_message()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.TelegramUtils.safe_edit_message_text"><code class="docutils literal notranslate"><span class="pre">TelegramUtils.safe_edit_message_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.TelegramUtils.safe_edit_message_reply_markup"><code class="docutils literal notranslate"><span class="pre">TelegramUtils.safe_edit_message_reply_markup()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.TelegramUtils.extract_message_text_preserve_markdown"><code class="docutils literal notranslate"><span class="pre">TelegramUtils.extract_message_text_preserve_markdown()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/utils.html#utils.CallbackQueryGuard"><code class="docutils literal notranslate"><span class="pre">CallbackQueryGuard</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.CallbackQueryGuard.DEFAULT_WINDOW_SECONDS"><code class="docutils literal notranslate"><span class="pre">CallbackQueryGuard.DEFAULT_WINDOW_SECONDS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.CallbackQueryGuard.should_block"><code class="docutils literal notranslate"><span class="pre">CallbackQueryGuard.should_block()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.CallbackQueryGuard.should_block_async"><code class="docutils literal notranslate"><span class="pre">CallbackQueryGuard.should_block_async()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/utils.html#utils.AsyncUtils"><code class="docutils literal notranslate"><span class="pre">AsyncUtils</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.AsyncUtils.run_with_timeout"><code class="docutils literal notranslate"><span class="pre">AsyncUtils.run_with_timeout()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.AsyncUtils.batch_process"><code class="docutils literal notranslate"><span class="pre">AsyncUtils.batch_process()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/utils.html#utils.PerformanceUtils"><code class="docutils literal notranslate"><span class="pre">PerformanceUtils</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.PerformanceUtils.timing_decorator"><code class="docutils literal notranslate"><span class="pre">PerformanceUtils.timing_decorator()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.PerformanceUtils.measure_time"><code class="docutils literal notranslate"><span class="pre">PerformanceUtils.measure_time()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/utils.html#utils.ValidationUtils"><code class="docutils literal notranslate"><span class="pre">ValidationUtils</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.ValidationUtils.is_valid_filename"><code class="docutils literal notranslate"><span class="pre">ValidationUtils.is_valid_filename()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.ValidationUtils.is_safe_code"><code class="docutils literal notranslate"><span class="pre">ValidationUtils.is_safe_code()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/utils.html#utils.FileUtils"><code class="docutils literal notranslate"><span class="pre">FileUtils</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.FileUtils.download_file"><code class="docutils literal notranslate"><span class="pre">FileUtils.download_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.FileUtils.get_file_extension"><code class="docutils literal notranslate"><span class="pre">FileUtils.get_file_extension()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.FileUtils.get_mime_type"><code class="docutils literal notranslate"><span class="pre">FileUtils.get_mime_type()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.FileUtils.create_temp_file"><code class="docutils literal notranslate"><span class="pre">FileUtils.create_temp_file()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/utils.html#utils.ConfigUtils"><code class="docutils literal notranslate"><span class="pre">ConfigUtils</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.ConfigUtils.load_json_config"><code class="docutils literal notranslate"><span class="pre">ConfigUtils.load_json_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.ConfigUtils.save_json_config"><code class="docutils literal notranslate"><span class="pre">ConfigUtils.save_json_config()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/utils.html#utils.CacheUtils"><code class="docutils literal notranslate"><span class="pre">CacheUtils</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.CacheUtils.set"><code class="docutils literal notranslate"><span class="pre">CacheUtils.set()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.CacheUtils.get"><code class="docutils literal notranslate"><span class="pre">CacheUtils.get()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.CacheUtils.delete"><code class="docutils literal notranslate"><span class="pre">CacheUtils.delete()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.CacheUtils.clear"><code class="docutils literal notranslate"><span class="pre">CacheUtils.clear()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/utils.html#utils.get_memory_usage"><code class="docutils literal notranslate"><span class="pre">get_memory_usage()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/utils.html#utils.setup_logging"><code class="docutils literal notranslate"><span class="pre">setup_logging()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/utils.html#utils.generate_summary_stats"><code class="docutils literal notranslate"><span class="pre">generate_summary_stats()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/utils.html#utils.detect_language_from_filename"><code class="docutils literal notranslate"><span class="pre">detect_language_from_filename()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/utils.html#utils.get_language_emoji"><code class="docutils literal notranslate"><span class="pre">get_language_emoji()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/utils.html#utils.SensitiveDataFilter"><code class="docutils literal notranslate"><span class="pre">SensitiveDataFilter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.SensitiveDataFilter.filter"><code class="docutils literal notranslate"><span class="pre">SensitiveDataFilter.filter()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/utils.html#utils.install_sensitive_filter"><code class="docutils literal notranslate"><span class="pre">install_sensitive_filter()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/utils.html#utils.normalize_code"><code class="docutils literal notranslate"><span class="pre">normalize_code()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/modules.html">workspace</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/activity_reporter.html">activity_reporter module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/activity_reporter.html#activity_reporter.get_mongo_client"><code class="docutils literal notranslate"><span class="pre">get_mongo_client()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/activity_reporter.html#activity_reporter.close_mongo_client"><code class="docutils literal notranslate"><span class="pre">close_mongo_client()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/activity_reporter.html#activity_reporter.SimpleActivityReporter"><code class="docutils literal notranslate"><span class="pre">SimpleActivityReporter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/activity_reporter.html#activity_reporter.create_reporter"><code class="docutils literal notranslate"><span class="pre">create_reporter()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/alert_forwarder.html">alert_forwarder module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/alert_forwarder.html#alert_forwarder.emit_event"><code class="docutils literal notranslate"><span class="pre">emit_event()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/alert_forwarder.html#alert_forwarder.forward_alerts"><code class="docutils literal notranslate"><span class="pre">forward_alerts()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/alert_manager.html">alert_manager module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/alert_manager.html#alert_manager.emit_event"><code class="docutils literal notranslate"><span class="pre">emit_event()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/alert_manager.html#alert_manager.reset_state_for_tests"><code class="docutils literal notranslate"><span class="pre">reset_state_for_tests()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/alert_manager.html#alert_manager.note_request"><code class="docutils literal notranslate"><span class="pre">note_request()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/alert_manager.html#alert_manager.get_current_error_rate_percent"><code class="docutils literal notranslate"><span class="pre">get_current_error_rate_percent()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/alert_manager.html#alert_manager.get_current_avg_latency_seconds"><code class="docutils literal notranslate"><span class="pre">get_current_avg_latency_seconds()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/alert_manager.html#alert_manager.bump_threshold"><code class="docutils literal notranslate"><span class="pre">bump_threshold()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/alert_manager.html#alert_manager.get_thresholds_snapshot"><code class="docutils literal notranslate"><span class="pre">get_thresholds_snapshot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/alert_manager.html#alert_manager.check_and_emit_alerts"><code class="docutils literal notranslate"><span class="pre">check_and_emit_alerts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/alert_manager.html#alert_manager.forward_critical_alert"><code class="docutils literal notranslate"><span class="pre">forward_critical_alert()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/alert_manager.html#alert_manager.get_dispatch_log"><code class="docutils literal notranslate"><span class="pre">get_dispatch_log()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/autocomplete_manager.html">autocomplete_manager module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/backup_menu_handler.html">backup_menu_handler module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/batch_commands.html">batch_commands module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/batch_processor.html">batch_processor module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/bot_handlers.html">bot_handlers module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/bot_rate_limiter.html">bot_rate_limiter module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/cache_commands.html">cache_commands module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/cache_commands.html#cache_commands.cache_stats_command"><code class="docutils literal notranslate"><span class="pre">cache_stats_command()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/cache_commands.html#cache_commands.clear_cache_command"><code class="docutils literal notranslate"><span class="pre">clear_cache_command()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/cache_commands.html#cache_commands.setup_cache_handlers"><code class="docutils literal notranslate"><span class="pre">setup_cache_handlers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/cache_commands.html#cache_commands.cache_warm_command"><code class="docutils literal notranslate"><span class="pre">cache_warm_command()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/cache_manager.html">cache_manager module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/cache_manager.html#cache_manager.DynamicTTL"><code class="docutils literal notranslate"><span class="pre">DynamicTTL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/cache_manager.html#cache_manager.ActivityBasedTTL"><code class="docutils literal notranslate"><span class="pre">ActivityBasedTTL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/cache_manager.html#cache_manager.build_cache_key"><code class="docutils literal notranslate"><span class="pre">build_cache_key()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/cache_manager.html#cache_manager.CacheManager"><code class="docutils literal notranslate"><span class="pre">CacheManager</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/cache_manager.html#cache_manager.dynamic_cache"><code class="docutils literal notranslate"><span class="pre">dynamic_cache()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/cache_manager.html#cache_manager.cached"><code class="docutils literal notranslate"><span class="pre">cached()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/cache_manager.html#cache_manager.async_cached"><code class="docutils literal notranslate"><span class="pre">async_cached()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/chatops.html">chatops package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/chatops.html#submodules">Submodules</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/code_preview.html">code_preview module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/code_preview.html#code_preview.CodePreviewManager"><code class="docutils literal notranslate"><span class="pre">CodePreviewManager</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/code_processor.html">code_processor module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/config.html">config module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/conftest.html">conftest module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/conftest.html#conftest.pytest_addoption"><code class="docutils literal notranslate"><span class="pre">pytest_addoption()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/conftest.html#conftest.pytest_configure"><code class="docutils literal notranslate"><span class="pre">pytest_configure()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/conftest.html#conftest.pytest_collection_modifyitems"><code class="docutils literal notranslate"><span class="pre">pytest_collection_modifyitems()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/conftest.html#conftest.pytest_runtest_makereport"><code class="docutils literal notranslate"><span class="pre">pytest_runtest_makereport()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/conftest.html#conftest.pytest_sessionfinish"><code class="docutils literal notranslate"><span class="pre">pytest_sessionfinish()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/conversation_handlers.html">conversation_handlers module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/database.html">database package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/database.html#submodules">Submodules</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/duplicate_detector.html">duplicate_detector module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/duplicate_detector.html#duplicate_detector.scan_duplicates"><code class="docutils literal notranslate"><span class="pre">scan_duplicates()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/file_manager.html">file_manager module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/file_manager.html#file_manager.BackupInfo"><code class="docutils literal notranslate"><span class="pre">BackupInfo</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/file_manager.html#file_manager.BackupManager"><code class="docutils literal notranslate"><span class="pre">BackupManager</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/fix_telegram_parse_error.html">fix_telegram_parse_error module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/fix_telegram_parse_error.html#fix_telegram_parse_error.clean_for_telegram"><code class="docutils literal notranslate"><span class="pre">clean_for_telegram()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/fix_telegram_parse_error.html#fix_telegram_parse_error.apply_fix"><code class="docutils literal notranslate"><span class="pre">apply_fix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/fix_telegram_parse_error.html#fix_telegram_parse_error.wrap_edit_message_calls"><code class="docutils literal notranslate"><span class="pre">wrap_edit_message_calls()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/github_menu_handler.html">github_menu_handler module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/github_upload_fix.html">github_upload_fix module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/github_upload_fix.html#github_upload_fix.github_upload_new_file"><code class="docutils literal notranslate"><span class="pre">github_upload_new_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/github_upload_fix.html#github_upload_fix.handle_document_fixed"><code class="docutils literal notranslate"><span class="pre">handle_document_fixed()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/github_upload_fix.html#github_upload_fix.upload_to_github_fixed"><code class="docutils literal notranslate"><span class="pre">upload_to_github_fixed()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/github_upload_fix.html#github_upload_fix.setup_minimal_commands"><code class="docutils literal notranslate"><span class="pre">setup_minimal_commands()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/github_upload_fix.html#github_upload_fix.stats_command_secured"><code class="docutils literal notranslate"><span class="pre">stats_command_secured()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/github_upload_fix.html#github_upload_fix.check_commands"><code class="docutils literal notranslate"><span class="pre">check_commands()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/handlers.html">handlers package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/handlers.html#subpackages">Subpackages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/handlers.html#submodules">Submodules</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/i18n.html">i18n package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/i18n.html#submodules">Submodules</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/integrations.html">integrations module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/integrations_github_monitor.html">integrations_github_monitor module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/integrations_github_monitor.html#integrations_github_monitor.fetch_rate_limit"><code class="docutils literal notranslate"><span class="pre">fetch_rate_limit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/integrations_github_monitor.html#integrations_github_monitor.summarize_rate_limit"><code class="docutils literal notranslate"><span class="pre">summarize_rate_limit()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/integrations_sentry.html">integrations_sentry module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/integrations_sentry.html#integrations_sentry.is_configured"><code class="docutils literal notranslate"><span class="pre">is_configured()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/integrations_sentry.html#integrations_sentry.get_recent_issues"><code class="docutils literal notranslate"><span class="pre">get_recent_issues()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/integrations_sentry.html#integrations_sentry.search_events"><code class="docutils literal notranslate"><span class="pre">search_events()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/integrations_sentry.html#integrations_sentry.get_issue_events"><code class="docutils literal notranslate"><span class="pre">get_issue_events()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/internal_alerts.html">internal_alerts module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/internal_alerts.html#internal_alerts.emit_event"><code class="docutils literal notranslate"><span class="pre">emit_event()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/internal_alerts.html#internal_alerts.emit_internal_alert"><code class="docutils literal notranslate"><span class="pre">emit_internal_alert()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/internal_alerts.html#internal_alerts.get_recent_alerts"><code class="docutils literal notranslate"><span class="pre">get_recent_alerts()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/large_files_handler.html">large_files_handler module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lazy_loader.html">lazy_loader module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/main.html">main module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/metrics.html">metrics module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/metrics.html#metrics.emit_event"><code class="docutils literal notranslate"><span class="pre">emit_event()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/metrics.html#metrics.generate_latest"><code class="docutils literal notranslate"><span class="pre">generate_latest()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/metrics.html#metrics.track_performance"><code class="docutils literal notranslate"><span class="pre">track_performance()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/metrics.html#metrics.metrics_endpoint_bytes"><code class="docutils literal notranslate"><span class="pre">metrics_endpoint_bytes()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/metrics.html#metrics.metrics_content_type"><code class="docutils literal notranslate"><span class="pre">metrics_content_type()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/metrics.html#metrics.note_active_user"><code class="docutils literal notranslate"><span class="pre">note_active_user()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/metrics.html#metrics.record_request_outcome"><code class="docutils literal notranslate"><span class="pre">record_request_outcome()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/metrics.html#metrics.record_http_request"><code class="docutils literal notranslate"><span class="pre">record_http_request()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/metrics.html#metrics.get_boot_monotonic"><code class="docutils literal notranslate"><span class="pre">get_boot_monotonic()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/metrics.html#metrics.mark_startup_complete"><code class="docutils literal notranslate"><span class="pre">mark_startup_complete()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/metrics.html#metrics.note_first_request_latency"><code class="docutils literal notranslate"><span class="pre">note_first_request_latency()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/metrics.html#metrics.record_dependency_init"><code class="docutils literal notranslate"><span class="pre">record_dependency_init()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/metrics.html#metrics.get_uptime_percentage"><code class="docutils literal notranslate"><span class="pre">get_uptime_percentage()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/metrics.html#metrics.set_adaptive_observability_gauges"><code class="docutils literal notranslate"><span class="pre">set_adaptive_observability_gauges()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/metrics.html#metrics.track_file_saved"><code class="docutils literal notranslate"><span class="pre">track_file_saved()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/metrics.html#metrics.track_search_performed"><code class="docutils literal notranslate"><span class="pre">track_search_performed()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/metrics.html#metrics.track_github_sync"><code class="docutils literal notranslate"><span class="pre">track_github_sync()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/monitoring.html">monitoring package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/monitoring.html#submodules">Submodules</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/observability.html">observability module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/observability_instrumentation.html">observability_instrumentation module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/observability_instrumentation.html#observability_instrumentation.traced"><code class="docutils literal notranslate"><span class="pre">traced()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/observability_otel.html">observability_otel module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/observability_otel.html#observability_otel.setup_telemetry"><code class="docutils literal notranslate"><span class="pre">setup_telemetry()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/predictive_engine.html">predictive_engine module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/predictive_engine.html#predictive_engine.emit_event"><code class="docutils literal notranslate"><span class="pre">emit_event()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/predictive_engine.html#predictive_engine.Trend"><code class="docutils literal notranslate"><span class="pre">Trend</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/predictive_engine.html#predictive_engine.note_observation"><code class="docutils literal notranslate"><span class="pre">note_observation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/predictive_engine.html#predictive_engine.evaluate_predictions"><code class="docutils literal notranslate"><span class="pre">evaluate_predictions()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/predictive_engine.html#predictive_engine.reset_state_for_tests"><code class="docutils literal notranslate"><span class="pre">reset_state_for_tests()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/predictive_engine.html#predictive_engine.maybe_recompute_and_preempt"><code class="docutils literal notranslate"><span class="pre">maybe_recompute_and_preempt()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/predictive_engine.html#predictive_engine.get_recent_predictions"><code class="docutils literal notranslate"><span class="pre">get_recent_predictions()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/predictive_engine.html#predictive_engine.get_trend_snapshot"><code class="docutils literal notranslate"><span class="pre">get_trend_snapshot()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/rate_limiter.html">rate_limiter module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/rate_limiter.html#rate_limiter.RateLimiter"><code class="docutils literal notranslate"><span class="pre">RateLimiter</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/refactor_handlers.html">refactor_handlers module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/refactoring_engine.html">refactoring_engine module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/refactoring_engine.html#refactoring_engine.RefactorType"><code class="docutils literal notranslate"><span class="pre">RefactorType</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/refactoring_engine.html#refactoring_engine.FunctionInfo"><code class="docutils literal notranslate"><span class="pre">FunctionInfo</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/refactoring_engine.html#refactoring_engine.ClassInfo"><code class="docutils literal notranslate"><span class="pre">ClassInfo</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/refactoring_engine.html#refactoring_engine.RefactorProposal"><code class="docutils literal notranslate"><span class="pre">RefactorProposal</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/refactoring_engine.html#refactoring_engine.RefactorResult"><code class="docutils literal notranslate"><span class="pre">RefactorResult</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/refactoring_engine.html#refactoring_engine.CodeAnalyzer"><code class="docutils literal notranslate"><span class="pre">CodeAnalyzer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/refactoring_engine.html#refactoring_engine.RefactoringEngine"><code class="docutils literal notranslate"><span class="pre">RefactoringEngine</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/remediation_manager.html">remediation_manager module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/remediation_manager.html#remediation_manager.handle_critical_incident"><code class="docutils literal notranslate"><span class="pre">handle_critical_incident()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/remediation_manager.html#remediation_manager.get_incidents"><code class="docutils literal notranslate"><span class="pre">get_incidents()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/repo_analyzer.html">repo_analyzer module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/repo_analyzer.html#repo_analyzer.emit_event"><code class="docutils literal notranslate"><span class="pre">emit_event()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/repo_analyzer.html#repo_analyzer.RepoAnalyzer"><code class="docutils literal notranslate"><span class="pre">RepoAnalyzer</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/search_engine.html">search_engine module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/secret_manager.html">secret_manager module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/secret_manager.html#secret_manager.encrypt_secret"><code class="docutils literal notranslate"><span class="pre">encrypt_secret()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/secret_manager.html#secret_manager.decrypt_secret"><code class="docutils literal notranslate"><span class="pre">decrypt_secret()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/services.html">services package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/services.html#submodules">Submodules</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/setup_bookmarks.html">setup_bookmarks module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/setup_bookmarks.html#setup_bookmarks.emit_event"><code class="docutils literal notranslate"><span class="pre">emit_event()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/setup_bookmarks.html#setup_bookmarks.check_mongodb_connection"><code class="docutils literal notranslate"><span class="pre">check_mongodb_connection()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/setup_bookmarks.html#setup_bookmarks.setup_bookmarks_collection"><code class="docutils literal notranslate"><span class="pre">setup_bookmarks_collection()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/setup_bookmarks.html#setup_bookmarks.verify_installation"><code class="docutils literal notranslate"><span class="pre">verify_installation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/setup_bookmarks.html#setup_bookmarks.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/terminal_commands.html">terminal_commands module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/terminal_commands.html#terminal_commands.emit_event"><code class="docutils literal notranslate"><span class="pre">emit_event()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/terminal_commands.html#terminal_commands.run_in_sandbox"><code class="docutils literal notranslate"><span class="pre">run_in_sandbox()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/terminal_commands.html#terminal_commands.terminal_enter"><code class="docutils literal notranslate"><span class="pre">terminal_enter()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/terminal_commands.html#terminal_commands.terminal_exit"><code class="docutils literal notranslate"><span class="pre">terminal_exit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/terminal_commands.html#terminal_commands.terminal_run_command"><code class="docutils literal notranslate"><span class="pre">terminal_run_command()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/terminal_commands.html#terminal_commands.terminal_command"><code class="docutils literal notranslate"><span class="pre">terminal_command()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/terminal_commands.html#terminal_commands.setup_terminal_handlers"><code class="docutils literal notranslate"><span class="pre">setup_terminal_handlers()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/test_basic.html">test_basic module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/test_basic.html#test_basic.test_python_version"><code class="docutils literal notranslate"><span class="pre">test_python_version()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/test_basic.html#test_basic.test_import_main"><code class="docutils literal notranslate"><span class="pre">test_import_main()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/test_basic.html#test_basic.test_environment"><code class="docutils literal notranslate"><span class="pre">test_environment()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/test_basic.html#test_basic.test_basic_calculation"><code class="docutils literal notranslate"><span class="pre">test_basic_calculation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/test_basic.html#test_basic.TestRequirements"><code class="docutils literal notranslate"><span class="pre">TestRequirements</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/test_bookmarks.html">test_bookmarks module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/user_stats.html">user_stats module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/utils.html">utils module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.CodeErrorLogger"><code class="docutils literal notranslate"><span class="pre">CodeErrorLogger</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.TimeUtils"><code class="docutils literal notranslate"><span class="pre">TimeUtils</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.TextUtils"><code class="docutils literal notranslate"><span class="pre">TextUtils</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.SecurityUtils"><code class="docutils literal notranslate"><span class="pre">SecurityUtils</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.TelegramUtils"><code class="docutils literal notranslate"><span class="pre">TelegramUtils</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.CallbackQueryGuard"><code class="docutils literal notranslate"><span class="pre">CallbackQueryGuard</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.AsyncUtils"><code class="docutils literal notranslate"><span class="pre">AsyncUtils</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.PerformanceUtils"><code class="docutils literal notranslate"><span class="pre">PerformanceUtils</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.ValidationUtils"><code class="docutils literal notranslate"><span class="pre">ValidationUtils</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.FileUtils"><code class="docutils literal notranslate"><span class="pre">FileUtils</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.ConfigUtils"><code class="docutils literal notranslate"><span class="pre">ConfigUtils</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.CacheUtils"><code class="docutils literal notranslate"><span class="pre">CacheUtils</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.get_memory_usage"><code class="docutils literal notranslate"><span class="pre">get_memory_usage()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.setup_logging"><code class="docutils literal notranslate"><span class="pre">setup_logging()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.generate_summary_stats"><code class="docutils literal notranslate"><span class="pre">generate_summary_stats()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.detect_language_from_filename"><code class="docutils literal notranslate"><span class="pre">detect_language_from_filename()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.get_language_emoji"><code class="docutils literal notranslate"><span class="pre">get_language_emoji()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.SensitiveDataFilter"><code class="docutils literal notranslate"><span class="pre">SensitiveDataFilter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.install_sensitive_filter"><code class="docutils literal notranslate"><span class="pre">install_sensitive_filter()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html#utils.normalize_code"><code class="docutils literal notranslate"><span class="pre">normalize_code()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/webapp.html">webapp package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/webapp.html#submodules">Submodules</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../modules/index.html">××•×“×•×œ×™× ×¨××©×™×™×</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../modules/index.html#file-management">File Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/index.html#github-integration">GitHub Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/index.html#backup-system">Backup System</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/index.html#code-processing">Code Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/index.html#search-engine">Search Engine</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/index.html#repository-analysis">Repository Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/index.html#batch-processing">Batch Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/index.html#large-files-handling">Large Files Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/index.html#cache-management">Cache Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/index.html#user-statistics">User Statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/index.html#activity-reporting">Activity Reporting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/index.html#utilities">Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/index.html#lazy-loading">Lazy Loading</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/index.html#integrations">Integrations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/index.html#terminal-commands">Terminal Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/index.html#autocomplete-manager">Autocomplete Manager</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../handlers/index.html">Handlers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../handlers/index.html#show-command">Show Command</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../handlers/show.html">Show Command</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../handlers/show.html#show">××¤×¨×˜ ×¤×§×•×“×ª <cite>/show</cite></a></li>
<li class="toctree-l4"><a class="reference internal" href="../handlers/show.html#html">×“×•×’××ª ×ª×’×•×‘×ª HTML</a></li>
<li class="toctree-l4"><a class="reference internal" href="../handlers/show.html#id1">×”×¢×¨×•×ª ×™×™×©×•×</a></li>
<li class="toctree-l4"><a class="reference internal" href="../handlers/show.html#id2">×§×™×©×•×¨×™×</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../handlers/index.html#drive-menu">Drive Menu</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../handlers/drive_menu.html">Drive Menu V2</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../handlers/drive_menu.html#id1">×¡×§×™×¨×”</a></li>
<li class="toctree-l4"><a class="reference internal" href="../handlers/drive_menu.html#id2">×“×’×œ ×¤×™×¦â€™×¨</a></li>
<li class="toctree-l4"><a class="reference internal" href="../handlers/drive_menu.html#id3">×–×¨×™××•×ª ×¢×™×§×¨×™×•×ª</a></li>
<li class="toctree-l4"><a class="reference internal" href="../handlers/drive_menu.html#device-flow">×”×ª×—×‘×¨×•×ª (Device Flow)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../handlers/drive_menu.html#id4">×˜×™×¤×•×œ ×©×’×™××•×ª</a></li>
<li class="toctree-l4"><a class="reference internal" href="../handlers/drive_menu.html#id5">× ×™×˜×•×¨</a></li>
<li class="toctree-l4"><a class="reference internal" href="../handlers/drive_menu.html#api-autodoc">API (autodoc)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../handlers/index.html#file-view-handler">File View Handler</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../handlers/index.html#file-view-handler-module">File View Handler Module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../handlers/index.html#pagination-handler">Pagination Handler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../handlers/index.html#save-flow-handler">Save Flow Handler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../handlers/index.html#states-handler">States Handler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../handlers/index.html#github-handlers">GitHub Handlers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../services/index.html">Services</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../services/index.html#code-service">Code Service</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../services/index.html#code-service-module">Code Service Module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../services/index.html#github-service">GitHub Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../services/index.html#backup-service">Backup Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../services/index.html#google-drive-service">Google Drive Service</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../services/google_drive_service.html">Google Drive Service</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../services/google_drive_service.html#id1">×¡×§×™×¨×”</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services/google_drive_service.html#oauth">×”×¢×¨×•×ª OAuth</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services/google_drive_service.html#id2">××‘× ×™ ×§×‘×¦×™×</a></li>
<li class="toctree-l4"><a class="reference internal" href="../services/google_drive_service.html#api-autodoc">API (autodoc)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../database/index.html">Database</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../database/index.html#database-manager">Database Manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/index.html#models">Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../database/index.html#codesnippet-model">CodeSnippet Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../database/index.html#databasemanager-class">DatabaseManager Class</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../database/index.html#database-operations">Database Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../database/index.html#save-operations">Save Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../database/index.html#search-operations">Search Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../database/index.html#delete-operations">Delete Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../database/index.html#statistics-operations">Statistics Operations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../database/index.html#users">××™× ×“×§×¡×™× ×‘×§×•×œ×§×¦×™×™×ª users</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../database/indexing.html">MongoDB Indexing Cookbook</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../database/indexing.html#id1">×œ××”?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/indexing.html#id2">××™× ×“×§×¡×™× ××•××œ×¦×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/indexing.html#python-pymongo">××ª×›×•× ×™× (Python / PyMongo)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/indexing.html#explain-mongo-shell">×‘×“×™×§×•×ª explain (Mongo Shell)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/indexing.html#explain">××” ×œ×—×¤×© ×‘-explain?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/indexing.html#id3">×‘×“×™×§×ª ×§×™×•× ××™× ×“×§×¡×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/indexing.html#id4">×©×™×˜×•×ª ×¢×‘×•×“×” ××•××œ×¦×•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/indexing.html#id5">×“×•×’×××•×ª × ×•×¡×¤×•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/indexing.html#gotchas">Gotchas × ×¤×•×¦×™×</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../database/cursor-pagination.html">Cursor-based Pagination (created_at / _id)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../database/cursor-pagination.html#id1">×œ××”?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/cursor-pagination.html#id2">×¢×§×¨×•× ×•×ª ××™×•×Ÿ ×™×¦×™×‘</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/cursor-pagination.html#python">×§×™×“×•×“/×¤×¢× ×•×— ×§×•×¨×¡×•×¨ (Python)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/cursor-pagination.html#id3">×ª×‘× ×™×ª ×©××™×œ×ª×” (×—×“×© â†’ ×™×©×Ÿ)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/cursor-pagination.html#pymongo">PyMongo â€“ ×“×•×’××” ××œ××”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/cursor-pagination.html#id4">×“×¤×“×•×£ ×œ××—×•×¨ (×™×©×Ÿ â†’ ×—×“×©)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/cursor-pagination.html#copypaste">×‘×“×™×§×•×ª ×™×“× ×™×•×ª (Copyâ€‘Paste)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/cursor-pagination.html#id5">×©×™×˜×•×ª ×¢×‘×•×“×” ××•××œ×¦×•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/cursor-pagination.html#gotchas">Gotchas × ×¤×•×¦×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/cursor-pagination.html#id6">×§×™×©×•×¨×™×</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../database-schema.html">Database Schema</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../database-schema.html#collections">Collections</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../database-schema.html#code-snippets"><code class="docutils literal notranslate"><span class="pre">code_snippets</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../database-schema.html#users"><code class="docutils literal notranslate"><span class="pre">users</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../database-schema.html#bookmarks"><code class="docutils literal notranslate"><span class="pre">bookmarks</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../database-schema.html#sessions-webapp"><code class="docutils literal notranslate"><span class="pre">sessions</span></code> (WebApp)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../database-schema.html#indexes">Indexes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database-schema.html#relationships">Relationships</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database-schema.html#id1">×§×™×©×•×¨×™×</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">×¢×–×¨×” ×•×“×•×’×××•×ª:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">×“×•×’×××•×ª ×©×™××•×©</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#id2">×©×™××•×© ×‘×¡×™×¡×™</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples.html#id3">×™×¦×™×¨×ª ××¤×œ×™×§×¦×™×™×ª ×‘×•×˜</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples.html#id4">×©××™×¨×ª ×§×•×“ ×—×“×©</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples.html#id5">×—×™×¤×•×© ×§×•×“</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#handlers">×©×™××•×© ×‘-Handlers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples.html#command-handler">×™×¦×™×¨×ª Command Handler</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples.html#conversation-handler">×™×¦×™×¨×ª Conversation Handler</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#services">×©×™××•×© ×‘-Services</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples.html#id6">×–×™×”×•×™ ×©×¤×ª ×ª×›× ×•×ª</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples.html#id7">× ×™×ª×•×— ×§×•×“</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#github">××™× ×˜×’×¨×¦×™×” ×¢× GitHub</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples.html#gist">×”×¢×œ××ª ×§×•×“ ×œ-Gist</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples.html#gists">×©×œ×™×¤×ª Gists ×©×œ ××©×ª××©</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#id8">×¢×‘×•×“×” ×¢× ××¡×“ ×”× ×ª×•× ×™×</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples.html#id9">×‘×™×¦×•×¢ ×©××™×œ×ª×•×ª ××•×¨×›×‘×•×ª</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples.html#id10">×¢×“×›×•×Ÿ ×§×‘×¦×™×</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples.html#id11">×¡×˜×˜×™×¡×˜×™×§×•×ª</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#id12">×˜×™×¤×•×œ ×‘×©×’×™××•×ª</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples.html#id13">×˜×™×¤×•×œ ×‘×©×’×™××•×ª ×‘×¡×™×¡×™</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples.html#retry-logic">Retry Logic</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#id14">×‘×“×™×§×•×ª</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples.html#id15">×‘×“×™×§×ª ×™×—×™×“×”</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples.html#id16">×‘×“×™×§×ª ××™× ×˜×’×¨×¦×™×”</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#id17">×“×•×’×××•×ª ××ª×§×“××•×ª</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples.html#id18">×¢×™×‘×•×“ ×‘××¦×•×•×”</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples.html#id19">×§××©×™× ×’</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../testing.html">Testing Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../testing.html#quickstart">ğŸš€ Quickstart ×œ×˜×¡×˜×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing.html#id1">×”× ×—×™×•×ª ×§×¨×™×˜×™×•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing.html#stubs">×˜×¢×™× ×ª Stubs ×œ×˜×œ×’×¨×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing.html#tmp-path">×“×•×’××ª ×©×™××•×© ×‘â€‘tmp_path</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing.html#id2">××—×™×§×” ×‘×˜×•×—×”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing.html#pytest-cov">×›×™×¡×•×™ ×‘×“×™×§×•×ª (pytest-cov)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing.html#ci">CI × ×ª××š</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing.html#performance">×‘×“×™×§×•×ª ×‘×™×¦×•×¢×™× (Performance)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing.html#id3">×§×™×©×•×¨×™×</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../testing-rate-limit-examples.html">×“×•×’×××•×ª ×˜×¡×˜×™× â€“ Rate Limiting ×•××¡×™× ×›×¨×•× ×™×•×ª</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../testing-rate-limit-examples.html#rate-limiting-redis-mock">Rate Limiting (Redis Mock)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing-rate-limit-examples.html#id1">×˜×¡×˜×™× ××¡×™× ×›×¨×•× ×™×™×</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../performance-tests.html">×‘×“×™×§×•×ª ×‘×™×¦×•×¢×™× (Performance Tests)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../performance-tests.html#id1">××˜×¨×”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../performance-tests.html#id2">×¡×™××•×Ÿ ×˜×¡×˜×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../performance-tests.html#id3">×”×¨×¦×” ××§×•××™×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../performance-tests.html#ci-github-actions">CI / GitHub Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../performance-tests.html#id4">×“×•×—×•×ª ×•×–×× ×™ ×¨×™×¦×”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../performance-tests.html#id5">×˜×™×¤×™×</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ci-cd.html">CI/CD Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ci-cd.html#id1">×—×•×§×™× ×§×©×™×—×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ci-cd.html#id2">×¡×˜×˜×•×¡×™× × ×“×¨×©×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ci-cd.html#ci-overview">×¨×™×›×•×– CI (Overview)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ci-cd.html#id3">×‘×“×™×§×•×ª ××•××œ×¦×•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ci-cd.html#id4">×‘× ×™×™×” ×©×œ ×”×ª×™×¢×•×“</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ci-cd.html#id5">×§×™×©×•×¨×™×</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../conversation-handlers.html">Conversation Handlers &amp; States</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../conversation-handlers.html#id1">×¡×§×™×¨×”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../conversation-handlers.html#states">×¨×©×™××ª States (××‘×—×¨ ×‘×¤×•×¢×œ)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../conversation-handlers.html#save-flow">Save Flow (×ª×¨×©×™× ××¦×‘×™×)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../conversation-handlers.html#github-flow">GitHub Flow (×ª×¨×©×™× ××¦×‘×™×)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../conversation-handlers.html#handler">×“×•×’××ª Handler ×ª××¦×™×ª×™×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../conversation-handlers.html#id2">×˜×‘×œ×ª ×–×¨×™××•×ª ××œ××”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../conversation-handlers.html#id3">×§×™×©×•×¨×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../conversation-handlers.html#id4">×“×•×’×××•×ª ×§×•×“ ×ª××¦×™×ª×™×•×ª (×××©×™×•×ª)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../conversation-handlers.html#save">Save â€“ ×©×œ×‘×™× ×¢×™×§×¨×™×™×</a></li>
<li class="toctree-l3"><a class="reference internal" href="../conversation-handlers.html#github">GitHub â€“ ×ª×¤×¨×™×˜ ×•×©×™×—×ª ×”×¢×œ××”</a></li>
<li class="toctree-l3"><a class="reference internal" href="../conversation-handlers.html#backup">Backup â€“ ×ª×¤×¨×™×˜</a></li>
<li class="toctree-l3"><a class="reference internal" href="../conversation-handlers.html#drive">Drive â€“ ×ª×¤×¨×™×˜</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../conversation-handlers.html#id5">××•×§×©×™× × ×¤×•×¦×™× ×•×¤×ª×¨×•× ×•×ª</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../conversation-handlers.html#query-answer"><code class="docutils literal notranslate"><span class="pre">query.answer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../conversation-handlers.html#message-is-not-modified">×¢×¨×™×›×ª ×”×•×“×¢×•×ª ×‘×‘×˜×—×” â€“ â€Message is not modifiedâ€œ</a></li>
<li class="toctree-l3"><a class="reference internal" href="../conversation-handlers.html#filters">Filters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../conversation-handlers.html#persistent-data-context-user-data">Persistent data (<code class="docutils literal notranslate"><span class="pre">context.user_data</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../conversation-handlers.html#id6">×“×•×’×××•×ª ×˜×¡×˜×™× ×§×¦×¨×•×ª</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../conversation-handlers.html#id7">Save â€“ ×”×ª×—×œ×” ×•×–×¨×™××” ×‘×¡×™×¡×™×ª</a></li>
<li class="toctree-l3"><a class="reference internal" href="../conversation-handlers.html#github-upload-conv-handler">GitHub â€“ upload_conv_handler</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting.html">Troubleshooting Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting.html#id1">×©×’×™××•×ª × ×¤×•×¦×•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting.html#importerror-telegram-conversationhandler-filters">ImportError ×‘×–××Ÿ ×˜×¡×˜×™× (telegram / ConversationHandler / filters)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting.html#parse-mode">×©×’×™××•×ª parse_mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting.html#id2">×“×™×‘×•×’ ××”×™×¨</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting.html#mongodb">×‘×“×™×§×ª ×—×™×‘×•×¨ MongoDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting.html#id3">×§×™×©×•×¨×™×</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../development.html">Development Workflow</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../development.html#handler">×”×•×¡×¤×ª Handler ×—×“×©</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development.html#endpoint-webapp">×”×•×¡×¤×ª Endpoint ×œâ€‘WebApp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development.html#schema">×¢×“×›×•×Ÿ Schema ×‘××¡×“ ×”× ×ª×•× ×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development.html#id1">×§×™×©×•×¨×™×</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../development/pre-commit.html">Pre-commit Hooks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../development/pre-commit.html#id1">××˜×¨×”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/pre-commit.html#id2">×”×ª×§× ×” ×•×”×¨×¦×”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/pre-commit.html#hooks">Hooks ×¤×¢×™×œ×™× (×¢×™×§×¨×™×™×)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/pre-commit.html#id3">×˜×™×¤×™× ×œ×¤×ª×¨×•×Ÿ ×‘×¢×™×•×ª</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../integrations.html">Integrations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../integrations.html#github-api">GitHub API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../integrations.html#gist">×™×¦×™×¨×ª Gist (×“×•×’××”)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../integrations.html#google-drive-oauth-flow">Google Drive (OAuth Flow)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../integrations.html#telegram-webhooks-vs-polling">Telegram Webhooks vs Polling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../integrations.html#id1">×§×™×©×•×¨×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../integrations.html#github-scopes">GitHub â€“ Scopes × ×“×¨×©×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../integrations.html#troubleshooting-github-rate-limits">Troubleshooting GitHub â€“ Rate limits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../integrations.html#github-cli-gh">GitHub CLI (gh) â€“ ×ª×§×¦×™×¨ ×§×¦×¨</a></li>
<li class="toctree-l2"><a class="reference internal" href="../integrations.html#repository-providers">Repository Providers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../integrations.html#best-practices-monorepos">Best Practices â€“ ×××’×¨×™× ×’×“×•×œ×™×/Monorepos</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../repository-integrations.html">Repository Integrations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../repository-integrations.html#id1">×¡×§×™×¨×”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../repository-integrations.html#id2">××¦×‘ ×ª××™×›×”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../repository-integrations.html#id3">×”×¢×¨×•×ª</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../security.html">Security Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../security.html#id1">×¡×•×“×•×ª ×•×¤×¨×˜×™×•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../security.html#id2">×”×¦×¤× ×ª ×˜×•×§× ×™× (×“×•×’××”)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../security.html#csrf-webapp">CSRF ×‘â€‘WebApp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../security.html#rate-limiting">Rate Limiting (×“×•×’××”)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../security.html#id3">×§×™×©×•×¨×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../security.html#id4">××‘×˜×—×ª ×”×•×“×¢×•×ª ×‘×˜×œ×’×¨×</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../monitoring.html">Smart Observability v7 â€“ Predictive Health &amp; Adaptive Feedback</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../monitoring.html#grafana-telegram-webhook">×—×™×‘×•×¨ Grafana â†’ Telegram (Webhook)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monitoring.html#grafana-annotations">Grafana Annotations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monitoring.html#adaptive-thresholds">Adaptive Thresholds (×¡×¤×™× ×“×™× ××™×™×)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monitoring.html#predictive-health-v7">Predictive Health (v7)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../monitoring.html#safe-mode">SAFE_MODE ×•×“×™×œ×•×’ ×¢×œ ×¤×¢×•×œ×•×ª ×× ×¢</a></li>
<li class="toctree-l3"><a class="reference internal" href="../monitoring.html#chatops">ChatOps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../monitoring.html#chatops-rate-limit">×”×¨×©××•×ª ChatOps ×•-Rate Limit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../monitoring.html#grafana">Grafana â€“ ×™×™×‘×•× ×“×©×‘×•×¨×“ ×œ×“×•×’××”</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../monitoring.html#grafana-accuracy-prevention-panels">Grafana â€“ Accuracy &amp; Prevention Panels</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../monitoring.html#feedback-loop">×ª×¨×©×™× ×–×¨×™××ª Feedback Loop</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../monitoring.html#autoremediation-v5">Autoâ€‘Remediation (v5)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../monitoring.html#incident-memory">Incident Memory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../monitoring.html#id1">Feedback Loop ×œ××™×¨×•×¢×™× ×—×•×–×¨×™×</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../monitoring.html#chatops-observe">ChatOps â€“ /observe</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../monitoring.html#id2">×”×¨×—×‘×•×ª ××¦×‘ ××¤×•×¨×˜</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../monitoring.html#endpoints">Endpoints</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monitoring.html#id3">×§×™×©×•×¨×™× ×œ×ª×™×¢×•×“ ChatOps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../monitoring.html#id4">×˜×™×¤×™×</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../git-lfs.html">Git LFS Integration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../git-lfs.html#id1">××˜×¨×”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../git-lfs.html#lfs">××ª×™ ×œ×”×©×ª××© ×‘â€‘LFS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../git-lfs.html#id2">×”×ª×§× ×” ×‘×¡×™×¡×™×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../git-lfs.html#best-practices">Best Practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../git-lfs.html#id3">××’×‘×œ×•×ª ×•×’×‘×•×œ×•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../git-lfs.html#id4">×§×™×©×•×¨×™×</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../user/bookmarks.html">×¡×™×× ×™×•×ª (Bookmarks)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../user/bookmarks.html#id1">××”×Ÿ ×¡×™×× ×™×•×ª?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/bookmarks.html#id2">××™×š ×œ×”×•×¡×™×£ ×¡×™×× ×™×™×”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/bookmarks.html#id3">×¤×× ×œ ×”×¡×™×× ×™×•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/bookmarks.html#anchor">Anchor ×™×¦×™×‘</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/bookmarks.html#id4">××’×‘×œ×•×ª, ××‘×˜×—×” ×•×¤×¨×˜×™×•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/bookmarks.html#api">API ×§×¦×¨ (×œ××¤×ª×—×™×)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/bookmarks.html#id5">×”×¢×¨×•×ª ×©×™××•×©×™×•×ª</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../user/sticky_notes.html">×¤×ª×§×™× ×“×‘×™×§×™× (Sticky Notes)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../user/sticky_notes.html#id1">××”× ×¤×ª×§×™× ×“×‘×™×§×™×?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/sticky_notes.html#id2">××™×š ××•×¡×™×¤×™× ×•×× ×”×œ×™× ×¤×ª×§×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/sticky_notes.html#id3">×¢×™×’×•×Ÿ ×™×¦×™×‘ ×œ×¢×•××ª ××™×§×•× ×§×‘×•×¢</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/sticky_notes.html#id4">×©×™×œ×•×‘ ×¢× ×¡×™×× ×™×•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/sticky_notes.html#id5">××’×‘×œ×•×ª, ×¤×¨×˜×™×•×ª ×•××‘×˜×—×”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/sticky_notes.html#id6">×˜×™×¤×™× ×©×™××•×©×™×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/sticky_notes.html#api">API ×§×¦×¨ (×œ××¤×ª×—×™×)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/sticky_notes.html#troubleshooting">Troubleshooting ×§×¦×¨</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../user/my_collections.html">×”××•×¡×¤×™× ×©×œ×™ (My Collections)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../user/my_collections.html#id1">××”× ××•×¡×¤×™×?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/my_collections.html#id2">×™×›×•×œ×•×ª ××¨×›×–×™×•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/my_collections.html#id3">××™×š ××©×ª××©×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/my_collections.html#id4">×©×™×œ×•×‘ ×¢× ×¡×™×× ×™×•×ª ×•×¤×ª×§×™× ×“×‘×™×§×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/my_collections.html#id5">××’×‘×œ×•×ª ×•×¤×¨×˜×™×•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/my_collections.html#api">API ×§×¦×¨ (×œ××¤×ª×—×™×)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/my_collections.html#id6">×˜×™×¤×™×</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../user/share_code.html">×©×™×ª×•×£ ×§×•×“ (×—×©×•×‘)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../user/share_code.html#id2">××” ×–×” ×¢×•×©×”?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/share_code.html#id3">××™×¤×” ×”×›×¤×ª×•×¨ ××•×¤×™×¢?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/share_code.html#id4">××™×š ×–×” ×¢×•×‘×“ (×–×¨×™××”)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/share_code.html#env">×“×¨×™×©×•×ª ×¡×‘×™×‘×ª×™×•×ª (ENV)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/share_code.html#id5">××’×‘×œ×•×ª ×•×”×ª× ×”×’×•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/share_code.html#id6">×”×•×“×¢×•×ª ×”×¦×œ×—×”/×©×’×™××”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/share_code.html#troubleshooting">Troubleshooting ×§×¦×¨</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/share_code.html#id7">×“×•×’×××•×ª (×˜×§×¡×˜×•××œ×™×•×ª)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../user/github_browse.html">×¢×™×•×Ÿ ×‘×§×•×“ GitHub (×›×•×œ×œ ×—×™×¤×•×© ×‘×©× ×§×•×‘×¥)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../user/github_browse.html#id1">×©×•×¨×ª ×›×œ×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/github_browse.html#id2">×ª×•×¦××•×ª ×—×™×¤×•×©</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/github_browse.html#id3">× ×™×•×•×˜ ×¨×™×¤×•</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../user/download_repo.html">×”×•×¨×“×ª ×¨×™×¤×•</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../user/download_repo.html#id2">××” ×‘×“×™×•×§ ××•×¨×™×“</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/download_repo.html#id3">××’×‘×œ×•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/download_repo.html#id4">×”×•×“×¢×•×ª × ×¤×•×¦×•×ª</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">××™×›×•×ª ×•×§×•× ×‘× ×¦×™×•×ª:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quality/type-safety.html">ğŸ“ Type Hints â€“ Best Practices</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../quality/type-safety.html#id1">××¡×˜×¨×˜×’×™×”: ×”×§×©×—×” ×”×“×¨×’×ª×™×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quality/type-safety.html#id2">×¤×¨×•×˜×•×§×•×œ×™× ×•×¡×˜××‘×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quality/type-safety.html#id3">×“×•×’×××•×ª ××”×§×•×“</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quality/type-safety.html#mypy">×”×’×“×¨×•×ª MyPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quality/type-safety.html#id4">××¡×œ×•×œ ××™×’×¨×¦×™×”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quality/type-safety.html#id5">×”× ×—×™×•×ª ×œ×¡×•×›× ×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quality/type-safety.html#id6">×“×•×’×××•×ª ×§×¦×¨×•×ª</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">WebApp:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../webapp/overview.html">×”××™× ×™ Web App (×¡×§×™×¨×”)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../webapp/overview.html#id1">××” × ×•×ª×Ÿ?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../webapp/overview.html#id2">×›×ª×•×‘×ª ×•×”×¨×©××•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../webapp/overview.html#env">×”×’×“×¨×•×ª ENV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../webapp/overview.html#id3">×§×™×©×•×¨×™× ×•×ª××•× ×•×ª ××¡×š</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../webapp/caching.html">Caching &amp; HTTP Validators (ETag / Last-Modified / 304)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../webapp/caching.html#id1">×œ××” ×–×” ×—×©×•×‘?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../webapp/caching.html#id2">×¢×§×¨×•× ×•×ª ×‘×¡×™×¡</a></li>
<li class="toctree-l2"><a class="reference internal" href="../webapp/caching.html#flask-werkzeug">××ª×›×•×Ÿ: Flask + werkzeug</a></li>
<li class="toctree-l2"><a class="reference internal" href="../webapp/caching.html#copypaste">×‘×“×™×§×•×ª ×™×“× ×™×•×ª (Copyâ€‘Paste)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../webapp/caching.html#checklist">Checklist ×œ××™××•×© × ×›×•×Ÿ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../webapp/caching.html#gotchas">Gotchas × ×¤×•×¦×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../webapp/caching.html#cache-control">×©×™×œ×•×‘ ×¢× Cache-Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../webapp/caching.html#id3">×§×™×©×•×¨×™× × ×•×¡×¤×™×</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../webapp/static-checklist.html">Static Performance &amp; Security Checklist (gzip/br, Cache, SRI)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../webapp/static-checklist.html#id1">××˜×¨×”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../webapp/static-checklist.html#br-gzip">×“×—×™×¡×” (br/gzip)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../webapp/static-checklist.html#cache-control">×›×•×ª×¨×•×ª Cache-Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../webapp/static-checklist.html#subresource-integrity-sri">Subresource Integrity (SRI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../webapp/static-checklist.html#copypaste">×‘×“×™×§×•×ª ×™×“× ×™×•×ª (Copyâ€‘Paste)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../webapp/static-checklist.html#best-practices">Best Practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../webapp/static-checklist.html#gotchas">Gotchas</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../webapp/api-reference.html">WebApp API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../webapp/api-reference.html#endpoints">Endpoints</a></li>
<li class="toctree-l2"><a class="reference internal" href="../webapp/api-reference.html#authentication-flow">Authentication Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../webapp/api-reference.html#response-schema-example">Response Schema Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../webapp/api-reference.html#errors">Errors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../webapp/api-reference.html#id1">×§×™×©×•×¨×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../webapp/api-reference.html#files">××¡× ×Ÿ ×•×©×“×•×ª ×§×œ×˜ ×œ-<code class="docutils literal notranslate"><span class="pre">/files</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../webapp/api-reference.html#id2">×˜×‘×œ×ª ×¤×¨××˜×¨×™×</a></li>
<li class="toctree-l3"><a class="reference internal" href="../webapp/api-reference.html#id3">×“×•×’×××•×ª ×‘×§×©×”</a></li>
<li class="toctree-l3"><a class="reference internal" href="../webapp/api-reference.html#id4">×“×•×’×××•×ª ×ª×’×•×‘×”</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../webapp/bulk-actions.html">Bulk actions (×‘×—×™×¨×” ××¨×•×‘×”)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../webapp/bulk-actions.html#id1">×¡×§×™×¨×”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../webapp/bulk-actions.html#endpoints">Endpoints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../webapp/bulk-actions.html#post-api-files-bulk-favorite"><code class="docutils literal notranslate"><span class="pre">POST</span> <span class="pre">/api/files/bulk-favorite</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../webapp/bulk-actions.html#post-api-files-bulk-unfavorite"><code class="docutils literal notranslate"><span class="pre">POST</span> <span class="pre">/api/files/bulk-unfavorite</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../webapp/bulk-actions.html#post-api-files-bulk-tag"><code class="docutils literal notranslate"><span class="pre">POST</span> <span class="pre">/api/files/bulk-tag</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../webapp/bulk-actions.html#post-api-files-create-zip"><code class="docutils literal notranslate"><span class="pre">POST</span> <span class="pre">/api/files/create-zip</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../webapp/bulk-actions.html#post-api-files-bulk-delete-soft-delete"><code class="docutils literal notranslate"><span class="pre">POST</span> <span class="pre">/api/files/bulk-delete</span></code> (Soft Delete)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../webapp/bulk-actions.html#post-api-files-create-share-link"><code class="docutils literal notranslate"><span class="pre">POST</span> <span class="pre">/api/files/create-share-link</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../webapp/bulk-actions.html#id2">×©×’×™××•×ª × ×¤×•×¦×•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../webapp/bulk-actions.html#id3">×”×¢×¨×•×ª ×œ××¤×ª×—×™×</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../webapp/editor.html">âŒ¨ï¸ ×¢×•×¨×š ×§×•×“ (WebApp Editor)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../webapp/editor.html#codemirror-isloading">×˜×¢×™× ×ª CodeMirror ×•××¦×‘ isLoading</a></li>
<li class="toctree-l2"><a class="reference internal" href="../webapp/editor.html#api">×©××™×¨×ª ×”×¢×“×¤×•×ª ××©×ª××© â€“ ×©× ×™ × ×ª×™×‘×™ API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../webapp/editor.html#id1">×”××œ×¦×•×ª</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Observability</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../observability.html">××•×‘×–×¨×•×•×‘×™×œ×™×•×ª (Observability)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../observability.html#id1">××˜×¨×•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../observability.html#id2">×§×”×œ×™ ×™×¢×“</a></li>
<li class="toctree-l2"><a class="reference internal" href="../observability.html#id3">×ª×¦×•×¨×”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../observability.html#backend-traces">×‘×—×™×¨×ª Backend ×œÖ¾Traces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../observability.html#otlp">×”×’×“×¨×ª OTLP ×œ×¡×‘×™×‘×•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../observability.html#id4">×§×™×©×•×¨×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../observability.html#manual-instrumentation">××™× ×¡×˜×¨×•×× ×˜×¦×™×” ×™×“× ×™×ª (Manual Instrumentation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../observability.html#jaeger">×“×•×§×¨ ×§×•××¤×•×– â€“ ×”×¤×¢×œ×” ××”×™×¨×” ×¢× Jaeger</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../observability.html#quick-start-jaeger">Quick start â€“ ××™××•×ª ×¡×¤×× ×™× ×‘Ö¾Jaeger</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../observability.html#traced">×›×™×¡×•×™ ×“×§×•×¨×˜×•×¨ &#64;traced</a></li>
<li class="toctree-l2"><a class="reference internal" href="../observability.html#staging">××™××•×ª ×‘-Staging</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../rate-limiting.html">Rate Limiting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../rate-limiting.html#id1">××‘×•×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rate-limiting.html#shadow-mode">Shadow Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rate-limiting.html#softwarning-80">Softâ€‘Warning (80%)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rate-limiting.html#admin-bypass">Admin Bypass</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rate-limiting.html#monitoring">Monitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rate-limiting.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rate-limiting.html#id2">×§×™×©×•×¨×™×</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../observability/guidelines.html">ğŸ“Š ×”× ×—×™×•×ª Observability ×•××™×¨×•×¢×™×</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../observability/guidelines.html#id1">×ª×‘× ×™×ª ××™×¨×•×¢/×œ×•×’ â€“ ×©×“×•×ª ×—×•×‘×”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../observability/guidelines.html#fail-open">×¢×§×¨×•×Ÿ Fail-Open</a></li>
<li class="toctree-l2"><a class="reference internal" href="../observability/guidelines.html#id2">×”× ×—×™×•×ª ×˜×™×¤×•×œ ×‘×©×’×™××•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../observability/guidelines.html#request-id">×§×•×¨×œ×¦×™×” ×¢× request_id</a></li>
<li class="toctree-l2"><a class="reference internal" href="../observability/guidelines.html#id3">×¡×˜× ×“×¨×˜×™× × ×•×¡×¤×™×</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../logging_schema.html">×¡×›××ª ×œ×•×’×™× ×•××™×¨×•×¢×™× (Observability)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../logging_schema.html#id1">×©×“×•×ª ×—×•×‘×” ×‘×›×œ ××™×¨×•×¢</a></li>
<li class="toctree-l2"><a class="reference internal" href="../logging_schema.html#id2">×©×“×•×ª ××•××œ×¦×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../logging_schema.html#id3">××™×¨×•×¢×™× ××¨×›×–×™×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../logging_schema.html#sampling">×“×’×™××” (Sampling)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../logging_schema.html#id4">×¤×¨×˜×™×•×ª</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../metrics.html">××“×“×™× (Metrics)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../metrics.html#id1">× ×§×•×“×ª ×§×¦×”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics.html#id2">××˜×¨×™×§×•×ª ×§×™×™××•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics.html#opentelemetry">××˜×¨×™×§×•×ª OpenTelemetry (×× ×–××™× ×•×ª)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics.html#promql">×“×•×’×××•×ª PromQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics.html#tracing-grafana">Tracing ×‘-Grafana</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics.html#slo-sli">SLO/SLI ×œ×“×•×’××”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics.html#prometheus-alerting-rules">×”×ª×¨××•×ª (Prometheus alerting rules)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../alerts.html">×”×ª×¨××•×ª (Alerts)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../alerts.html#id1">×—×•×§×™ ×”×ª×¨××” ×œ×“×•×’××”</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sentry.html">Sentry</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../sentry.html#id1">×”×¤×¢×œ×” (××©×ª× ×™ ×¡×‘×™×‘×”)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sentry.html#id2">×¢×§×¨×•× ×•×ª</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../runbooks/logging-levels.html">×©×™× ×•×™ ×¨××•×ª ×œ×•×’×™×</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../runbooks/logging-levels.html#debug">××ª×™ ×œ×”×¢×œ×•×ª ×œ-DEBUG</a></li>
<li class="toctree-l2"><a class="reference internal" href="../runbooks/logging-levels.html#id2">×˜×™×¤</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../runbooks/github_backup_restore.html">GitHub Backup &amp; Restore Runbook</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../runbooks/github_backup_restore.html#id1">××˜×¨×”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../runbooks/github_backup_restore.html#id2">×“×¨×™×©×•×ª ××§×“×™××•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../runbooks/github_backup_restore.html#checkpoint-tag">×™×¦×™×¨×ª × ×§×•×“×ª ×’×™×‘×•×™ (Checkpoint Tag)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../runbooks/github_backup_restore.html#zip">×™×¦×™×¨×ª ××¨×›×™×•×Ÿ ZIP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../runbooks/github_backup_restore.html#id3">×©×—×–×•×¨ â€“ ×‘×“×™×§×” ××§×•××™×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../runbooks/github_backup_restore.html#id4">×©×—×–×•×¨ ××œ× ×œ×¤×¨×•×“×§×©×Ÿ (×–×”×™×¨×•×ª!)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../runbooks/github_backup_restore.html#id5">×©×—×–×•×¨ ×§×‘×¦×™×/×ª×™×§×™×•×ª × ×§×•×“×ª×™×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../runbooks/github_backup_restore.html#id6">×˜×™×¤×™× ×•×‘×˜×™×—×•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../runbooks/github_backup_restore.html#id7">×§×™×©×•×¨×™×</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../runbooks/slo.html">Runbooks â€“ SLO Incidents</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../runbooks/slo.html#higherrorrate">HighErrorRate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../runbooks/slo.html#sloavailabilitybreach-99-9">SLOAvailabilityBreach (×–××™× ×•×ª &lt; 99.9%)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../runbooks/slo.html#slolatencyp95breach-p95-0-5s">SLOLatencyP95Breach (P95 &gt; 0.5s)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../runbooks/slo.html#id1">×“×©×‘×•×¨×“</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ChatOps</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../chatops/overview.html">ChatOps â€“ ×¡×§×™×¨×” ×›×œ×œ×™×ª</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../chatops/overview.html#id1">×¢×§×¨×•× ×•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chatops/overview.html#id2">×§×™×©×•×¨×™×</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../chatops/commands.html">×¤×§×•×“×•×ª ChatOps</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../chatops/commands.html#status">/status</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chatops/commands.html#errors">/errors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chatops/commands.html#triage">/triage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chatops/commands.html#predict">/predict</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chatops/commands.html#observe-v">/observe -v (××¤×•×¨×˜)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chatops/commands.html#observe-vv">/observe -vv (××¤×•×¨×˜ ×××•×“)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chatops/commands.html#rate-limit">/rate_limit</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../chatops/playbooks.html">Playbooks â€“ ×ª×¨×—×™×©×™× × ×¤×•×¦×™×</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../chatops/playbooks.html#p95-latency">p95 Latency ×¢×œ×” ××¢×œ ×”×¡×£</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chatops/playbooks.html#error-rate-1">Error Rate &gt; 1%</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chatops/playbooks.html#memory-usage">Memory Usage ××˜×¤×¡</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chatops/playbooks.html#id1">×©×™×¨×•×ª ×—×™×¦×•× ×™ ××™×˜×™</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chatops/playbooks.html#repeated-incident-15">Repeated Incident ×ª×—×ª 15 ×“×§Â«</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../chatops/permissions.html">×”×¨×©××•×ª ×•-Rate Limit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chatops/troubleshooting.html">×¤×ª×¨×•×Ÿ ×ª×§×œ×•×ª (FAQ)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chatops/faq.html">×©××œ×•×ª × ×¤×•×¦×•×ª</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">×¡×•×›× ×™ AI:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ai-agents/guide.html">ğŸ¤– ××“×¨×™×š ×œ×¡×•×›× ×™ AI</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ai-agents/guide.html#id1">× ×§×•×“×ª ×¤×ª×™×—×” ××”×™×¨×”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ai-agents/guide.html#id2">××‘× ×” ×”×¤×¨×•×™×§×˜ (×‘×§×¦×¨×”)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ai-agents/guide.html#id3">×”×•×¡×¤×ª ×¤×™×¦â€™×¨×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ai-agents/guide.html#id4">×¡×§×¨×™×¤×˜×™× ×—×©×•×‘×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ai-agents/guide.html#id5">××¤×ª ×“×¨×›×™×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ai-agents/guide.html#github-issues-chatops">GitHub Issues ×•-ChatOps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../agents/rate-limiting.html">ğŸš¦ ××¢×¨×›×ª Rate Limiting ×œ×¡×•×›× ×™ AI ×•×œ×•×•×‘</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../agents/rate-limiting.html#shadow-mode">××¡×˜×¨×˜×’×™×” â€“ Shadow Mode ×ª×—×™×œ×”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../agents/rate-limiting.html#id1">××©×ª× ×™ ×¡×‘×™×‘×” ×•×§×•× ×¤×™×’</a></li>
<li class="toctree-l2"><a class="reference internal" href="../agents/rate-limiting.html#id2">××™× ×˜×’×¨×¦×™×” â€“ ×‘×•×˜ ×˜×œ×’×¨×</a></li>
<li class="toctree-l2"><a class="reference internal" href="../agents/rate-limiting.html#flask-webapp">××™× ×˜×’×¨×¦×™×” â€“ Flask/WebApp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../agents/rate-limiting.html#id3">×”×—×¨×’×•×ª ×—×©×•×‘×•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../agents/rate-limiting.html#prometheus">× ×™×˜×•×¨ ×•××“×“×™× (Prometheus)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../agents/rate-limiting.html#id4">××‘×˜×—×” ×•×”×’× ×•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../agents/rate-limiting.html#pydantic-settings">×§×•× ×¤×™×’×•×¨×¦×™×” (Pydantic Settings)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../agents/rate-limiting.html#id5">×ª×§×œ×•×ª × ×¤×•×¦×•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../agents/rate-limiting.html#id6">×§×™×©×•×¨×™×</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Observability â€“ Advanced</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../observability/events_catalog.html">×§×˜×œ×•×’ ××™×¨×•×¢×™× ×§× ×•× ×™×™×</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../observability/events_catalog.html#github">GitHub</a></li>
<li class="toctree-l2"><a class="reference internal" href="../observability/events_catalog.html#db">DB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../observability/events_catalog.html#web-share">Web/Share</a></li>
<li class="toctree-l2"><a class="reference internal" href="../observability/events_catalog.html#alerts">Alerts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../observability/events_catalog.html#repo-analyzer">Repo Analyzer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../observability/events_catalog.html#business">Business</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../observability/error_codes.html">××™×œ×•×Ÿ ×§×•×“×™ ×©×’×™××” (Error Codes)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../observability/error_codes.html#id1">×“×•×’×××•×ª ××™×¤×•×™</a></li>
<li class="toctree-l2"><a class="reference internal" href="../observability/error_codes.html#id2">×”× ×—×™×•×ª</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../observability/metrics_promql.html">×©××™×œ×ª×•×ª PromQL ×©×™××•×©×™×•×ª</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../observability/metrics_promql.html#latency">×–××Ÿ ×ª×’×•×‘×” (Latency)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../observability/metrics_promql.html#id1">×©×™×¢×•×¨ ×©×’×™××•×ª</a></li>
<li class="toctree-l2"><a class="reference internal" href="../observability/metrics_promql.html#id2">××™×¨×•×¢×™ ×‘×™×–× ×¡</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../observability/alerts_playbook.html">Playbook ×§×¦×¨ ×œ×”×ª×¨××•×ª</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../observability/alerts_playbook.html#id1">×–×¨×™××”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../observability/alerts_playbook.html#id2">×§×™×©×•×¨×™× ×‘×§×•×“</a></li>
<li class="toctree-l2"><a class="reference internal" href="../observability/alerts_playbook.html#id3">×“×’×©×™×</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Code Keeper Bot</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Module code</a></li>
      <li class="breadcrumb-item active">utils</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>×”×¨××” ×§×•×“ ××§×•×¨ ×œ utils</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">×¤×•× ×§×¦×™×•×ª ×¢×–×¨ ×›×œ×œ×™×•×ª ×œ×‘×•×˜ ×©×•××¨ ×§×‘×¦×™ ×§×•×“</span>
<span class="sd">General Utility Functions for Code Keeper Bot</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">asyncio</span>
<span class="kn">import</span> <span class="nn">unicodedata</span>
<span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">mimetypes</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">secrets</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">tempfile</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">zipfile</span>
<span class="kn">from</span> <span class="nn">contextlib</span> <span class="kn">import</span> <span class="n">contextmanager</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span><span class="p">,</span> <span class="n">timezone</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">wraps</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span>

<span class="c1"># Optional telegram import with safe fallback for web-only environments</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">telegram</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>  <span class="c1"># pragma: no cover - executed only when telegram is missing</span>
    <span class="kn">import</span> <span class="nn">types</span> <span class="k">as</span> <span class="nn">_types</span>

    <span class="k">class</span> <span class="nc">_BadRequest</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="n">telegram</span> <span class="o">=</span> <span class="n">_types</span><span class="o">.</span><span class="n">SimpleNamespace</span><span class="p">(</span>
        <span class="n">error</span><span class="o">=</span><span class="n">_types</span><span class="o">.</span><span class="n">SimpleNamespace</span><span class="p">(</span><span class="n">BadRequest</span><span class="o">=</span><span class="n">_BadRequest</span><span class="p">)</span>
    <span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">aiofiles</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>  <span class="c1"># optional for tests</span>
    <span class="n">aiofiles</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">aiohttp</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>  <span class="c1"># optional for tests</span>
    <span class="n">aiohttp</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">try</span><span class="p">:</span>
    <span class="c1"># ×§×•× ×¤×™×’ ××¨×›×–×™ (×›×•×œ×œ ×‘×¨×™×¨×•×ª ××—×“×œ ×œâ€‘aiohttp)</span>
    <span class="kn">from</span> <span class="nn">config</span> <span class="kn">import</span> <span class="n">config</span>  <span class="c1"># type: ignore</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
    <span class="n">config</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># type: ignore</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">telegram</span> <span class="kn">import</span> <span class="n">Message</span><span class="p">,</span> <span class="n">Update</span><span class="p">,</span> <span class="n">User</span>
    <span class="kn">from</span> <span class="nn">telegram.constants</span> <span class="kn">import</span> <span class="n">ChatAction</span><span class="p">,</span> <span class="n">ParseMode</span>
    <span class="kn">from</span> <span class="nn">telegram.ext</span> <span class="kn">import</span> <span class="n">ContextTypes</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>  <span class="c1"># lightweight stubs for test env</span>
    <span class="k">class</span> <span class="nc">Message</span><span class="p">:</span>  <span class="c1"># type: ignore[no-redef]</span>
        <span class="k">pass</span>
    <span class="k">class</span> <span class="nc">Update</span><span class="p">:</span>  <span class="c1"># type: ignore[no-redef]</span>
        <span class="k">pass</span>
    <span class="k">class</span> <span class="nc">User</span><span class="p">:</span>  <span class="c1"># type: ignore[no-redef]</span>
        <span class="k">pass</span>
    <span class="n">ChatAction</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">ParseMode</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">class</span> <span class="nc">_ContextTypes</span><span class="p">:</span>
        <span class="n">DEFAULT_TYPE</span> <span class="o">=</span> <span class="nb">object</span>
    <span class="n">ContextTypes</span> <span class="o">=</span> <span class="n">_ContextTypes</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<div class="viewcode-block" id="CodeErrorLogger">
<a class="viewcode-back" href="../modules/index.html#utils.CodeErrorLogger">[×ª×™×¢×•×“]</a>
<span class="k">class</span> <span class="nc">CodeErrorLogger</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;××¢×¨×›×ª ×œ×•×’×™× ×™×™×¢×•×“×™×ª ×œ×©×’×™××•×ª ×¢×™×‘×•×“ ×§×•×“&quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="CodeErrorLogger.__init__">
<a class="viewcode-back" href="../modules/index.html#utils.CodeErrorLogger.__init__">[×ª×™×¢×•×“]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;code_error_system&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_logger</span><span class="p">()</span></div>

    
    <span class="k">def</span> <span class="nf">_setup_logger</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×”×’×“×¨×ª ×”×œ×•×’×¨ ×¢× ×§×‘×¦×™ ×™×•××Ÿ × ×¤×¨×“×™×&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">handlers</span><span class="p">:</span>
            <span class="c1"># ×œ×•×’×¨ ×œ×©×’×™××•×ª ×›×œ×œ×™×•×ª - ×©×™××•×© ×‘-StreamHandler ×œ×¡×‘×™×‘×ª ×¤×¨×•×“×§×©×Ÿ</span>
            <span class="n">error_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">()</span>
            <span class="n">error_handler</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">)</span>
            <span class="n">error_formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span>
                <span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> - </span><span class="si">%(name)s</span><span class="s1"> - </span><span class="si">%(levelname)s</span><span class="s1"> - </span><span class="si">%(message)s</span><span class="s1">&#39;</span>
            <span class="p">)</span>
            <span class="n">error_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">error_formatter</span><span class="p">)</span>
            
            <span class="c1"># ×œ×•×’×¨ ×œ×¡×˜×˜×™×¡×˜×™×§×•×ª ×•×¤×¢×™×œ×•×ª - ×©×™××•×© ×‘-StreamHandler ×œ×¡×‘×™×‘×ª ×¤×¨×•×“×§×©×Ÿ</span>
            <span class="n">activity_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">()</span>
            <span class="n">activity_handler</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
            <span class="n">activity_formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span>
                <span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> - </span><span class="si">%(levelname)s</span><span class="s1"> - </span><span class="si">%(message)s</span><span class="s1">&#39;</span>
            <span class="p">)</span>
            <span class="n">activity_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">activity_formatter</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">error_handler</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">activity_handler</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    
<div class="viewcode-block" id="CodeErrorLogger.log_code_processing_error">
<a class="viewcode-back" href="../modules/index.html#utils.CodeErrorLogger.log_code_processing_error">[×ª×™×¢×•×“]</a>
    <span class="k">def</span> <span class="nf">log_code_processing_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">error_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">error_message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
                                <span class="n">context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×¨×™×©×•× ×©×’×™××•×ª ×¢×™×‘×•×“ ×§×•×“&quot;&quot;&quot;</span>
        <span class="n">context</span> <span class="o">=</span> <span class="n">context</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="n">log_entry</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
            <span class="s2">&quot;user_id&quot;</span><span class="p">:</span> <span class="n">user_id</span><span class="p">,</span>
            <span class="s2">&quot;error_type&quot;</span><span class="p">:</span> <span class="n">error_type</span><span class="p">,</span>
            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="n">error_message</span><span class="p">,</span>
            <span class="s2">&quot;context&quot;</span><span class="p">:</span> <span class="n">context</span>
        <span class="p">}</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CODE_ERROR: </span><span class="si">{</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">log_entry</span><span class="p">,</span><span class="w"> </span><span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="CodeErrorLogger.log_code_activity">
<a class="viewcode-back" href="../modules/index.html#utils.CodeErrorLogger.log_code_activity">[×ª×™×¢×•×“]</a>
    <span class="k">def</span> <span class="nf">log_code_activity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">activity_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">details</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×¨×™×©×•× ×¤×¢×™×œ×•×ª ×¢×™×‘×•×“ ×§×•×“&quot;&quot;&quot;</span>
        <span class="n">details</span> <span class="o">=</span> <span class="n">details</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="n">log_entry</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
            <span class="s2">&quot;user_id&quot;</span><span class="p">:</span> <span class="n">user_id</span><span class="p">,</span>
            <span class="s2">&quot;activity&quot;</span><span class="p">:</span> <span class="n">activity_type</span><span class="p">,</span>
            <span class="s2">&quot;details&quot;</span><span class="p">:</span> <span class="n">details</span>
        <span class="p">}</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CODE_ACTIVITY: </span><span class="si">{</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">log_entry</span><span class="p">,</span><span class="w"> </span><span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="CodeErrorLogger.log_validation_failure">
<a class="viewcode-back" href="../modules/index.html#utils.CodeErrorLogger.log_validation_failure">[×ª×™×¢×•×“]</a>
    <span class="k">def</span> <span class="nf">log_validation_failure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">code_length</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">error_reason</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×¨×™×©×•× ×›×©×œ ×‘××™××•×ª ×§×•×“&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_code_processing_error</span><span class="p">(</span>
            <span class="n">user_id</span><span class="p">,</span> 
            <span class="s2">&quot;validation_failure&quot;</span><span class="p">,</span> 
            <span class="n">error_reason</span><span class="p">,</span>
            <span class="p">{</span><span class="s2">&quot;code_length&quot;</span><span class="p">:</span> <span class="n">code_length</span><span class="p">}</span>
        <span class="p">)</span></div>

    
<div class="viewcode-block" id="CodeErrorLogger.log_sanitization_success">
<a class="viewcode-back" href="../modules/index.html#utils.CodeErrorLogger.log_sanitization_success">[×ª×™×¢×•×“]</a>
    <span class="k">def</span> <span class="nf">log_sanitization_success</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">original_length</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">cleaned_length</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×¨×™×©×•× ×”×¦×œ×—×” ×‘×¡× ×™×˜×¦×™×”&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_code_activity</span><span class="p">(</span>
            <span class="n">user_id</span><span class="p">,</span>
            <span class="s2">&quot;code_sanitized&quot;</span><span class="p">,</span>
            <span class="p">{</span>
                <span class="s2">&quot;original_length&quot;</span><span class="p">:</span> <span class="n">original_length</span><span class="p">,</span>
                <span class="s2">&quot;cleaned_length&quot;</span><span class="p">:</span> <span class="n">cleaned_length</span><span class="p">,</span>
                <span class="s2">&quot;reduction&quot;</span><span class="p">:</span> <span class="n">original_length</span> <span class="o">-</span> <span class="n">cleaned_length</span>
            <span class="p">}</span>
        <span class="p">)</span></div>
</div>


<span class="c1"># ×™×¦×™×¨×ª ××™× ×¡×˜× ×¡ ×’×œ×•×‘×œ×™ ×©×œ ×”×œ×•×’×¨</span>
<span class="n">code_error_logger</span> <span class="o">=</span> <span class="n">CodeErrorLogger</span><span class="p">()</span>

<div class="viewcode-block" id="TimeUtils">
<a class="viewcode-back" href="../modules/index.html#utils.TimeUtils">[×ª×™×¢×•×“]</a>
<span class="k">class</span> <span class="nc">TimeUtils</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;×›×œ×™× ×œ×¢×‘×•×“×” ×¢× ×–××Ÿ ×•×ª××¨×™×›×™×&quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="TimeUtils.format_relative_time">
<a class="viewcode-back" href="../modules/index.html#utils.TimeUtils.format_relative_time">[×ª×™×¢×•×“]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">format_relative_time</span><span class="p">(</span><span class="n">dt</span><span class="p">:</span> <span class="n">datetime</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×¤×•×¨××˜ ×–××Ÿ ×™×—×¡×™ (×œ×¤× ×™ 5 ×“×§×•×ª, ××ª××•×œ ×•×›×•&#39;)&quot;&quot;&quot;</span>
        
        <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span> <span class="k">if</span> <span class="n">dt</span><span class="o">.</span><span class="n">tzinfo</span> <span class="k">else</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="n">now</span> <span class="o">-</span> <span class="n">dt</span>
        
        <span class="k">if</span> <span class="n">diff</span><span class="o">.</span><span class="n">days</span> <span class="o">&gt;</span> <span class="mi">365</span><span class="p">:</span>
            <span class="n">years</span> <span class="o">=</span> <span class="n">diff</span><span class="o">.</span><span class="n">days</span> <span class="o">//</span> <span class="mi">365</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;×œ×¤× ×™ </span><span class="si">{</span><span class="n">years</span><span class="si">}</span><span class="s2"> ×©× </span><span class="si">{</span><span class="s1">&#39;×”&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">years</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;×™×&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
        
        <span class="k">elif</span> <span class="n">diff</span><span class="o">.</span><span class="n">days</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">:</span>
            <span class="n">months</span> <span class="o">=</span> <span class="n">diff</span><span class="o">.</span><span class="n">days</span> <span class="o">//</span> <span class="mi">30</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;×œ×¤× ×™ </span><span class="si">{</span><span class="n">months</span><span class="si">}</span><span class="s2"> ×—×•×“</span><span class="si">{</span><span class="s1">&#39;×©&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">months</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;×©×™×&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
        
        <span class="k">elif</span> <span class="n">diff</span><span class="o">.</span><span class="n">days</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">:</span>
            <span class="n">weeks</span> <span class="o">=</span> <span class="n">diff</span><span class="o">.</span><span class="n">days</span> <span class="o">//</span> <span class="mi">7</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;×œ×¤× ×™ </span><span class="si">{</span><span class="n">weeks</span><span class="si">}</span><span class="s2"> ×©×‘×•×¢</span><span class="si">{</span><span class="s1">&#39;×•×ª&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">weeks</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
        
        <span class="k">elif</span> <span class="n">diff</span><span class="o">.</span><span class="n">days</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">diff</span><span class="o">.</span><span class="n">days</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot;××ª××•×œ&quot;</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;×œ×¤× ×™ </span><span class="si">{</span><span class="n">diff</span><span class="o">.</span><span class="n">days</span><span class="si">}</span><span class="s2"> ×™××™×&quot;</span>
        
        <span class="k">elif</span> <span class="n">diff</span><span class="o">.</span><span class="n">seconds</span> <span class="o">&gt;</span> <span class="mi">3600</span><span class="p">:</span>
            <span class="n">hours</span> <span class="o">=</span> <span class="n">diff</span><span class="o">.</span><span class="n">seconds</span> <span class="o">//</span> <span class="mi">3600</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;×œ×¤× ×™ </span><span class="si">{</span><span class="n">hours</span><span class="si">}</span><span class="s2"> ×©×¢</span><span class="si">{</span><span class="s1">&#39;×”&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">hours</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;×•×ª&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
        
        <span class="k">elif</span> <span class="n">diff</span><span class="o">.</span><span class="n">seconds</span> <span class="o">&gt;</span> <span class="mi">60</span><span class="p">:</span>
            <span class="n">minutes</span> <span class="o">=</span> <span class="n">diff</span><span class="o">.</span><span class="n">seconds</span> <span class="o">//</span> <span class="mi">60</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;×œ×¤× ×™ </span><span class="si">{</span><span class="n">minutes</span><span class="si">}</span><span class="s2"> ×“×§</span><span class="si">{</span><span class="s1">&#39;×”&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">minutes</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;×•×ª&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;×¢×›×©×™×•&quot;</span></div>

    
<div class="viewcode-block" id="TimeUtils.parse_date_string">
<a class="viewcode-back" href="../modules/index.html#utils.TimeUtils.parse_date_string">[×ª×™×¢×•×“]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">parse_date_string</span><span class="p">(</span><span class="n">date_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×¤×¨×¡×•×¨ ××—×¨×•×–×ª ×ª××¨×™×š ×œ××•×‘×™×™×§×˜ datetime&quot;&quot;&quot;</span>
        
        <span class="n">formats</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">/%m/%Y&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">.%m.%Y&quot;</span><span class="p">,</span>
            <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">/%m/%Y %H:%M&quot;</span><span class="p">,</span>
            <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">T%H:%M:%S&quot;</span>
        <span class="p">]</span>
        
        <span class="k">for</span> <span class="n">fmt</span> <span class="ow">in</span> <span class="n">formats</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">date_str</span><span class="p">,</span> <span class="n">fmt</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">continue</span>
        
        <span class="c1"># × ×™×¡×™×•×Ÿ ×œ×¤×¨×¡×•×¨ ×™×—×¡×™</span>
        <span class="n">date_str_lower</span> <span class="o">=</span> <span class="n">date_str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">date_str_lower</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;today&#39;</span><span class="p">,</span> <span class="s1">&#39;×”×™×•×&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">hour</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">minute</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">second</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">microsecond</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        
        <span class="k">elif</span> <span class="n">date_str_lower</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;yesterday&#39;</span><span class="p">,</span> <span class="s1">&#39;××ª××•×œ&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">hour</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">minute</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">second</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">microsecond</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        
        <span class="k">elif</span> <span class="n">date_str_lower</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;week&#39;</span><span class="p">,</span> <span class="s1">&#39;×©×‘×•×¢&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">weeks</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="k">elif</span> <span class="n">date_str_lower</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="s1">&#39;×—×•×“×©&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="kc">None</span></div>

    
<div class="viewcode-block" id="TimeUtils.get_time_ranges">
<a class="viewcode-back" href="../modules/index.html#utils.TimeUtils.get_time_ranges">[×ª×™×¢×•×“]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_time_ranges</span><span class="p">(</span><span class="n">period</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">datetime</span><span class="p">,</span> <span class="n">datetime</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×§×‘×œ×ª ×˜×•×•×— ×–×× ×™× ×œ×¤×™ ×ª×§×•×¤×”&quot;&quot;&quot;</span>
        
        <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">period</span> <span class="o">==</span> <span class="s1">&#39;today&#39;</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">now</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">hour</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">minute</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">second</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">microsecond</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="k">elif</span> <span class="n">period</span> <span class="o">==</span> <span class="s1">&#39;week&#39;</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">now</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">now</span><span class="o">.</span><span class="n">weekday</span><span class="p">())</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">start</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">hour</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">minute</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">second</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">microsecond</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">weeks</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="k">elif</span> <span class="n">period</span> <span class="o">==</span> <span class="s1">&#39;month&#39;</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">now</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">day</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">hour</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">minute</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">second</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">microsecond</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">start</span><span class="o">.</span><span class="n">month</span> <span class="o">==</span> <span class="mi">12</span><span class="p">:</span>
                <span class="n">end</span> <span class="o">=</span> <span class="n">start</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="n">start</span><span class="o">.</span><span class="n">year</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">end</span> <span class="o">=</span> <span class="n">start</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">month</span><span class="o">=</span><span class="n">start</span><span class="o">.</span><span class="n">month</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        
        <span class="k">elif</span> <span class="n">period</span> <span class="o">==</span> <span class="s1">&#39;year&#39;</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">now</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">month</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">day</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">hour</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">minute</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">second</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">microsecond</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">start</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="n">start</span><span class="o">.</span><span class="n">year</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># ×‘×¨×™×¨×ª ××—×“×œ - ×™×•× ××—×¨×•×Ÿ</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">now</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">now</span>
        
        <span class="k">return</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span></div>
</div>


<div class="viewcode-block" id="TextUtils">
<a class="viewcode-back" href="../modules/index.html#utils.TextUtils">[×ª×™×¢×•×“]</a>
<span class="k">class</span> <span class="nc">TextUtils</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;×›×œ×™× ×œ×¢×‘×•×“×” ×¢× ×˜×§×¡×˜&quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="TextUtils.truncate_text">
<a class="viewcode-back" href="../modules/index.html#utils.TextUtils.truncate_text">[×ª×™×¢×•×“]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">truncate_text</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">max_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;...&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×§×™×¦×•×¨ ×˜×§×¡×˜ ×¢× ×¡×™×•××ª&quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">max_length</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">text</span>
        
        <span class="k">return</span> <span class="n">text</span><span class="p">[:</span><span class="n">max_length</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">suffix</span><span class="p">)]</span> <span class="o">+</span> <span class="n">suffix</span></div>

    
<div class="viewcode-block" id="TextUtils.escape_markdown">
<a class="viewcode-back" href="../modules/index.html#utils.TextUtils.escape_markdown">[×ª×™×¢×•×“]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">escape_markdown</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">version</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×”×’× ×” ×¢×œ ×ª×•×•×™× ××™×•×—×“×™× ×‘-Markdown&quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">version</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c1"># Markdown V2: ×›×œ ×”×ª×•×•×™× ×©×™×© ×œ××¡×§×™×™×¤ ×œ×¤×™ Telegram MarkdownV2</span>
            <span class="n">special_chars</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="s2">&quot;_*[]()~`&gt;#+-=|</span><span class="si">{}</span><span class="s2">.!</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">ch</span><span class="p">)</span> <span class="k">if</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">special_chars</span> <span class="k">else</span> <span class="n">ch</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">text</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Markdown V1: × ×©×ª××© ×‘×§×‘×•×¦×” ××¦×•××¦××ª ××š ×’× × ×¡××Ÿ ×¡×•×’×¨×™×™× ×›×“×™ ×œ×”×™×× ×¢ ××ª×§×œ×•×ª ×›×œ×œ×™×•×ª</span>
            <span class="n">special_chars</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="s2">&quot;_*`[()</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">ch</span><span class="p">)</span> <span class="k">if</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">special_chars</span> <span class="k">else</span> <span class="n">ch</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">text</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="TextUtils.clean_filename">
<a class="viewcode-back" href="../modules/index.html#utils.TextUtils.clean_filename">[×ª×™×¢×•×“]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">clean_filename</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;× ×™×§×•×™ ×©× ×§×•×‘×¥ ××ª×•×•×™× ×œ× ×—×•×§×™×™×&quot;&quot;&quot;</span>
        
        <span class="c1"># ×”×¡×¨×ª ×ª×•×•×™× ×œ× ×—×•×§×™×™×</span>
        <span class="n">cleaned</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[&lt;&gt;:&quot;/</span><span class="se">\\</span><span class="s1">|?*]&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        
        <span class="c1"># ×”×¡×¨×ª ×¨×•×•×—×™× ××™×•×ª×¨×™×</span>
        <span class="n">cleaned</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\s+&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="n">cleaned</span><span class="p">)</span>
        
        <span class="c1"># ×”×¡×¨×ª × ×§×•×“×•×ª ××™×•×ª×¨×•×ª</span>
        <span class="n">cleaned</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\.+&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">cleaned</span><span class="p">)</span>
        
        <span class="c1"># ×”×’×‘×œ×ª ××•×¨×š</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cleaned</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
            <span class="n">name</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">cleaned</span><span class="p">)</span>
            <span class="n">cleaned</span> <span class="o">=</span> <span class="n">name</span><span class="p">[:</span><span class="mi">100</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">ext</span><span class="p">)]</span> <span class="o">+</span> <span class="n">ext</span>
        
        <span class="k">return</span> <span class="n">cleaned</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;._&#39;</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="TextUtils.extract_hashtags">
<a class="viewcode-back" href="../modules/index.html#utils.TextUtils.extract_hashtags">[×ª×™×¢×•×“]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">extract_hashtags</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×—×™×œ×•×¥ ×ª×’×™×•×ª ××˜×§×¡×˜&quot;&quot;&quot;</span>
        
        <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;#(\w+)&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="TextUtils.highlight_text">
<a class="viewcode-back" href="../modules/index.html#utils.TextUtils.highlight_text">[×ª×™×¢×•×“]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">highlight_text</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;**&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×”×“×’×©×ª ××™×œ×•×ª ×—×™×¤×•×© ×‘×˜×§×¡×˜&quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">query</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">text</span>
        
        <span class="c1"># ×”×“×’×©×” ×‘×œ×™ ×ª×œ×•×ª ×‘×¨×™×©×™×•×ª</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="n">query</span><span class="p">),</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pattern</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tag</span><span class="si">}</span><span class="se">\\</span><span class="s2">g&lt;0&gt;</span><span class="si">{</span><span class="n">tag</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="TextUtils.format_file_size">
<a class="viewcode-back" href="../modules/index.html#utils.TextUtils.format_file_size">[×ª×™×¢×•×“]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">format_file_size</span><span class="p">(</span><span class="n">size_bytes</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×¤×•×¨××˜ ×’×•×“×œ ×§×•×‘×¥ (bytes -&gt; KB/MB/GB)&quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">size_bytes</span> <span class="o">&lt;</span> <span class="mi">1024</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">size_bytes</span><span class="si">}</span><span class="s2"> B&quot;</span>
        
        <span class="k">elif</span> <span class="n">size_bytes</span> <span class="o">&lt;</span> <span class="mi">1024</span> <span class="o">**</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">size_bytes</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1024</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> KB&quot;</span>
        
        <span class="k">elif</span> <span class="n">size_bytes</span> <span class="o">&lt;</span> <span class="mi">1024</span> <span class="o">**</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">size_bytes</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">1024</span><span class="w"> </span><span class="o">**</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> MB&quot;</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">size_bytes</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">1024</span><span class="w"> </span><span class="o">**</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> GB&quot;</span></div>

    
<div class="viewcode-block" id="TextUtils.pluralize_hebrew">
<a class="viewcode-back" href="../modules/index.html#utils.TextUtils.pluralize_hebrew">[×ª×™×¢×•×“]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">pluralize_hebrew</span><span class="p">(</span><span class="n">count</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">singular</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">plural</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×¦×•×¨×ª ×¨×‘×™× ×¢×‘×¨×™×•×ª&quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">singular</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">elif</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;2 </span><span class="si">{</span><span class="n">plural</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">plural</span><span class="si">}</span><span class="s2">&quot;</span></div>
</div>


<div class="viewcode-block" id="SecurityUtils">
<a class="viewcode-back" href="../modules/index.html#utils.SecurityUtils">[×ª×™×¢×•×“]</a>
<span class="k">class</span> <span class="nc">SecurityUtils</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;×›×œ×™× ×××™× ×•×ª ×•×‘×˜×™×—×•×ª&quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="SecurityUtils.generate_secure_token">
<a class="viewcode-back" href="../modules/index.html#utils.SecurityUtils.generate_secure_token">[×ª×™×¢×•×“]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">generate_secure_token</span><span class="p">(</span><span class="n">length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×™×¦×™×¨×ª ×˜×•×§×Ÿ ×××•×‘×˜×—&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">secrets</span><span class="o">.</span><span class="n">token_urlsafe</span><span class="p">(</span><span class="n">length</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="SecurityUtils.hash_content">
<a class="viewcode-back" href="../modules/index.html#utils.SecurityUtils.hash_content">[×ª×™×¢×•×“]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">hash_content</span><span class="p">(</span><span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">algorithm</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;sha256&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×™×¦×™×¨×ª hash ×œ×ª×•×›×Ÿ&quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">algorithm</span> <span class="o">==</span> <span class="s1">&#39;md5&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">content</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">algorithm</span> <span class="o">==</span> <span class="s1">&#39;sha1&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">(</span><span class="n">content</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">algorithm</span> <span class="o">==</span> <span class="s1">&#39;sha256&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">content</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;××œ×’×•×¨×™×ª× ×œ× × ×ª××š: </span><span class="si">{</span><span class="n">algorithm</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="SecurityUtils.validate_user_input">
<a class="viewcode-back" href="../modules/index.html#utils.SecurityUtils.validate_user_input">[×ª×™×¢×•×“]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">validate_user_input</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">max_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> 
                           <span class="n">forbidden_patterns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×‘×“×™×§×ª ×§×œ×˜ ××©×ª××©&quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_length</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        
        <span class="k">if</span> <span class="n">forbidden_patterns</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">forbidden_patterns</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">):</span>
                    <span class="k">return</span> <span class="kc">False</span>
        
        <span class="k">return</span> <span class="kc">True</span></div>

    
<div class="viewcode-block" id="SecurityUtils.sanitize_code">
<a class="viewcode-back" href="../modules/index.html#utils.SecurityUtils.sanitize_code">[×ª×™×¢×•×“]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">sanitize_code</span><span class="p">(</span><span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;× ×™×§×•×™ ×§×•×“ ××ª×•×›×Ÿ ××¡×•×›×Ÿ (×‘×¡×™×¡×™)&quot;&quot;&quot;</span>
        
        <span class="c1"># ×“×¤×•×¡×™ ×§×•×“ ××¡×•×›× ×™× ×‘×¡×™×¡×™×™×</span>
        <span class="n">dangerous_patterns</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">r</span><span class="s1">&#39;exec\s*\(&#39;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s1">&#39;eval\s*\(&#39;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s1">&#39;__import__\s*\(&#39;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s1">&#39;open\s*\(&#39;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s1">&#39;file\s*\(&#39;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s1">&#39;input\s*\(&#39;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s1">&#39;raw_input\s*\(&#39;</span><span class="p">,</span>
        <span class="p">]</span>
        
        <span class="c1"># ×”×—×œ×¤×ª ×“×¤×•×¡×™× ××¡×•×›× ×™×</span>
        <span class="n">cleaned</span> <span class="o">=</span> <span class="n">code</span>
        <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">dangerous_patterns</span><span class="p">:</span>
            <span class="n">cleaned</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="s1">&#39;[REMOVED]&#39;</span><span class="p">,</span> <span class="n">cleaned</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">cleaned</span></div>
</div>


<div class="viewcode-block" id="TelegramUtils">
<a class="viewcode-back" href="../modules/index.html#utils.TelegramUtils">[×ª×™×¢×•×“]</a>
<span class="k">class</span> <span class="nc">TelegramUtils</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;×›×œ×™× ×œ×¢×‘×•×“×” ×¢× Telegram&quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="TelegramUtils.send_typing_action">
<a class="viewcode-back" href="../modules/index.html#utils.TelegramUtils.send_typing_action">[×ª×™×¢×•×“]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">send_typing_action</span><span class="p">(</span><span class="n">update</span><span class="p">:</span> <span class="n">Update</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">ContextTypes</span><span class="o">.</span><span class="n">DEFAULT_TYPE</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×©×œ×™×—×ª ××§×©×Ÿ &#39;×›×•×ª×‘...&#39;&quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="n">context</span><span class="o">.</span><span class="n">bot</span><span class="o">.</span><span class="n">send_chat_action</span><span class="p">(</span>
            <span class="n">chat_id</span><span class="o">=</span><span class="n">update</span><span class="o">.</span><span class="n">effective_chat</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="n">action</span><span class="o">=</span><span class="n">ChatAction</span><span class="o">.</span><span class="n">TYPING</span>
        <span class="p">)</span></div>

    
<div class="viewcode-block" id="TelegramUtils.send_document_action">
<a class="viewcode-back" href="../modules/index.html#utils.TelegramUtils.send_document_action">[×ª×™×¢×•×“]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">send_document_action</span><span class="p">(</span><span class="n">update</span><span class="p">:</span> <span class="n">Update</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">ContextTypes</span><span class="o">.</span><span class="n">DEFAULT_TYPE</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×©×œ×™×—×ª ××§×©×Ÿ &#39;×©×•×œ×— ××¡××š...&#39;&quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="n">context</span><span class="o">.</span><span class="n">bot</span><span class="o">.</span><span class="n">send_chat_action</span><span class="p">(</span>
            <span class="n">chat_id</span><span class="o">=</span><span class="n">update</span><span class="o">.</span><span class="n">effective_chat</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="n">action</span><span class="o">=</span><span class="n">ChatAction</span><span class="o">.</span><span class="n">UPLOAD_DOCUMENT</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="TelegramUtils.safe_answer">
<a class="viewcode-back" href="../modules/index.html#utils.TelegramUtils.safe_answer">[×ª×™×¢×•×“]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">safe_answer</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">show_alert</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">cache_time</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;××¢× ×” ×‘×˜×•×— ×œ-CallbackQuery: ××ª×¢×œ× ××©×’×™××•×ª &#39;Query is too old&#39;/&#39;query_id_invalid&#39;.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">if</span> <span class="n">text</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">text</span>
            <span class="k">if</span> <span class="n">show_alert</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;show_alert&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">cache_time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;cache_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">cache_time</span><span class="p">)</span>
            <span class="k">await</span> <span class="n">query</span><span class="o">.</span><span class="n">answer</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">if</span> <span class="s2">&quot;query is too old&quot;</span> <span class="ow">in</span> <span class="n">msg</span> <span class="ow">or</span> <span class="s2">&quot;query_id_invalid&quot;</span> <span class="ow">in</span> <span class="n">msg</span> <span class="ow">or</span> <span class="s2">&quot;message to edit not found&quot;</span> <span class="ow">in</span> <span class="n">msg</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="k">raise</span></div>

    
<div class="viewcode-block" id="TelegramUtils.get_user_mention">
<a class="viewcode-back" href="../modules/index.html#utils.TelegramUtils.get_user_mention">[×ª×™×¢×•×“]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_user_mention</span><span class="p">(</span><span class="n">user</span><span class="p">:</span> <span class="n">User</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×§×‘×œ×ª ×× ×©×Ÿ ×œ××©×ª××©&quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">user</span><span class="o">.</span><span class="n">username</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;@</span><span class="si">{</span><span class="n">user</span><span class="o">.</span><span class="n">username</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">user</span><span class="o">.</span><span class="n">first_name</span><span class="si">}</span><span class="s2">](tg://user?id=</span><span class="si">{</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">)&quot;</span></div>

    
<div class="viewcode-block" id="TelegramUtils.split_long_message">
<a class="viewcode-back" href="../modules/index.html#utils.TelegramUtils.split_long_message">[×ª×™×¢×•×“]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">split_long_message</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">max_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4096</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×—×œ×•×§×ª ×”×•×“×¢×” ××¨×•×›×” ×œ×—×œ×§×™×&quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">max_length</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">text</span><span class="p">]</span>
        
        <span class="n">parts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">current_part</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">current_part</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">max_length</span><span class="p">:</span>
                <span class="n">current_part</span> <span class="o">+=</span> <span class="n">line</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">current_part</span><span class="p">:</span>
                    <span class="n">parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_part</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
                <span class="n">current_part</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        
        <span class="k">if</span> <span class="n">current_part</span><span class="p">:</span>
            <span class="n">parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_part</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
        
        <span class="k">return</span> <span class="n">parts</span></div>


<div class="viewcode-block" id="TelegramUtils.safe_edit_message_text">
<a class="viewcode-back" href="../modules/index.html#utils.TelegramUtils.safe_edit_message_text">[×ª×™×¢×•×“]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">safe_edit_message_text</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">reply_markup</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parse_mode</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×¢×¨×™×›×ª ×˜×§×¡×˜ ×”×•×“×¢×” ×‘×‘×˜×™×—×•×ª: ××ª×¢×œ× ××©×’×™××ª &#39;Message is not modified&#39;.</span>

<span class="sd">        ×ª×•××š ×’× ×‘××™××•×©×™ ×‘×“×™×§×•×ª ×©×‘×”× `edit_message_text` ×”×™× ×¤×•× ×§×¦×™×” ×¡×™× ×›×¨×•× ×™×ª</span>
<span class="sd">        ×©××—×–×™×¨×” `None` (×œ× awaitable), ×•×’× ×‘××™××•×©×™× ××¡×™× ×›×¨×•× ×™×™× ×¨×’×™×œ×™×.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">edit_func</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="s2">&quot;edit_message_text&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="n">edit_func</span><span class="p">):</span>
                <span class="k">return</span>

            <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="n">text</span><span class="p">,</span> <span class="s2">&quot;reply_markup&quot;</span><span class="p">:</span> <span class="n">reply_markup</span><span class="p">}</span>
            <span class="k">if</span> <span class="n">parse_mode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;parse_mode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parse_mode</span>

            <span class="n">result</span> <span class="o">=</span> <span class="n">edit_func</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="c1"># ×× ×—×–×¨ coroutine â€“ ×¦×¨×™×š ×œ×”××ª×™×Ÿ; ××—×¨×ª ×–×• ×¤×•× ×§×¦×™×” ×¡×™× ×›×¨×•× ×™×ª ×•××™×Ÿ ××” ×œ×”××ª×™×Ÿ</span>
            <span class="k">if</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">iscoroutine</span><span class="p">(</span><span class="n">result</span><span class="p">):</span>
                <span class="k">await</span> <span class="n">result</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="c1"># ×”×ª×¢×œ××•×ª ×¨×§ ×‘××§×¨×” &quot;not modified&quot; (×¢××™×“ ×œ×©×™× ×•×™×™× ×§×œ×™× ×‘×˜×§×¡×˜)</span>
            <span class="k">if</span> <span class="s2">&quot;not modified&quot;</span> <span class="ow">in</span> <span class="n">msg</span> <span class="ow">or</span> <span class="s2">&quot;message is not modified&quot;</span> <span class="ow">in</span> <span class="n">msg</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="k">raise</span></div>


<div class="viewcode-block" id="TelegramUtils.safe_edit_message_reply_markup">
<a class="viewcode-back" href="../modules/index.html#utils.TelegramUtils.safe_edit_message_reply_markup">[×ª×™×¢×•×“]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">safe_edit_message_reply_markup</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">reply_markup</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×¢×¨×™×›×ª ××§×œ×“×ª ×”×•×“×¢×” ×‘×‘×˜×™×—×•×ª: ××ª×¢×œ× ××©×’×™××ª &#39;Message is not modified&#39;.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">query</span><span class="o">.</span><span class="n">edit_message_reply_markup</span><span class="p">(</span><span class="n">reply_markup</span><span class="o">=</span><span class="n">reply_markup</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">if</span> <span class="s2">&quot;not modified&quot;</span> <span class="ow">in</span> <span class="n">msg</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="k">raise</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">if</span> <span class="s2">&quot;not modified&quot;</span> <span class="ow">in</span> <span class="n">msg</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="k">raise</span></div>


<div class="viewcode-block" id="TelegramUtils.extract_message_text_preserve_markdown">
<a class="viewcode-back" href="../modules/index.html#utils.TelegramUtils.extract_message_text_preserve_markdown">[×ª×™×¢×•×“]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">extract_message_text_preserve_markdown</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="s2">&quot;Message&quot;</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">reconstruct_from_entities</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ×©×—×–×•×¨ ×˜×§×¡×˜ ×”×”×•×“×¢×” ×ª×•×š × ×™×¡×™×•×Ÿ ×œ×”×—×–×™×¨ ××ª ××” ×©×”××©×ª××© ×”×ª×›×•×•×Ÿ ××‘×—×™× ×ª ×ª×•×•×™ Markdown.</span>

<span class="sd">        ×¢×§×¨×•× ×•×ª:</span>

<span class="sd">        - ×‘×¨×™×¨×ª ××—×“×œ: × ×©×ª××© ×‘-``text``/``caption`` (×”×ª×•×›×Ÿ ×”×’×•×œ××™ ×›×¤×™ ×©× ×©×œ×— ×œ×©×¨×ª ×œ××—×¨ ×¢×™×‘×•×“ Markdown).</span>
<span class="sd">          ×–××ª ×›×“×™ ×œ× ×œ×©××•×¨ ××—×¨×•×–×ª &quot;××¨×•× ×“×¨×ª&quot; (×œ××©×œ ``*_name_*``), ×©××™× ×” ××©×§×¤×ª ×§×œ×˜ ××©×ª××©.</span>

<span class="sd">        - ×‘××™×“×” ×•-``reconstruct_from_entities=True`` ×•×™×© ×™×©×•×™×•×ª ×¢×™×¦×•×‘ (``bold``/``italic``), × × ×¡×” ×œ×©×—×–×¨</span>
<span class="sd">          ×ª×•×•×™ Markdown ×©×”×™×•×• ×›× ×¨××” ××ª ××§×•×¨ ×”×¢×™×¦×•×‘ ×¢&quot;×™ ×”×•×¡×¤×ª ×ª×—×™×œ×™×•×ª/×¡×™×•××•×ª ×¡×‘×™×‘ ×”×˜×§×¡×˜ ×©×¡×•××Ÿ.</span>
<span class="sd">          ××™×¤×•×™ ×¤×©×•×˜: ``bold`` â†’ ``&quot;__&quot;``, ``italic`` â†’ ``&quot;_&quot;``. ×©××¨ ×™×©×•×™×•×ª × ×©××¨×•×ª ×›×¤×™ ×©×”×Ÿ.</span>

<span class="sd">        - ×× ×™×© ×›×™×ª×•×‘ (caption), × ×©×ª××© ×‘××§×‘×™×œ×•×ª ``caption_entities``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># 1) ×ª×•×›×Ÿ ×‘×¡×™×¡×™</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">base</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="s2">&quot;caption&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">base</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">reconstruct_from_entities</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">base</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">base</span>

        <span class="c1"># 2) ×©×—×–×•×¨ ×¡×™××•× ×™× ×¢×œ ×‘×¡×™×¡ entities (×× ×§×™×™××™×)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">entities</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="s2">&quot;entities&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">base</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">entities</span><span class="p">:</span>
                <span class="n">entities</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="s2">&quot;caption_entities&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">entities</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">entities</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">base</span>

            <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">base</span><span class="p">)</span>
            <span class="n">opens</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)}</span>
            <span class="n">closes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)}</span>

            <span class="c1"># ×¨×™×©×•× ×™×©×•×™×•×ª ×‘×¡×™×¡×™</span>
            <span class="n">ent_ranges</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">entities</span> <span class="ow">or</span> <span class="p">[]:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">etype</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ent</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span>
                    <span class="n">offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">ent</span><span class="p">,</span> <span class="s2">&quot;offset&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="n">ent_len</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">ent</span><span class="p">,</span> <span class="s2">&quot;length&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="c1"># ×—×©×‘ ×˜×•×•×— ××§×•×¨×™</span>
                    <span class="n">start_raw</span> <span class="o">=</span> <span class="n">offset</span>
                    <span class="n">end_raw</span> <span class="o">=</span> <span class="n">offset</span> <span class="o">+</span> <span class="n">ent_len</span>
                    <span class="c1"># ×§×œ××¤×™× ×’ ×¨××©×•× ×™</span>
                    <span class="n">start</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">start_raw</span><span class="p">))</span>
                    <span class="n">end</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">end_raw</span><span class="p">))</span>
                    <span class="c1"># ×× offset ×©×œ×™×œ×™ ×’×¨× ×œ×›×š ×©-end==start, ×”×¨×—×‘ ×œ×¤×™ ×”××•×¨×š ×”××‘×•×§×©</span>
                    <span class="k">if</span> <span class="n">start_raw</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">ent_len</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">end</span> <span class="o">&lt;=</span> <span class="n">start</span><span class="p">:</span>
                        <span class="n">end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">start</span> <span class="o">+</span> <span class="n">ent_len</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="c1"># ×”×ª×¢×œ× ×-entities ×¨×™×§×™×/××—×•×¥ ×œ×ª×—×•× ×œ××—×¨ ×§×œ××¤×™× ×’</span>
                <span class="k">if</span> <span class="n">end</span> <span class="o">&lt;=</span> <span class="n">start</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="n">ent_ranges</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">etype</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">))</span>

            <span class="c1"># ×–×™×”×•×™ ×—×¤×™×¤×” ××œ××” ×‘×™×Ÿ bold ×•-italic ×¢×œ ××•×ª×• ×˜×•×•×—</span>
            <span class="n">bold_set</span> <span class="o">=</span> <span class="p">{(</span><span class="n">s</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">ent_ranges</span> <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;bold&quot;</span><span class="p">}</span>
            <span class="n">italic_set</span> <span class="o">=</span> <span class="p">{(</span><span class="n">s</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">ent_ranges</span> <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="s2">&quot;italic&quot;</span><span class="p">}</span>
            <span class="n">both_set</span> <span class="o">=</span> <span class="n">bold_set</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">italic_set</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">etype</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">ent_ranges</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span> <span class="ow">in</span> <span class="n">both_set</span><span class="p">:</span>
                    <span class="c1"># ×¤×ª×™×—×”/×¡×’×™×¨×” ××©×•×œ×©×ª ×¤×¢× ××—×ª ×‘×œ×‘×“</span>
                    <span class="k">if</span> <span class="n">opens</span><span class="p">[</span><span class="n">start</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span> <span class="o">!=</span> <span class="p">[</span><span class="s2">&quot;___&quot;</span><span class="p">]:</span>
                        <span class="n">opens</span><span class="p">[</span><span class="n">start</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;___&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">closes</span><span class="p">[</span><span class="n">end</span><span class="p">][:</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="p">[</span><span class="s2">&quot;___&quot;</span><span class="p">]:</span>
                        <span class="n">closes</span><span class="p">[</span><span class="n">end</span><span class="p">]</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;___&quot;</span><span class="p">)</span>
                    <span class="k">continue</span>

                <span class="k">if</span> <span class="n">etype</span> <span class="o">==</span> <span class="s2">&quot;bold&quot;</span><span class="p">:</span>
                    <span class="n">opens</span><span class="p">[</span><span class="n">start</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;__&quot;</span><span class="p">)</span>
                    <span class="n">closes</span><span class="p">[</span><span class="n">end</span><span class="p">]</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;__&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">etype</span> <span class="o">==</span> <span class="s2">&quot;italic&quot;</span><span class="p">:</span>
                    <span class="n">opens</span><span class="p">[</span><span class="n">start</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
                    <span class="n">closes</span><span class="p">[</span><span class="n">end</span><span class="p">]</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># ×™×©×•×™×•×ª ××—×¨×•×ª ××™× ×Ÿ ××©×•×—×–×¨×•×ª ×›×¡×™×× ×™ Markdown</span>
                    <span class="k">continue</span>

            <span class="n">out_parts</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">base</span><span class="p">):</span>
                <span class="c1"># ×”×•×¡×£ ×¡×’×™×¨×•×ª ×©××¡×ª×™×™××•×ª ×œ×¤× ×™ ×”×ª×•</span>
                <span class="k">if</span> <span class="n">closes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
                    <span class="n">out_parts</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">closes</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="c1"># ×”×•×¡×£ ×¤×ª×™×—×•×ª ×©××ª×—×™×œ×•×ª ×œ×¤× ×™ ×”×ª×•</span>
                <span class="k">if</span> <span class="n">opens</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
                    <span class="n">out_parts</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">opens</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">out_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>

            <span class="c1"># ×¡×’×™×¨×•×ª ×‘×¡×•×£ ×”×˜×§×¡×˜</span>
            <span class="k">if</span> <span class="n">closes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
                <span class="n">out_parts</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">closes</span><span class="p">[</span><span class="n">length</span><span class="p">])</span>

            <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_parts</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">base</span></div>
</div>


<div class="viewcode-block" id="CallbackQueryGuard">
<a class="viewcode-back" href="../modules/index.html#utils.CallbackQueryGuard">[×ª×™×¢×•×“]</a>
<span class="k">class</span> <span class="nc">CallbackQueryGuard</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Guard ×’×•×¨×£ ×œ×œ×—×™×¦×•×ª ×›×¤×•×œ×•×ª ×¢×œ ×›×¤×ª×•×¨×™ CallbackQuery.</span>

<span class="sd">    ××‘×•×¡×¡ ×¢×œ ×˜×‘×™×¢×ª ××¦×‘×¢ ×©×œ ×”××©×ª××©/×”×•×“×¢×”/×”× ×ª×•×Ÿ (callback_data) ×›×“×™ ×œ×—×¡×•×</span>
<span class="sd">    ××ª ××•×ª×” ×¤×¢×•×œ×” ×‘×—×œ×•×Ÿ ×–××Ÿ ×§×¦×¨, ×‘×œ×™ ×œ×—×¡×•× ×¤×¢×•×œ×•×ª ×©×•× ×•×ª.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">DEFAULT_WINDOW_SECONDS</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.2</span>
    <span class="c1"># × ×¢×™×œ×•×ª ×¤×¨-××©×ª××© ×›×“×™ ×œ×× ×•×¢ ××¨×•×¥ ×‘×™×Ÿ ×œ×—×™×¦×•×ª ××§×‘×™×œ×•×ª ×©×œ ××•×ª×• ××©×ª××©</span>
    <span class="n">_user_locks</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_fingerprint</span><span class="p">(</span><span class="n">update</span><span class="p">:</span> <span class="n">Update</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">q</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">update</span><span class="p">,</span> <span class="s2">&quot;callback_query&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">user_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">update</span><span class="o">.</span><span class="n">effective_user</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">chat_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">update</span><span class="o">.</span><span class="n">effective_chat</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">msg_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="s2">&quot;message&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="s2">&quot;message_id&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">chat_id</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">msg_id</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;unknown&quot;</span>

<div class="viewcode-block" id="CallbackQueryGuard.should_block">
<a class="viewcode-back" href="../modules/index.html#utils.CallbackQueryGuard.should_block">[×ª×™×¢×•×“]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">should_block</span><span class="p">(</span><span class="n">update</span><span class="p">:</span> <span class="n">Update</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">ContextTypes</span><span class="o">.</span><span class="n">DEFAULT_TYPE</span><span class="p">,</span> <span class="n">window_seconds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×‘×•×“×§ ×”×× ×™×© ×œ×—×¡×•× ××ª ×”×¢×“×›×•×Ÿ ×›×œ×—×™×¦×” ×›×¤×•×œ×”.</span>

<span class="sd">        ×× ×–×• ××•×ª×” ×˜×‘×™×¢×ª ××¦×‘×¢ ×‘×ª×•×š ×—×œ×•×Ÿ ×”×–××Ÿ â€“ × ×—×¡×•×; ××—×¨×ª × ×¡××Ÿ ×•× ××¤×©×¨.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">win</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">window_seconds</span> <span class="k">if</span> <span class="n">window_seconds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">CallbackQueryGuard</span><span class="o">.</span><span class="n">DEFAULT_WINDOW_SECONDS</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">win</span> <span class="o">=</span> <span class="n">CallbackQueryGuard</span><span class="o">.</span><span class="n">DEFAULT_WINDOW_SECONDS</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">fp</span> <span class="o">=</span> <span class="n">CallbackQueryGuard</span><span class="o">.</span><span class="n">_fingerprint</span><span class="p">(</span><span class="n">update</span><span class="p">)</span>
            <span class="n">now_ts</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="n">last_fp</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">user_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;_last_cb_fp&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="s2">&quot;user_data&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="n">busy_until</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">user_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;_cb_guard_until&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span> <span class="ow">or</span> <span class="mf">0.0</span><span class="p">)</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="s2">&quot;user_data&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="mf">0.0</span>

            <span class="k">if</span> <span class="n">last_fp</span> <span class="o">==</span> <span class="n">fp</span> <span class="ow">and</span> <span class="n">now_ts</span> <span class="o">&lt;</span> <span class="n">busy_until</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>

            <span class="c1"># ×¡×× ×• ××ª ×”×¤×¢×•×œ×” ×”× ×•×›×—×™×ª ×œ×—×œ×•×Ÿ ×§×¦×¨</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="s2">&quot;user_data&quot;</span><span class="p">):</span>
                <span class="n">context</span><span class="o">.</span><span class="n">user_data</span><span class="p">[</span><span class="s2">&quot;_last_cb_fp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fp</span>
                <span class="n">context</span><span class="o">.</span><span class="n">user_data</span><span class="p">[</span><span class="s2">&quot;_cb_guard_until&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now_ts</span> <span class="o">+</span> <span class="n">win</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="c1"># ××œ ×ª×—×¡×•× ×× guard × ×›×©×œ</span>
            <span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="CallbackQueryGuard.should_block_async">
<a class="viewcode-back" href="../modules/index.html#utils.CallbackQueryGuard.should_block_async">[×ª×™×¢×•×“]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">should_block_async</span><span class="p">(</span><span class="n">update</span><span class="p">:</span> <span class="n">Update</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">ContextTypes</span><span class="o">.</span><span class="n">DEFAULT_TYPE</span><span class="p">,</span> <span class="n">window_seconds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×‘×•×“×§ ×‘×¦×•×¨×” ××˜×•××™×ª (×¢× × ×¢×™×œ×”) ×× ×œ×—×¡×•× ×œ×—×™×¦×” ×›×¤×•×œ×” ×©×œ ××•×ª×• ××©×ª××©.</span>

<span class="sd">        ×—×¡×™××” ××‘×•×¡×¡×ª ×—×œ×•×Ÿ ×–××Ÿ ×¤×¨-××©×ª××©, ×œ×œ× ×ª×œ×•×ª ×‘-message_id/data, ×›×“×™ ×œ×× ×•×¢ ××¨×•×¥.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">win</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">window_seconds</span> <span class="k">if</span> <span class="n">window_seconds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">CallbackQueryGuard</span><span class="o">.</span><span class="n">DEFAULT_WINDOW_SECONDS</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="n">win</span> <span class="o">=</span> <span class="n">CallbackQueryGuard</span><span class="o">.</span><span class="n">DEFAULT_WINDOW_SECONDS</span>

            <span class="n">user_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">update</span><span class="p">,</span> <span class="s1">&#39;effective_user&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span>

            <span class="c1"># ×× ××™×Ÿ ×–×™×”×•×™ ××©×ª××©, fallback ×œ×”×ª× ×”×’×•×ª ×”×™×©× ×” ×œ×œ× ×—×¡×™××”</span>
            <span class="k">if</span> <span class="n">user_id</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">CallbackQueryGuard</span><span class="o">.</span><span class="n">should_block</span><span class="p">(</span><span class="n">update</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">window_seconds</span><span class="o">=</span><span class="n">win</span><span class="p">)</span>

            <span class="c1"># ×§×‘×œ/×¦×•×¨ × ×¢×™×œ×” ×œ××©×ª××©</span>
            <span class="n">lock</span> <span class="o">=</span> <span class="n">CallbackQueryGuard</span><span class="o">.</span><span class="n">_user_locks</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">lock</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">lock</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
                <span class="n">CallbackQueryGuard</span><span class="o">.</span><span class="n">_user_locks</span><span class="p">[</span><span class="n">user_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">lock</span>

            <span class="k">async</span> <span class="k">with</span> <span class="n">lock</span><span class="p">:</span>
                <span class="n">now_ts</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
                <span class="c1"># ×”×©×ª××© ×‘××•×ª×• ×©×“×” ×–××Ÿ ×’×œ×•×‘×œ×™ ×©×”×™×” ×‘×©×™××•×©, ××š ×œ×œ× ×˜×‘×™×¢×ª ××¦×‘×¢</span>
                <span class="n">busy_until</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">user_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;_cb_guard_until&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span> <span class="ow">or</span> <span class="mf">0.0</span><span class="p">)</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="s2">&quot;user_data&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="mf">0.0</span>
                <span class="k">if</span> <span class="n">now_ts</span> <span class="o">&lt;</span> <span class="n">busy_until</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">True</span>
                <span class="c1"># ×¡×× ×• ×—×œ×•×Ÿ ×–××Ÿ ×—×¡×™××” ×—×“×©</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="s2">&quot;user_data&quot;</span><span class="p">):</span>
                    <span class="n">context</span><span class="o">.</span><span class="n">user_data</span><span class="p">[</span><span class="s2">&quot;_cb_guard_until&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">now_ts</span> <span class="o">+</span> <span class="n">win</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="c1"># ××œ ×ª×—×¡×•× ×× guard × ×›×©×œ</span>
            <span class="k">return</span> <span class="kc">False</span></div>
</div>


<div class="viewcode-block" id="AsyncUtils">
<a class="viewcode-back" href="../modules/index.html#utils.AsyncUtils">[×ª×™×¢×•×“]</a>
<span class="k">class</span> <span class="nc">AsyncUtils</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;×›×œ×™× ×œ×¢×‘×•×“×” ××¡×™× ×›×¨×•× ×™×ª&quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="AsyncUtils.run_with_timeout">
<a class="viewcode-back" href="../modules/index.html#utils.AsyncUtils.run_with_timeout">[×ª×™×¢×•×“]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">run_with_timeout</span><span class="p">(</span><span class="n">coro</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">30.0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×”×¨×¦×ª ×¤×•× ×§×¦×™×” ××¡×™× ×›×¨×•× ×™×ª ×¢× timeout&quot;&quot;&quot;</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span><span class="n">coro</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">TimeoutError</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;×¤×¢×•×œ×” ×”×•×¤×¡×§×” ×¢×§×‘ timeout (</span><span class="si">{</span><span class="n">timeout</span><span class="si">}</span><span class="s2">s)&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span></div>

    
<div class="viewcode-block" id="AsyncUtils.batch_process">
<a class="viewcode-back" href="../modules/index.html#utils.AsyncUtils.batch_process">[×ª×™×¢×•×“]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">batch_process</span><span class="p">(</span><span class="n">items</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">process_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> 
                           <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">delay</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×¢×™×‘×•×“ ×¤×¨×™×˜×™× ×‘×§×‘×•×¦×•×ª&quot;&quot;&quot;</span>
        
        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">),</span> <span class="n">batch_size</span><span class="p">):</span>
            <span class="n">batch</span> <span class="o">=</span> <span class="n">items</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">batch_size</span><span class="p">]</span>
            
            <span class="c1"># ×¢×™×‘×•×“ ×”×§×‘×•×¦×”</span>
            <span class="n">batch_tasks</span> <span class="o">=</span> <span class="p">[</span><span class="n">process_func</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">batch</span><span class="p">]</span>
            <span class="n">batch_results</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="n">batch_tasks</span><span class="p">,</span> <span class="n">return_exceptions</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            
            <span class="n">results</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">batch_results</span><span class="p">)</span>
            
            <span class="c1"># ×”××ª× ×” ×‘×™×Ÿ ×§×‘×•×¦×•×ª</span>
            <span class="k">if</span> <span class="n">delay</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">+</span> <span class="n">batch_size</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">):</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">results</span></div>
</div>


<div class="viewcode-block" id="PerformanceUtils">
<a class="viewcode-back" href="../modules/index.html#utils.PerformanceUtils">[×ª×™×¢×•×“]</a>
<span class="k">class</span> <span class="nc">PerformanceUtils</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;×›×œ×™× ×œ××“×™×“×ª ×‘×™×¦×•×¢×™×&quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="PerformanceUtils.timing_decorator">
<a class="viewcode-back" href="../modules/index.html#utils.PerformanceUtils.timing_decorator">[×ª×™×¢×•×“]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">timing_decorator</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×“×§×•×¨×˜×•×¨ ×œ××“×™×“×ª ×–××Ÿ ×‘×™×¦×•×¢&quot;&quot;&quot;</span>
        
        <span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="k">async</span> <span class="k">def</span> <span class="nf">async_wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="n">execution_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> ×”×¡×ª×™×™× ×ª×•×š </span><span class="si">{</span><span class="n">execution_time</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">result</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">execution_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> × ×›×©×œ ×ª×•×š </span><span class="si">{</span><span class="n">execution_time</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">s: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">raise</span>
        
        <span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">sync_wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="n">execution_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> ×”×¡×ª×™×™× ×ª×•×š </span><span class="si">{</span><span class="n">execution_time</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">result</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">execution_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> × ×›×©×œ ×ª×•×š </span><span class="si">{</span><span class="n">execution_time</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">s: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">raise</span>
        
        <span class="k">if</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">iscoroutinefunction</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">async_wrapper</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">sync_wrapper</span></div>

    
<div class="viewcode-block" id="PerformanceUtils.measure_time">
<a class="viewcode-back" href="../modules/index.html#utils.PerformanceUtils.measure_time">[×ª×™×¢×•×“]</a>
    <span class="nd">@staticmethod</span>
    <span class="nd">@contextmanager</span>
    <span class="k">def</span> <span class="nf">measure_time</span><span class="p">(</span><span class="n">operation_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;××“×™×“×ª ×–××Ÿ ×¢× context manager&quot;&quot;&quot;</span>
        
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">yield</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">execution_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">execution_time</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span></div>
</div>


<div class="viewcode-block" id="ValidationUtils">
<a class="viewcode-back" href="../modules/index.html#utils.ValidationUtils">[×ª×™×¢×•×“]</a>
<span class="k">class</span> <span class="nc">ValidationUtils</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;×›×œ×™× ×œ×•×•×œ×™×“×¦×™×”&quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="ValidationUtils.is_valid_filename">
<a class="viewcode-back" href="../modules/index.html#utils.ValidationUtils.is_valid_filename">[×ª×™×¢×•×“]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">is_valid_filename</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×‘×“×™×§×ª ×ª×§×™× ×•×ª ×©× ×§×•×‘×¥&quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">filename</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">255</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        
        <span class="c1"># ×ª×•×•×™× ×œ× ×—×•×§×™×™×</span>
        <span class="n">invalid_chars</span> <span class="o">=</span> <span class="s1">&#39;&lt;&gt;:&quot;/</span><span class="se">\\</span><span class="s1">|?*&#39;</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">char</span> <span class="ow">in</span> <span class="n">filename</span> <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">invalid_chars</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        
        <span class="c1"># ×©××•×ª ×©××•×¨×™× ×‘-Windows</span>
        <span class="n">reserved_names</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;CON&#39;</span><span class="p">,</span> <span class="s1">&#39;PRN&#39;</span><span class="p">,</span> <span class="s1">&#39;AUX&#39;</span><span class="p">,</span> <span class="s1">&#39;NUL&#39;</span><span class="p">,</span>
            <span class="s1">&#39;COM1&#39;</span><span class="p">,</span> <span class="s1">&#39;COM2&#39;</span><span class="p">,</span> <span class="s1">&#39;COM3&#39;</span><span class="p">,</span> <span class="s1">&#39;COM4&#39;</span><span class="p">,</span> <span class="s1">&#39;COM5&#39;</span><span class="p">,</span> <span class="s1">&#39;COM6&#39;</span><span class="p">,</span> <span class="s1">&#39;COM7&#39;</span><span class="p">,</span> <span class="s1">&#39;COM8&#39;</span><span class="p">,</span> <span class="s1">&#39;COM9&#39;</span><span class="p">,</span>
            <span class="s1">&#39;LPT1&#39;</span><span class="p">,</span> <span class="s1">&#39;LPT2&#39;</span><span class="p">,</span> <span class="s1">&#39;LPT3&#39;</span><span class="p">,</span> <span class="s1">&#39;LPT4&#39;</span><span class="p">,</span> <span class="s1">&#39;LPT5&#39;</span><span class="p">,</span> <span class="s1">&#39;LPT6&#39;</span><span class="p">,</span> <span class="s1">&#39;LPT7&#39;</span><span class="p">,</span> <span class="s1">&#39;LPT8&#39;</span><span class="p">,</span> <span class="s1">&#39;LPT9&#39;</span>
        <span class="p">]</span>
        
        <span class="n">name_without_ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">filename</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">name_without_ext</span> <span class="ow">in</span> <span class="n">reserved_names</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        
        <span class="k">return</span> <span class="kc">True</span></div>

    
<div class="viewcode-block" id="ValidationUtils.is_safe_code">
<a class="viewcode-back" href="../modules/index.html#utils.ValidationUtils.is_safe_code">[×ª×™×¢×•×“]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">is_safe_code</span><span class="p">(</span><span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">programming_language</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×‘×“×™×§×” ×‘×¡×™×¡×™×ª ×©×œ ×‘×˜×™×—×•×ª ×§×•×“&quot;&quot;&quot;</span>
        
        <span class="n">warnings</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1"># ×“×¤×•×¡×™× ××¡×•×›× ×™×</span>
        <span class="n">dangerous_patterns</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;python&#39;</span><span class="p">:</span> <span class="p">[</span>
                <span class="sa">r</span><span class="s1">&#39;exec\s*\(&#39;</span><span class="p">,</span>
                <span class="sa">r</span><span class="s1">&#39;eval\s*\(&#39;</span><span class="p">,</span>
                <span class="sa">r</span><span class="s1">&#39;__import__\s*\(&#39;</span><span class="p">,</span>
                <span class="sa">r</span><span class="s1">&#39;open\s*\([^)]*[&quot;</span><span class="se">\&#39;</span><span class="s1">]w&#39;</span><span class="p">,</span>  <span class="c1"># ×›×ª×™×‘×” ×œ×§×•×‘×¥</span>
                <span class="sa">r</span><span class="s1">&#39;subprocess\.&#39;</span><span class="p">,</span>
                <span class="sa">r</span><span class="s1">&#39;os\.system\s*\(&#39;</span><span class="p">,</span>
                <span class="sa">r</span><span class="s1">&#39;os\.popen\s*\(&#39;</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="s1">&#39;javascript&#39;</span><span class="p">:</span> <span class="p">[</span>
                <span class="sa">r</span><span class="s1">&#39;eval\s*\(&#39;</span><span class="p">,</span>
                <span class="sa">r</span><span class="s1">&#39;Function\s*\(&#39;</span><span class="p">,</span>
                <span class="sa">r</span><span class="s1">&#39;document\.write\s*\(&#39;</span><span class="p">,</span>
                <span class="sa">r</span><span class="s1">&#39;innerHTML\s*=&#39;</span><span class="p">,</span>
                <span class="sa">r</span><span class="s1">&#39;outerHTML\s*=&#39;</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="s1">&#39;bash&#39;</span><span class="p">:</span> <span class="p">[</span>
                <span class="sa">r</span><span class="s1">&#39;rm\s+-rf&#39;</span><span class="p">,</span>
                <span class="sa">r</span><span class="s1">&#39;rm\s+/&#39;</span><span class="p">,</span>
                <span class="sa">r</span><span class="s1">&#39;dd\s+if=&#39;</span><span class="p">,</span>
                <span class="sa">r</span><span class="s1">&#39;mkfs\.&#39;</span><span class="p">,</span>
                <span class="sa">r</span><span class="s1">&#39;fdisk\s+&#39;</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="p">}</span>
        
        <span class="k">if</span> <span class="n">programming_language</span> <span class="ow">in</span> <span class="n">dangerous_patterns</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">dangerous_patterns</span><span class="p">[</span><span class="n">programming_language</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">):</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;×“×¤×•×¡ ××¡×•×›×Ÿ ××¤×©×¨×™: </span><span class="si">{</span><span class="n">pattern</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        
        <span class="c1"># ×‘×“×™×§×•×ª ×›×œ×œ×™×•×ª</span>
        <span class="k">if</span> <span class="s1">&#39;password&#39;</span> <span class="ow">in</span> <span class="n">code</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">or</span> <span class="s1">&#39;secret&#39;</span> <span class="ow">in</span> <span class="n">code</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;×”×§×•×“ ××›×™×œ ××™×œ×•×ª ×¡×™×¡××” ××• ×¡×•×“&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;https?://\S+&#39;</span><span class="p">,</span> <span class="n">code</span><span class="p">):</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;×”×§×•×“ ××›×™×œ URL×™×&quot;</span><span class="p">)</span>
        
        <span class="n">is_safe</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">warnings</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">is_safe</span><span class="p">,</span> <span class="n">warnings</span></div>
</div>


<div class="viewcode-block" id="FileUtils">
<a class="viewcode-back" href="../modules/index.html#utils.FileUtils">[×ª×™×¢×•×“]</a>
<span class="k">class</span> <span class="nc">FileUtils</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;×›×œ×™× ×œ×¢×‘×•×“×” ×¢× ×§×‘×¦×™×&quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="FileUtils.download_file">
<a class="viewcode-back" href="../modules/index.html#utils.FileUtils.download_file">[×ª×™×¢×•×“]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">download_file</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">max_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×”×•×¨×“×ª ×§×•×‘×¥ ×-URL&quot;&quot;&quot;</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># ×©××•×¨ ×ª××™××•×ª ×œ××—×•×¨: ×‘×¨×™×¨×ª ××—×“×œ 20s ×œ×”×•×¨×“×•×ª ××œ× ×× ×”×•×’×“×¨ ×‘××¤×•×¨×© ×‘-ENV</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">env_total</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;AIOHTTP_TIMEOUT_TOTAL&quot;</span><span class="p">)</span>
                <span class="n">timeout_total</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">env_total</span><span class="p">)</span> <span class="k">if</span> <span class="n">env_total</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="mi">20</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="n">timeout_total</span> <span class="o">=</span> <span class="mi">20</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">env_limit</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;AIOHTTP_POOL_LIMIT&quot;</span><span class="p">)</span>
                <span class="n">pool_limit</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">env_limit</span><span class="p">)</span> <span class="k">if</span> <span class="n">env_limit</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span>
                    <span class="nb">int</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="s2">&quot;AIOHTTP_POOL_LIMIT&quot;</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span> <span class="k">if</span> <span class="n">config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">50</span>
                <span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="n">pool_limit</span> <span class="o">=</span> <span class="mi">50</span>
            <span class="n">timeout</span> <span class="o">=</span> <span class="n">aiohttp</span><span class="o">.</span><span class="n">ClientTimeout</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="n">timeout_total</span><span class="p">)</span>
            <span class="n">connector</span> <span class="o">=</span> <span class="n">aiohttp</span><span class="o">.</span><span class="n">TCPConnector</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="n">pool_limit</span><span class="p">)</span>
            <span class="k">async</span> <span class="k">with</span> <span class="n">aiohttp</span><span class="o">.</span><span class="n">ClientSession</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span> <span class="n">connector</span><span class="o">=</span><span class="n">connector</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
                <span class="k">async</span> <span class="k">with</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span> <span class="k">as</span> <span class="n">response</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;×©×’×™××” ×‘×”×•×¨×“×ª ×§×•×‘×¥: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="k">return</span> <span class="kc">None</span>
                    
                    <span class="c1"># ×‘×“×™×§×ª ×’×•×“×œ</span>
                    <span class="n">content_length</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;content-length&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">content_length</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">content_length</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_size</span><span class="p">:</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;×§×•×‘×¥ ×’×“×•×œ ××“×™: </span><span class="si">{</span><span class="n">content_length</span><span class="si">}</span><span class="s2"> bytes&quot;</span><span class="p">)</span>
                        <span class="k">return</span> <span class="kc">None</span>
                    
                    <span class="c1"># ×”×•×¨×“×ª ×”×ª×•×›×Ÿ</span>
                    <span class="n">content</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
                    <span class="k">async</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">iter_chunked</span><span class="p">(</span><span class="mi">8192</span><span class="p">):</span>
                        <span class="n">content</span> <span class="o">+=</span> <span class="n">chunk</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">content</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_size</span><span class="p">:</span>
                            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;×§×•×‘×¥ ×’×“×•×œ ××“×™&quot;</span><span class="p">)</span>
                            <span class="k">return</span> <span class="kc">None</span>
                    
                    <span class="k">return</span> <span class="n">content</span>
        
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;×©×’×™××” ×‘×”×•×¨×“×ª ×§×•×‘×¥: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span></div>

    
<div class="viewcode-block" id="FileUtils.get_file_extension">
<a class="viewcode-back" href="../modules/index.html#utils.FileUtils.get_file_extension">[×ª×™×¢×•×“]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_file_extension</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×§×‘×œ×ª ×¡×™×•××ª ×§×•×‘×¥&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">filename</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span></div>

    
<div class="viewcode-block" id="FileUtils.get_mime_type">
<a class="viewcode-back" href="../modules/index.html#utils.FileUtils.get_mime_type">[×ª×™×¢×•×“]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_mime_type</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×§×‘×œ×ª MIME type ×©×œ ×§×•×‘×¥&quot;&quot;&quot;</span>
        <span class="n">mime_type</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">mimetypes</span><span class="o">.</span><span class="n">guess_type</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mime_type</span> <span class="ow">or</span> <span class="s1">&#39;application/octet-stream&#39;</span></div>

    
<div class="viewcode-block" id="FileUtils.create_temp_file">
<a class="viewcode-back" href="../modules/index.html#utils.FileUtils.create_temp_file">[×ª×™×¢×•×“]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">create_temp_file</span><span class="p">(</span><span class="n">content</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span> 
                              <span class="n">suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×™×¦×™×¨×ª ×§×•×‘×¥ ×–×× ×™&quot;&quot;&quot;</span>
        
        <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;wb&#39;</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span> <span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">as</span> <span class="n">temp_file</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">content</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
            
            <span class="n">temp_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">temp_file</span><span class="o">.</span><span class="n">name</span></div>
</div>


<div class="viewcode-block" id="ConfigUtils">
<a class="viewcode-back" href="../modules/index.html#utils.ConfigUtils">[×ª×™×¢×•×“]</a>
<span class="k">class</span> <span class="nc">ConfigUtils</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;×›×œ×™× ×œ×§×•× ×¤×™×’×•×¨×¦×™×”&quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="ConfigUtils.load_json_config">
<a class="viewcode-back" href="../modules/index.html#utils.ConfigUtils.load_json_config">[×ª×™×¢×•×“]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">load_json_config</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×˜×¢×™× ×ª ×§×•× ×¤×™×’×•×¨×¦×™×” ××§×•×‘×¥ JSON&quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">default</span> <span class="o">=</span> <span class="p">{}</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;×§×•×‘×¥ ×§×•× ×¤×™×’×•×¨×¦×™×” ×œ× × ××¦×: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">default</span>
        
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;×©×’×™××” ×‘×˜×¢×™× ×ª ×§×•× ×¤×™×’×•×¨×¦×™×”: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">default</span></div>

    
<div class="viewcode-block" id="ConfigUtils.save_json_config">
<a class="viewcode-back" href="../modules/index.html#utils.ConfigUtils.save_json_config">[×ª×™×¢×•×“]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">save_json_config</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×©××™×¨×ª ×§×•× ×¤×™×’×•×¨×¦×™×” ×œ×§×•×‘×¥ JSON&quot;&quot;&quot;</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">file_path</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
            
            <span class="k">return</span> <span class="kc">True</span>
        
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;×©×’×™××” ×‘×©××™×¨×ª ×§×•× ×¤×™×’×•×¨×¦×™×”: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span></div>
</div>


<div class="viewcode-block" id="CacheUtils">
<a class="viewcode-back" href="../modules/index.html#utils.CacheUtils">[×ª×™×¢×•×“]</a>
<span class="k">class</span> <span class="nc">CacheUtils</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;×›×œ×™× ×œ×§××© ×–×× ×™&quot;&quot;&quot;</span>
    
    <span class="n">_cache</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">_cache_times</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    
<div class="viewcode-block" id="CacheUtils.set">
<a class="viewcode-back" href="../modules/index.html#utils.CacheUtils.set">[×ª×™×¢×•×“]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">ttl</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×©××™×¨×” ×‘×§××© ×¢× TTL (×©× ×™×•×ª)&quot;&quot;&quot;</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_cache_times</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">+</span> <span class="n">ttl</span></div>

    
<div class="viewcode-block" id="CacheUtils.get">
<a class="viewcode-back" href="../modules/index.html#utils.CacheUtils.get">[×ª×™×¢×•×“]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;×§×‘×œ×” ××”×§××©&quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_cache</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">default</span>
        
        <span class="c1"># ×‘×“×™×§×ª ×ª×¤×•×’×”</span>
        <span class="k">if</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">&gt;</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_cache_times</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">default</span>
        
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">key</span><span class="p">]</span></div>

    
<div class="viewcode-block" id="CacheUtils.delete">
<a class="viewcode-back" href="../modules/index.html#utils.CacheUtils.delete">[×ª×™×¢×•×“]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;××—×™×§×” ××”×§××©&quot;&quot;&quot;</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_cache_times</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="CacheUtils.clear">
<a class="viewcode-back" href="../modules/index.html#utils.CacheUtils.clear">[×ª×™×¢×•×“]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;× ×™×§×•×™ ×›×œ ×”×§××©&quot;&quot;&quot;</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_cache_times</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span></div>
</div>


<span class="c1"># ×¤×•× ×§×¦×™×•×ª ×¢×–×¨ ×’×œ×•×‘×œ×™×•×ª</span>
<div class="viewcode-block" id="get_memory_usage">
<a class="viewcode-back" href="../modules/index.html#utils.get_memory_usage">[×ª×™×¢×•×“]</a>
<span class="k">def</span> <span class="nf">get_memory_usage</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;×§×‘×œ×ª × ×ª×•× ×™ ×–×™×›×¨×•×Ÿ&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">psutil</span>
        <span class="n">process</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">Process</span><span class="p">()</span>
        <span class="n">memory_info</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">memory_info</span><span class="p">()</span>
        
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;rss_mb&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">memory_info</span><span class="o">.</span><span class="n">rss</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span><span class="p">,</span>
            <span class="s2">&quot;vms_mb&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">memory_info</span><span class="o">.</span><span class="n">vms</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span><span class="p">,</span>
            <span class="s2">&quot;percent&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">process</span><span class="o">.</span><span class="n">memory_percent</span><span class="p">()),</span>
        <span class="p">}</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;psutil ×œ× ××•×ª×§×Ÿ&quot;</span><span class="p">}</span></div>


<div class="viewcode-block" id="setup_logging">
<a class="viewcode-back" href="../modules/index.html#utils.setup_logging">[×ª×™×¢×•×“]</a>
<span class="k">def</span> <span class="nf">setup_logging</span><span class="p">(</span><span class="n">level</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;INFO&quot;</span><span class="p">,</span> <span class="n">log_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;×”×’×“×¨×ª ×œ×•×’×™×&quot;&quot;&quot;</span>
    
    <span class="c1"># ×”×’×“×¨×ª ×¨××ª ×œ×•×’</span>
    <span class="n">log_level</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">logging</span><span class="p">,</span> <span class="n">level</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    
    <span class="c1"># ×”×’×“×¨×ª ×¤×•×¨××˜</span>
    <span class="n">formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span>
        <span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> - </span><span class="si">%(name)s</span><span class="s1"> - </span><span class="si">%(levelname)s</span><span class="s1"> - </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="n">datefmt</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span>
    <span class="p">)</span>
    
    <span class="c1"># ×”×’×“×¨×ª handlers</span>
    <span class="n">handlers</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">logging</span><span class="o">.</span><span class="n">Handler</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)]</span>
    
    <span class="k">if</span> <span class="n">log_file</span><span class="p">:</span>
        <span class="n">file_handler</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">Handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="n">log_file</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
        <span class="n">file_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
        <span class="n">handlers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file_handler</span><span class="p">)</span>
    
    <span class="c1"># ×§×•× ×¤×™×’×•×¨×¦×™×”</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span>
        <span class="n">level</span><span class="o">=</span><span class="n">log_level</span><span class="p">,</span>
        <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> - </span><span class="si">%(name)s</span><span class="s1"> - </span><span class="si">%(levelname)s</span><span class="s1"> - </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="n">handlers</span><span class="o">=</span><span class="n">handlers</span>
    <span class="p">)</span>
    
    <span class="k">return</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span></div>


<div class="viewcode-block" id="generate_summary_stats">
<a class="viewcode-back" href="../modules/index.html#utils.generate_summary_stats">[×ª×™×¢×•×“]</a>
<span class="k">def</span> <span class="nf">generate_summary_stats</span><span class="p">(</span><span class="n">files_data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;×™×¦×™×¨×ª ×¡×™×›×•× ×¡×˜×˜×™×¡×˜×™×§×•×ª&quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">files_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{}</span>
    
    <span class="n">total_files</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">files_data</span><span class="p">)</span>
    <span class="n">total_size</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;code&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files_data</span><span class="p">)</span>
    
    <span class="n">languages</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;language&#39;</span><span class="p">,</span> <span class="s1">&#39;unknown&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files_data</span><span class="p">]</span>
    <span class="n">language_counts</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">lang</span><span class="p">:</span> <span class="n">languages</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">lang</span><span class="p">)</span> <span class="k">for</span> <span class="n">lang</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">languages</span><span class="p">)}</span>
    
    <span class="n">all_tags</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files_data</span><span class="p">:</span>
        <span class="n">all_tags</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;tags&#39;</span><span class="p">,</span> <span class="p">[]))</span>
    
    <span class="n">tag_counts</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">tag</span><span class="p">:</span> <span class="n">all_tags</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span> <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">all_tags</span><span class="p">)}</span>
    
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;total_files&quot;</span><span class="p">:</span> <span class="n">total_files</span><span class="p">,</span>
        <span class="s2">&quot;total_size&quot;</span><span class="p">:</span> <span class="n">total_size</span><span class="p">,</span>
        <span class="s2">&quot;total_size_formatted&quot;</span><span class="p">:</span> <span class="n">TextUtils</span><span class="o">.</span><span class="n">format_file_size</span><span class="p">(</span><span class="n">total_size</span><span class="p">),</span>
        <span class="s2">&quot;languages&quot;</span><span class="p">:</span> <span class="n">language_counts</span><span class="p">,</span>
        <span class="s2">&quot;most_used_language&quot;</span><span class="p">:</span> <span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">language_counts</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">k</span><span class="p">:</span> <span class="n">language_counts</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="k">if</span> <span class="n">language_counts</span> <span class="k">else</span> <span class="kc">None</span><span class="p">),</span>
        <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="n">tag_counts</span><span class="p">,</span>
        <span class="s2">&quot;most_used_tag&quot;</span><span class="p">:</span> <span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">tag_counts</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">k</span><span class="p">:</span> <span class="n">tag_counts</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="k">if</span> <span class="n">tag_counts</span> <span class="k">else</span> <span class="kc">None</span><span class="p">),</span>
        <span class="s2">&quot;average_file_size&quot;</span><span class="p">:</span> <span class="n">total_size</span> <span class="o">//</span> <span class="n">total_files</span> <span class="k">if</span> <span class="n">total_files</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
    <span class="p">}</span></div>


<div class="viewcode-block" id="detect_language_from_filename">
<a class="viewcode-back" href="../modules/index.html#utils.detect_language_from_filename">[×ª×™×¢×•×“]</a>
<span class="k">def</span> <span class="nf">detect_language_from_filename</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;×–×™×”×•×™ ×©×¤×ª ×ª×›× ×•×ª ×œ×¤×™ ×¡×™×•××ª ×”×§×•×‘×¥&quot;&quot;&quot;</span>
    <span class="c1"># ××™×¤×•×™ ×¡×™×•××•×ª ×œ×©×¤×•×ª</span>
    <span class="n">extensions_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="c1"># Python</span>
        <span class="s1">&#39;.py&#39;</span><span class="p">:</span> <span class="s1">&#39;python&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.pyw&#39;</span><span class="p">:</span> <span class="s1">&#39;python&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.pyx&#39;</span><span class="p">:</span> <span class="s1">&#39;python&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.pyi&#39;</span><span class="p">:</span> <span class="s1">&#39;python&#39;</span><span class="p">,</span>
        
        <span class="c1"># JavaScript/TypeScript</span>
        <span class="s1">&#39;.js&#39;</span><span class="p">:</span> <span class="s1">&#39;javascript&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.jsx&#39;</span><span class="p">:</span> <span class="s1">&#39;javascript&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.ts&#39;</span><span class="p">:</span> <span class="s1">&#39;typescript&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.tsx&#39;</span><span class="p">:</span> <span class="s1">&#39;typescript&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.mjs&#39;</span><span class="p">:</span> <span class="s1">&#39;javascript&#39;</span><span class="p">,</span>
        
        <span class="c1"># Web</span>
        <span class="s1">&#39;.html&#39;</span><span class="p">:</span> <span class="s1">&#39;html&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.htm&#39;</span><span class="p">:</span> <span class="s1">&#39;html&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.css&#39;</span><span class="p">:</span> <span class="s1">&#39;css&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.scss&#39;</span><span class="p">:</span> <span class="s1">&#39;scss&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.sass&#39;</span><span class="p">:</span> <span class="s1">&#39;sass&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.less&#39;</span><span class="p">:</span> <span class="s1">&#39;less&#39;</span><span class="p">,</span>
        
        <span class="c1"># Java/Kotlin</span>
        <span class="s1">&#39;.java&#39;</span><span class="p">:</span> <span class="s1">&#39;java&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.kt&#39;</span><span class="p">:</span> <span class="s1">&#39;kotlin&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.kts&#39;</span><span class="p">:</span> <span class="s1">&#39;kotlin&#39;</span><span class="p">,</span>
        
        <span class="c1"># C/C++</span>
        <span class="s1">&#39;.c&#39;</span><span class="p">:</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.h&#39;</span><span class="p">:</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.cpp&#39;</span><span class="p">:</span> <span class="s1">&#39;cpp&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.cc&#39;</span><span class="p">:</span> <span class="s1">&#39;cpp&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.cxx&#39;</span><span class="p">:</span> <span class="s1">&#39;cpp&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.hpp&#39;</span><span class="p">:</span> <span class="s1">&#39;cpp&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.hxx&#39;</span><span class="p">:</span> <span class="s1">&#39;cpp&#39;</span><span class="p">,</span>
        
        <span class="c1"># C#</span>
        <span class="s1">&#39;.cs&#39;</span><span class="p">:</span> <span class="s1">&#39;csharp&#39;</span><span class="p">,</span>
        
        <span class="c1"># Go</span>
        <span class="s1">&#39;.go&#39;</span><span class="p">:</span> <span class="s1">&#39;go&#39;</span><span class="p">,</span>
        
        <span class="c1"># Rust</span>
        <span class="s1">&#39;.rs&#39;</span><span class="p">:</span> <span class="s1">&#39;rust&#39;</span><span class="p">,</span>
        
        <span class="c1"># Ruby</span>
        <span class="s1">&#39;.rb&#39;</span><span class="p">:</span> <span class="s1">&#39;ruby&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.rake&#39;</span><span class="p">:</span> <span class="s1">&#39;ruby&#39;</span><span class="p">,</span>
        
        <span class="c1"># PHP</span>
        <span class="s1">&#39;.php&#39;</span><span class="p">:</span> <span class="s1">&#39;php&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.phtml&#39;</span><span class="p">:</span> <span class="s1">&#39;php&#39;</span><span class="p">,</span>
        
        <span class="c1"># Swift</span>
        <span class="s1">&#39;.swift&#39;</span><span class="p">:</span> <span class="s1">&#39;swift&#39;</span><span class="p">,</span>
        
        <span class="c1"># Shell</span>
        <span class="s1">&#39;.sh&#39;</span><span class="p">:</span> <span class="s1">&#39;bash&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.bash&#39;</span><span class="p">:</span> <span class="s1">&#39;bash&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.zsh&#39;</span><span class="p">:</span> <span class="s1">&#39;bash&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.fish&#39;</span><span class="p">:</span> <span class="s1">&#39;bash&#39;</span><span class="p">,</span>
        
        <span class="c1"># SQL</span>
        <span class="s1">&#39;.sql&#39;</span><span class="p">:</span> <span class="s1">&#39;sql&#39;</span><span class="p">,</span>
        
        <span class="c1"># JSON/YAML/XML</span>
        <span class="s1">&#39;.json&#39;</span><span class="p">:</span> <span class="s1">&#39;json&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.yaml&#39;</span><span class="p">:</span> <span class="s1">&#39;yaml&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.yml&#39;</span><span class="p">:</span> <span class="s1">&#39;yaml&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.xml&#39;</span><span class="p">:</span> <span class="s1">&#39;xml&#39;</span><span class="p">,</span>
        
        <span class="c1"># Markdown</span>
        <span class="s1">&#39;.md&#39;</span><span class="p">:</span> <span class="s1">&#39;markdown&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.markdown&#39;</span><span class="p">:</span> <span class="s1">&#39;markdown&#39;</span><span class="p">,</span>
        
        <span class="c1"># Other</span>
        <span class="s1">&#39;.r&#39;</span><span class="p">:</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.lua&#39;</span><span class="p">:</span> <span class="s1">&#39;lua&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.vim&#39;</span><span class="p">:</span> <span class="s1">&#39;vim&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.dockerfile&#39;</span><span class="p">:</span> <span class="s1">&#39;dockerfile&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Dockerfile&#39;</span><span class="p">:</span> <span class="s1">&#39;dockerfile&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.makefile&#39;</span><span class="p">:</span> <span class="s1">&#39;makefile&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Makefile&#39;</span><span class="p">:</span> <span class="s1">&#39;makefile&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.cmake&#39;</span><span class="p">:</span> <span class="s1">&#39;cmake&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.gradle&#39;</span><span class="p">:</span> <span class="s1">&#39;gradle&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.properties&#39;</span><span class="p">:</span> <span class="s1">&#39;properties&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.ini&#39;</span><span class="p">:</span> <span class="s1">&#39;ini&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.toml&#39;</span><span class="p">:</span> <span class="s1">&#39;toml&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.env&#39;</span><span class="p">:</span> <span class="s1">&#39;env&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.gitignore&#39;</span><span class="p">:</span> <span class="s1">&#39;gitignore&#39;</span><span class="p">,</span>
        <span class="s1">&#39;.dockerignore&#39;</span><span class="p">:</span> <span class="s1">&#39;dockerignore&#39;</span>
    <span class="p">}</span>
    
    <span class="c1"># ×‘×“×™×§×ª ×¡×™×•××ª</span>
    <span class="n">filename_lower</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">ext</span><span class="p">,</span> <span class="n">lang</span> <span class="ow">in</span> <span class="n">extensions_map</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">filename_lower</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">ext</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span> <span class="ow">or</span> <span class="n">filename_lower</span> <span class="o">==</span> <span class="n">ext</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">lang</span>
    
    <span class="c1"># ×× ×œ× × ××¦××” ×”×ª×××”, × ×—×–×™×¨ &#39;text&#39;</span>
    <span class="k">return</span> <span class="s1">&#39;text&#39;</span></div>


<div class="viewcode-block" id="get_language_emoji">
<a class="viewcode-back" href="../modules/index.html#utils.get_language_emoji">[×ª×™×¢×•×“]</a>
<span class="k">def</span> <span class="nf">get_language_emoji</span><span class="p">(</span><span class="n">language</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;××—×–×™×¨ ××™××•×’&#39;×™ ××ª××™× ×œ×©×¤×ª ×”×ª×›× ×•×ª&quot;&quot;&quot;</span>
    <span class="n">emoji_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;python&#39;</span><span class="p">:</span> <span class="s1">&#39;ğŸ&#39;</span><span class="p">,</span>
        <span class="s1">&#39;javascript&#39;</span><span class="p">:</span> <span class="s1">&#39;ğŸŸ¨&#39;</span><span class="p">,</span>
        <span class="s1">&#39;typescript&#39;</span><span class="p">:</span> <span class="s1">&#39;ğŸ”·&#39;</span><span class="p">,</span>
        <span class="s1">&#39;java&#39;</span><span class="p">:</span> <span class="s1">&#39;â˜•&#39;</span><span class="p">,</span>
        <span class="s1">&#39;kotlin&#39;</span><span class="p">:</span> <span class="s1">&#39;ğŸŸ£&#39;</span><span class="p">,</span>
        <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="s1">&#39;ğŸ”µ&#39;</span><span class="p">,</span>
        <span class="s1">&#39;cpp&#39;</span><span class="p">:</span> <span class="s1">&#39;ğŸ”·&#39;</span><span class="p">,</span>
        <span class="s1">&#39;csharp&#39;</span><span class="p">:</span> <span class="s1">&#39;ğŸŸ¦&#39;</span><span class="p">,</span>
        <span class="s1">&#39;go&#39;</span><span class="p">:</span> <span class="s1">&#39;ğŸ¹&#39;</span><span class="p">,</span>
        <span class="s1">&#39;rust&#39;</span><span class="p">:</span> <span class="s1">&#39;ğŸ¦€&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ruby&#39;</span><span class="p">:</span> <span class="s1">&#39;ğŸ’&#39;</span><span class="p">,</span>
        <span class="s1">&#39;php&#39;</span><span class="p">:</span> <span class="s1">&#39;ğŸ˜&#39;</span><span class="p">,</span>
        <span class="s1">&#39;swift&#39;</span><span class="p">:</span> <span class="s1">&#39;ğŸ¦‰&#39;</span><span class="p">,</span>
        <span class="s1">&#39;bash&#39;</span><span class="p">:</span> <span class="s1">&#39;ğŸš&#39;</span><span class="p">,</span>
        <span class="s1">&#39;sql&#39;</span><span class="p">:</span> <span class="s1">&#39;ğŸ—„ï¸&#39;</span><span class="p">,</span>
        <span class="s1">&#39;html&#39;</span><span class="p">:</span> <span class="s1">&#39;ğŸŒ&#39;</span><span class="p">,</span>
        <span class="s1">&#39;css&#39;</span><span class="p">:</span> <span class="s1">&#39;ğŸ¨&#39;</span><span class="p">,</span>
        <span class="s1">&#39;scss&#39;</span><span class="p">:</span> <span class="s1">&#39;ğŸ¨&#39;</span><span class="p">,</span>
        <span class="s1">&#39;sass&#39;</span><span class="p">:</span> <span class="s1">&#39;ğŸ¨&#39;</span><span class="p">,</span>
        <span class="s1">&#39;less&#39;</span><span class="p">:</span> <span class="s1">&#39;ğŸ¨&#39;</span><span class="p">,</span>
        <span class="s1">&#39;json&#39;</span><span class="p">:</span> <span class="s1">&#39;ğŸ“‹&#39;</span><span class="p">,</span>
        <span class="s1">&#39;yaml&#39;</span><span class="p">:</span> <span class="s1">&#39;ğŸ“„&#39;</span><span class="p">,</span>
        <span class="s1">&#39;xml&#39;</span><span class="p">:</span> <span class="s1">&#39;ğŸ“°&#39;</span><span class="p">,</span>
        <span class="s1">&#39;markdown&#39;</span><span class="p">:</span> <span class="s1">&#39;ğŸ“&#39;</span><span class="p">,</span>
        <span class="s1">&#39;r&#39;</span><span class="p">:</span> <span class="s1">&#39;ğŸ“Š&#39;</span><span class="p">,</span>
        <span class="s1">&#39;lua&#39;</span><span class="p">:</span> <span class="s1">&#39;ğŸŒ™&#39;</span><span class="p">,</span>
        <span class="s1">&#39;vim&#39;</span><span class="p">:</span> <span class="s1">&#39;ğŸ“&#39;</span><span class="p">,</span>
        <span class="s1">&#39;dockerfile&#39;</span><span class="p">:</span> <span class="s1">&#39;ğŸ³&#39;</span><span class="p">,</span>
        <span class="s1">&#39;makefile&#39;</span><span class="p">:</span> <span class="s1">&#39;ğŸ”§&#39;</span><span class="p">,</span>
        <span class="s1">&#39;cmake&#39;</span><span class="p">:</span> <span class="s1">&#39;ğŸ”¨&#39;</span><span class="p">,</span>
        <span class="s1">&#39;gradle&#39;</span><span class="p">:</span> <span class="s1">&#39;ğŸ˜&#39;</span><span class="p">,</span>
        <span class="s1">&#39;properties&#39;</span><span class="p">:</span> <span class="s1">&#39;âš™ï¸&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ini&#39;</span><span class="p">:</span> <span class="s1">&#39;âš™ï¸&#39;</span><span class="p">,</span>
        <span class="s1">&#39;toml&#39;</span><span class="p">:</span> <span class="s1">&#39;âš™ï¸&#39;</span><span class="p">,</span>
        <span class="s1">&#39;env&#39;</span><span class="p">:</span> <span class="s1">&#39;ğŸ”&#39;</span><span class="p">,</span>
        <span class="s1">&#39;gitignore&#39;</span><span class="p">:</span> <span class="s1">&#39;ğŸš«&#39;</span><span class="p">,</span>
        <span class="s1">&#39;dockerignore&#39;</span><span class="p">:</span> <span class="s1">&#39;ğŸš«&#39;</span><span class="p">,</span>
        <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="s1">&#39;ğŸ“„&#39;</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="n">emoji_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">language</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="s1">&#39;ğŸ“„&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="SensitiveDataFilter">
<a class="viewcode-back" href="../modules/index.html#utils.SensitiveDataFilter">[×ª×™×¢×•×“]</a>
<span class="k">class</span> <span class="nc">SensitiveDataFilter</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">Filter</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;××¡× ×Ÿ ×©××˜×©×˜×© ×˜×•×§× ×™× ×•× ×ª×•× ×™× ×¨×’×™×©×™× ×‘×œ×•×’×™×.&quot;&quot;&quot;</span>
<div class="viewcode-block" id="SensitiveDataFilter.filter">
<a class="viewcode-back" href="../modules/index.html#utils.SensitiveDataFilter.filter">[×ª×™×¢×•×“]</a>
    <span class="k">def</span> <span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">LogRecord</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">getMessage</span><span class="p">())</span>
            <span class="c1"># ×–×™×”×•×™ ×‘×¡×™×¡×™ ×©×œ ×˜×•×§× ×™×: ghp_..., github_pat_..., Bearer ...</span>
            <span class="n">patterns</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;ghp_[A-Za-z0-9]{20,}&quot;</span><span class="p">,</span> <span class="s2">&quot;ghp_***REDACTED***&quot;</span><span class="p">),</span>
                <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;github_pat_[A-Za-z0-9_]{20,}&quot;</span><span class="p">,</span> <span class="s2">&quot;github_pat_***REDACTED***&quot;</span><span class="p">),</span>
                <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Bearer\s+[A-Za-z0-9\-_.=:/+]{10,}&quot;</span><span class="p">,</span> <span class="s2">&quot;Bearer ***REDACTED***&quot;</span><span class="p">),</span>
            <span class="p">]</span>
            <span class="n">redacted</span> <span class="o">=</span> <span class="n">msg</span>
            <span class="kn">import</span> <span class="nn">re</span> <span class="k">as</span> <span class="nn">_re</span>
            <span class="k">for</span> <span class="n">pat</span><span class="p">,</span> <span class="n">repl</span> <span class="ow">in</span> <span class="n">patterns</span><span class="p">:</span>
                <span class="n">redacted</span> <span class="o">=</span> <span class="n">_re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">pat</span><span class="p">,</span> <span class="n">repl</span><span class="p">,</span> <span class="n">redacted</span><span class="p">)</span>
            <span class="c1"># ×¢×“×›×Ÿ ×¨×§ ××ª message ×”×¤×•×¨××˜×™</span>
            <span class="n">record</span><span class="o">.</span><span class="n">msg</span> <span class="o">=</span> <span class="n">redacted</span>
            <span class="c1"># ×—×©×•×‘: × ×§×” ××¨×’×•×× ×˜×™× ×›×“×™ ×œ×× ×•×¢ × ×™×¡×™×•×Ÿ ×¤×•×¨××˜ ×—×•×–×¨ (%s) ×©×™×•×‘×™×œ ×œ-TypeError</span>
            <span class="n">record</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">return</span> <span class="kc">True</span></div>
</div>



<div class="viewcode-block" id="install_sensitive_filter">
<a class="viewcode-back" href="../modules/index.html#utils.install_sensitive_filter">[×ª×™×¢×•×“]</a>
<span class="k">def</span> <span class="nf">install_sensitive_filter</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;×”×ª×§× ×ª ×”××¡× ×Ÿ ×¢×œ ×›×œ ×”-handlers ×”×§×™×™××™×.&quot;&quot;&quot;</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">SensitiveDataFilter</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">root</span><span class="o">.</span><span class="n">handlers</span><span class="p">:</span>
        <span class="n">h</span><span class="o">.</span><span class="n">addFilter</span><span class="p">(</span><span class="n">f</span><span class="p">)</span></div>



<span class="c1"># --- Code normalization ---</span>
<div class="viewcode-block" id="normalize_code">
<a class="viewcode-back" href="../modules/index.html#utils.normalize_code">[×ª×™×¢×•×“]</a>
<span class="k">def</span> <span class="nf">normalize_code</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                   <span class="o">*</span><span class="p">,</span>
                   <span class="n">strip_bom</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                   <span class="n">normalize_newlines</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                   <span class="n">replace_nbsp</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                   <span class="n">replace_all_space_separators</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                   <span class="n">remove_zero_width</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                   <span class="n">remove_directional_marks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                   <span class="n">trim_trailing_whitespace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                   <span class="n">remove_other_format_chars</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                   <span class="n">remove_escaped_format_escapes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                   <span class="n">remove_variation_selectors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;× ×¨××•×œ ×§×•×“ ×œ×¤× ×™ ×©××™×¨×”.</span>

<span class="sd">    ×¤×¢×•×œ×•×ª ×¢×™×§×¨×™×•×ª:</span>

<span class="sd">    - ×”×¡×¨×ª BOM ×‘×ª×—×™×œ×ª ×”×˜×§×¡×˜</span>
<span class="sd">    - ×”××¨×ª CRLF/CR ×œ-LF</span>
<span class="sd">    - ×”×—×œ×¤×ª ×¨×•×•×—×™× ×œ×-×©×•×‘×¨×™× (NBSP/NNBSP) ×œ×¨×•×•×— ×¨×’×™×œ</span>
<span class="sd">    - ×”×¡×¨×ª ×ª×•×•×™ ×¨×•×—×‘-××¤×¡ ×•×¡×™××•× ×™ ×›×™×•×•×Ÿ (LRM/RLM/LRE/RLE/PDF/RLO/LRO/LRI/RLI/FSI/PDI)</span>
<span class="sd">    - ×”×¡×¨×ª ×ª×•×•×™ ×‘×§×¨×” (Cc) ×¤×¨×˜ ×œ-\\t, \\n, \\r</span>
<span class="sd">    - ×”×¡×¨×ª ×¨×•×•×—×™ ×¡×•×£ ×©×•×¨×”</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">text</span> <span class="k">if</span> <span class="n">text</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>

        <span class="n">out</span> <span class="o">=</span> <span class="n">text</span>

        <span class="c1"># Handle sequences like &quot;\u200B&quot; that represent hidden/format chars literally</span>
        <span class="c1"># We do NOT decode arbitrary escapes; only strip escapes that would decode to Cf/hidden sets</span>
        <span class="k">if</span> <span class="n">remove_escaped_format_escapes</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">u&quot;</span> <span class="ow">in</span> <span class="n">out</span> <span class="ow">or</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">U&quot;</span> <span class="ow">in</span> <span class="n">out</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="kn">import</span> <span class="nn">re</span> <span class="k">as</span> <span class="nn">_re</span>
                <span class="c1"># Known hidden/format codepoints we target explicitly</span>
                <span class="n">known_hex4</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;200B&quot;</span><span class="p">,</span> <span class="s2">&quot;200C&quot;</span><span class="p">,</span> <span class="s2">&quot;200D&quot;</span><span class="p">,</span> <span class="s2">&quot;2060&quot;</span><span class="p">,</span> <span class="s2">&quot;FEFF&quot;</span><span class="p">,</span>  <span class="c1"># zero-width set</span>
                    <span class="s2">&quot;200E&quot;</span><span class="p">,</span> <span class="s2">&quot;200F&quot;</span><span class="p">,</span> <span class="s2">&quot;202A&quot;</span><span class="p">,</span> <span class="s2">&quot;202B&quot;</span><span class="p">,</span> <span class="s2">&quot;202C&quot;</span><span class="p">,</span> <span class="s2">&quot;202D&quot;</span><span class="p">,</span> <span class="s2">&quot;202E&quot;</span><span class="p">,</span>  <span class="c1"># directional</span>
                    <span class="s2">&quot;2066&quot;</span><span class="p">,</span> <span class="s2">&quot;2067&quot;</span><span class="p">,</span> <span class="s2">&quot;2068&quot;</span><span class="p">,</span> <span class="s2">&quot;2069&quot;</span><span class="p">,</span>  <span class="c1"># directional isolates</span>
                <span class="p">}</span>

                <span class="k">def</span> <span class="nf">_strip_if_hidden</span><span class="p">(</span><span class="n">m</span><span class="p">:</span> <span class="s1">&#39;re.Match[str]&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
                    <span class="n">hexcode</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
                    <span class="c1"># Quick allowlist: only remove if in known set or Unicode category Cf</span>
                    <span class="k">if</span> <span class="n">hexcode</span> <span class="ow">in</span> <span class="n">known_hex4</span><span class="p">:</span>
                        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">ch</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hexcode</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
                        <span class="n">cat</span> <span class="o">=</span> <span class="n">unicodedata</span><span class="o">.</span><span class="n">category</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">cat</span> <span class="o">==</span> <span class="s1">&#39;Cf&#39;</span><span class="p">:</span>
                            <span class="k">return</span> <span class="s2">&quot;&quot;</span>
                        <span class="c1"># Remove Unicode Variation Selectors (U+FE00..U+FE0F)</span>
                        <span class="k">if</span> <span class="n">remove_variation_selectors</span><span class="p">:</span>
                            <span class="n">v</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">hexcode</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
                            <span class="k">if</span> <span class="mh">0xFE00</span> <span class="o">&lt;=</span> <span class="n">v</span> <span class="o">&lt;=</span> <span class="mh">0xFE0F</span><span class="p">:</span>
                                <span class="k">return</span> <span class="s2">&quot;&quot;</span>
                    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                        <span class="k">pass</span>
                    <span class="k">return</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># keep original escape</span>

                <span class="c1"># Replace \uXXXX sequences</span>
                <span class="n">out</span> <span class="o">=</span> <span class="n">_re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">u([0-9a-fA-F]</span><span class="si">{4}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">_strip_if_hidden</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>

                <span class="c1"># Replace \UXXXXXXXX sequences (rare for these marks, but safe)</span>
                <span class="k">def</span> <span class="nf">_strip_if_hidden_u8</span><span class="p">(</span><span class="n">m</span><span class="p">:</span> <span class="s1">&#39;re.Match[str]&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
                    <span class="n">hexcode</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">ch</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hexcode</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
                        <span class="k">if</span> <span class="n">unicodedata</span><span class="o">.</span><span class="n">category</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;Cf&#39;</span><span class="p">:</span>
                            <span class="k">return</span> <span class="s2">&quot;&quot;</span>
                        <span class="c1"># Remove Ideographic Variation Selectors (U+E0100..U+E01EF)</span>
                        <span class="k">if</span> <span class="n">remove_variation_selectors</span><span class="p">:</span>
                            <span class="n">v</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">hexcode</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
                            <span class="k">if</span> <span class="mh">0xE0100</span> <span class="o">&lt;=</span> <span class="n">v</span> <span class="o">&lt;=</span> <span class="mh">0xE01EF</span><span class="p">:</span>
                                <span class="k">return</span> <span class="s2">&quot;&quot;</span>
                    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                        <span class="k">pass</span>
                    <span class="k">return</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

                <span class="n">out</span> <span class="o">=</span> <span class="n">_re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">U([0-9a-fA-F]</span><span class="si">{8}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">_strip_if_hidden_u8</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="c1"># Best-effort: ignore on failure</span>
                <span class="k">pass</span>

        <span class="c1"># Strip BOM at start</span>
        <span class="k">if</span> <span class="n">strip_bom</span> <span class="ow">and</span> <span class="n">out</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\ufeff</span><span class="s2">&quot;</span><span class="p">):</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\ufeff</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Normalize newlines to LF</span>
        <span class="k">if</span> <span class="n">normalize_newlines</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Replace non-breaking spaces with regular space</span>
        <span class="k">if</span> <span class="n">replace_nbsp</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\u00A0</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\u202F</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>

        <span class="c1"># Replace all Unicode space separators (Zs) with regular ASCII space</span>
        <span class="k">if</span> <span class="n">replace_all_space_separators</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">out</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot; &quot;</span> <span class="k">if</span> <span class="n">unicodedata</span><span class="o">.</span><span class="n">category</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;Zs&quot;</span> <span class="k">else</span> <span class="n">ch</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">out</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="c1"># If classification fails, skip Zs replacement and keep current text</span>
                <span class="k">pass</span>

        <span class="c1"># Remove zero-width and directional formatting characters</span>
        <span class="k">if</span> <span class="n">remove_zero_width</span> <span class="ow">or</span> <span class="n">remove_directional_marks</span><span class="p">:</span>
            <span class="n">zero_width</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;</span><span class="se">\u200B</span><span class="s2">&quot;</span><span class="p">,</span>  <span class="c1"># ZWSP</span>
                <span class="s2">&quot;</span><span class="se">\u200C</span><span class="s2">&quot;</span><span class="p">,</span>  <span class="c1"># ZWNJ</span>
                <span class="s2">&quot;</span><span class="se">\u200D</span><span class="s2">&quot;</span><span class="p">,</span>  <span class="c1"># ZWJ</span>
                <span class="s2">&quot;</span><span class="se">\u2060</span><span class="s2">&quot;</span><span class="p">,</span>  <span class="c1"># WJ</span>
                <span class="s2">&quot;</span><span class="se">\uFEFF</span><span class="s2">&quot;</span><span class="p">,</span>  <span class="c1"># ZWNBSP/BOM</span>
            <span class="p">}</span>
            <span class="n">directional</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;</span><span class="se">\u200E</span><span class="s2">&quot;</span><span class="p">,</span>  <span class="c1"># LRM</span>
                <span class="s2">&quot;</span><span class="se">\u200F</span><span class="s2">&quot;</span><span class="p">,</span>  <span class="c1"># RLM</span>
                <span class="s2">&quot;</span><span class="se">\u202A</span><span class="s2">&quot;</span><span class="p">,</span>  <span class="c1"># LRE</span>
                <span class="s2">&quot;</span><span class="se">\u202B</span><span class="s2">&quot;</span><span class="p">,</span>  <span class="c1"># RLE</span>
                <span class="s2">&quot;</span><span class="se">\u202C</span><span class="s2">&quot;</span><span class="p">,</span>  <span class="c1"># PDF</span>
                <span class="s2">&quot;</span><span class="se">\u202D</span><span class="s2">&quot;</span><span class="p">,</span>  <span class="c1"># LRO</span>
                <span class="s2">&quot;</span><span class="se">\u202E</span><span class="s2">&quot;</span><span class="p">,</span>  <span class="c1"># RLO</span>
                <span class="s2">&quot;</span><span class="se">\u2066</span><span class="s2">&quot;</span><span class="p">,</span>  <span class="c1"># LRI</span>
                <span class="s2">&quot;</span><span class="se">\u2067</span><span class="s2">&quot;</span><span class="p">,</span>  <span class="c1"># RLI</span>
                <span class="s2">&quot;</span><span class="se">\u2068</span><span class="s2">&quot;</span><span class="p">,</span>  <span class="c1"># FSI</span>
                <span class="s2">&quot;</span><span class="se">\u2069</span><span class="s2">&quot;</span><span class="p">,</span>  <span class="c1"># PDI</span>
            <span class="p">}</span>

            <span class="k">def</span> <span class="nf">_should_keep</span><span class="p">(</span><span class="n">ch</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
                <span class="c1"># Keep tabs/newlines/carriage returns</span>
                <span class="k">if</span> <span class="n">ch</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">):</span>
                    <span class="k">return</span> <span class="kc">True</span>
                <span class="c1"># Drop specific sets</span>
                <span class="k">if</span> <span class="n">remove_zero_width</span> <span class="ow">and</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">zero_width</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">remove_directional_marks</span> <span class="ow">and</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">directional</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span>
                <span class="c1"># Remove Variation Selectors if requested</span>
                <span class="k">if</span> <span class="n">remove_variation_selectors</span><span class="p">:</span>
                    <span class="n">cp</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>
                    <span class="c1"># VS1..VS16 (U+FE00..U+FE0F) and Ideographic VS (U+E0100..U+E01EF)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="mh">0xFE00</span> <span class="o">&lt;=</span> <span class="n">cp</span> <span class="o">&lt;=</span> <span class="mh">0xFE0F</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="mh">0xE0100</span> <span class="o">&lt;=</span> <span class="n">cp</span> <span class="o">&lt;=</span> <span class="mh">0xE01EF</span><span class="p">):</span>
                        <span class="k">return</span> <span class="kc">False</span>
                <span class="c1"># Drop other control chars (Cc), keep others</span>
                <span class="n">cat</span> <span class="o">=</span> <span class="n">unicodedata</span><span class="o">.</span><span class="n">category</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">cat</span> <span class="o">==</span> <span class="s1">&#39;Cc&#39;</span> <span class="ow">and</span> <span class="n">ch</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">):</span>
                    <span class="k">return</span> <span class="kc">False</span>
                <span class="c1"># Optionally remove other format chars (Cf) beyond explicit sets</span>
                <span class="k">if</span> <span class="n">cat</span> <span class="o">==</span> <span class="s1">&#39;Cf&#39;</span> <span class="ow">and</span> <span class="n">remove_other_format_chars</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span>
                <span class="k">return</span> <span class="kc">True</span>

            <span class="n">out</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ch</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">out</span> <span class="k">if</span> <span class="n">_should_keep</span><span class="p">(</span><span class="n">ch</span><span class="p">))</span>

        <span class="c1"># Trim trailing whitespace for each line</span>
        <span class="k">if</span> <span class="n">trim_trailing_whitespace</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot; </span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">out</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">out</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="c1"># ×‘××§×¨×” ×©×œ ×©×’×™××”, ×”×—×–×¨ ××ª ×”×˜×§×¡×˜ ×”××§×•×¨×™</span>
        <span class="k">return</span> <span class="n">text</span></div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Development Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>