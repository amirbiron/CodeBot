# ğŸ“¡ Observability Dashboard & API

> ×§×™×©×•×¨×™× ××”×™×¨×™×: [README ×©×œ Code Keeper Bot](https://github.com/amirbiron/CodeBot#-×§×•×“-×©×•××¨) Â· [××“×¨×™×š Config Radar](https://github.com/amirbiron/CodeBot/blob/main/GUIDES/CONFIG_RADAR_GUIDE.md)

××¡×š ×”Ö¾Admin ×”×—×“×© (`/admin/observability`) ××¨×›×– × ×ª×•× ×™ × ×™×˜×•×¨ ×‘×–××Ÿ ×××ª ×œ×˜×•×‘×ª ×¦×•×•×ª×™ SRE ×•×”××¤×ª×—×™×. ×”×¢××•×“ ××ª××§×“ ×‘×©×œ×•×©×” ×¢×§×¨×•× ×•×ª:

1. **×©×§×™×¤×•×ª** â€“ ×›×¨×˜×™×¡×™ ××¦×‘ ×•×’×¨×¤×™× ×§×œ×™× ×œ×§×¨×™××” ×¢× ×§×•× ×˜×§×¡×˜ ×©×œ ×–××Ÿ.
2. **×—×§×™×¨×” ××”×™×¨×”** â€“ ×˜×‘×œ×ª ×”×ª×¨××•×ª ×¢× ×¡×™× ×•×Ÿ ××ª×§×“× ×•×¤×’'×™× ×¦×™×” ×—×¡×›×•× ×™×ª.
3. **API ××ª×•×¢×“** â€“ ×©×œ×•×©×” Endpoints ×¡×™××˜×¨×™×™× ×©× ×™×ª× ×™× ×œ×¦×¨×™×›×” ××•×˜×•××˜×™×ª ×¢"×™ Grafana, Slack ××• ×¡×§×¨×™×¤×˜×™×.

×”××¡××š ×”×–×” ××ª××¨ ××ª ××‘× ×” ×”××¡×š, ××ª ×¤×¨×˜×™ ×”Ö¾API, ×©×™×§×•×œ×™ ××‘×˜×—×” ×•×‘×™×¦×•×¢×™×, ×•×›×Ÿ ×“×•×’×××•×ª ××™× ×˜×’×¨×¦×™×” ×œ×¦×¨×™×›×” ×—×™×¦×•× ×™×ª.

## ğŸ–¥ï¸ ×¡×§×™×¨×ª ×”×××©×§ `/admin/observability`

### ×—×œ×•×§×ª ×”×“×£

- **×¡×¨×’×œ ×˜×•×•×—×™ ×–××Ÿ** â€“ ×œ×—×¦× ×™ `1h`, `24h`, `7d`, `30d` ××—×œ×™×¤×™× ××ª ×¤×¨××˜×¨ `timerange` ×‘×‘×§×©×•×ª API ×•××¢×“×›× ×™× ××ª ×¡×˜×¨×™××™× ×’ ×”×’×¨×¤×™×.
- **×›×¨×˜×™×¡×™ KPI** â€“ ××¨×‘×¢×” ×§×œ×¤×™× ×§×‘×•×¢×™×: Critical ×‘Ö¾24 ×©×¢×•×ª, Anomaly ×‘×˜×•×•×— ×”× ×•×›×—×™, ×›××•×ª ×“×™×¤×œ×•×™×× ×˜×™×, ×•×’×•×“×œ ×”×©×¤×¢×ª ×”×“×™×¤×œ×•×™×× ×˜ (×××•×¦×¢ ×”×¢×™×›×•×‘ ×‘Ö¾request ×‘×–××Ÿ ×—×œ×•×Ÿ Deployment).
- **×’×¨×¤×™×** â€“ Chart.js ××¦×™×’:
  - ×¨×™×‘×•×“ ×”×ª×¨××•×ª ×œ×¤×™ ×—×•××¨×” (`alerts_count`).
  - ×–×× ×™ ×ª×’×•×‘×” ×××•×¦×¢×™× ×•××§×¡×™××œ×™×™× (`response_time`).
- **×˜×‘×œ×ª × ×§×•×“×•×ª ×§×¦×” ××™×˜×™×•×ª** â€“ Top N (×‘×¨×™×¨×ª ××—×“×œ 5) ×¢× `avg_duration`, `max_duration`, `count` ×•× ×ª×™×‘/×©×™×˜×”.
- **×”×™×¡×˜×•×¨×™×™×ª ×”×ª×¨××•×ª** â€“ ×˜×‘×œ×” ×¢× ×¢×“ 200 ×¨×©×•××•×ª ××—×¨×•× ×•×ª+×¤×’'×™× ×¦×™×”. ×›×œ ×©×•×¨×” ×›×•×œ×œ×ª timestamp, ×©×, ×—×•××¨×”, ×¡×™×›×•× ×•××˜×Ö¾×“××˜×” ×©× ×©×œ×£ ××”Ö¾payload.
- **Incident Replay** â€“ ×›×¤×ª×•×¨ ×™×™×¢×•×“×™ ×©××•×‘×™×œ ×œ××¡×š `/admin/observability/replay` ×¢× ×¦×™×¨ ×–××Ÿ ××©×•×œ×‘ (×”×ª×¨××•×ª, ×“×™×¤×œ×•×™×× ×˜×™× ×•×¤×¢×•×œ×•×ª ChatOps ×©× ×¨×©××• ×“×¨×š Quick Fix). ××¤×©×¨ ×œ×©×ª×£ ×˜×•×•×— ×¡×¤×¦×™×¤×™ ×‘×××¦×¢×•×ª ×¤×¨××˜×¨×™× (`timerange`, `start`, `end`, `focus_ts`).
- **Quick Fix** â€“ ×¢××•×“×ª ×¤×¢×•×œ×•×ª ×¡××•×š ×œ×›×œ ×”×ª×¨××” ×©××¦×™×¢×” ×¤×¢×•×œ×•×ª × ×¤×•×¦×•×ª (×œ×™× ×§×™× ×œâ€‘Playbook, ×”×¢×ª×§×ª ×¤×§×•×“×•×ª ChatOps, ×§×¤×™×¦×” ×œ×¦×™×¨ ×”×–××Ÿ). ×”××™×¤×•×™ ××’×™×¢ ××”×§×•×‘×¥ `config/alert_quick_fixes.json` ×•× ×˜×¢×Ÿ ×“×™× ××™×ª.

### ×’×¨×¤×™× ×”×™×¡×˜×•×¨×™×™× ×‘×›×œ ×”×ª×¨××”

- ×‘×›×œ ×©×•×¨×ª ×”×ª×¨××” ××•×¤×™×¢ ×›×¤×ª×•×¨ `ğŸ“ˆ ×”×¦×’ ×’×¨×£` ×©××¨×—×™×‘ ×’×¨×£ Chart.js ×™×©×™×¨×•×ª ×‘×ª×•×š ×”×˜×‘×œ×”. ×”×’×¨×£ ××ª×™×™×©×¨ ××•×˜×•××˜×™×ª ×œ××–×•×¨ ×”×–××Ÿ ×©×œ ×”×”×ª×¨××” ×•××•×›×Ÿ ×’× ×‘××•×‘×™×™×œ.
- ×”××¢×¨×›×ª ×‘×•×—×¨×ª ×˜×•×•×— ×–××Ÿ ×—×›× (Â± ×¡×‘×™×‘ ××•×¢×“ ×”×”×ª×¨××”) ×‘×”×ª×× ×œ×¡×•×’ ×”××˜×¨×™×§×”:

  | ×¡×•×’ ×”××˜×¨×™×§×” | ×˜×•×•×— ×‘×¨×™×¨×ª ××—×“×œ | ×œ××” ×–×” ××ª××™×? |
  |-------------|-----------------|---------------|
  | CPU Spike / Timeout | Â±15 ×“×§×•×ª | ××™×ª×•×¨ ××™×¨×•×¢ ×¡×¤×™×™×§ ×§×¦×¨ ×•××”×™×¨ |
  | API Latency / Slow Response | Â±30-60 ×“×§×•×ª | ×œ×¨××•×ª ×ª×—×™×œ×ª ×”×™×“×¨×“×¨×•×ª ×•×”×”×ª××•×©×©×•×ª |
  | Error Rate | Â±1-2 ×©×¢×•×ª | ×œ×”×‘×™×Ÿ ××ª ×¢×•××§ ×”×”×©×¤×¢×” ×•××ª ×”×§×•×¨×œ×¦×™×” ×œ×“×™×¤×œ×•×™×× ×˜×™× |
  | Memory Leak / DB Slow | Â±2-6 ×©×¢×•×ª | ×“×œ×™×¤×•×ª ×–×™×›×¨×•×Ÿ ××• ×”×™×“×¨×“×¨×•×ª ××™×˜×™×ª |
  | Disk Space / Capacity | Â±24-48 ×©×¢×•×ª | ××’××ª ×”×ª××œ××•×ª ××¨×•×›×ª ×˜×•×•×— |
  | Traffic Surge | Â±1-3 ×©×¢×•×ª | ×”×©×•×•××” ×œ× ×•×¨××ª ×ª× ×•×¢×” ×™×•××™×ª |

- ×”××©×ª××© ×™×›×•×œ ×œ×©× ×•×ª ××ª ×”×˜×•×•×— ×™×“× ×™×ª ×‘×¢×–×¨×ª Zoom In/Out ××• Presets ×§×‘×•×¢×™× (`15m`, `30m`, `1h`, `2h`, `4h`, `6h`, `24h`, `48h`, `7d`). ×›×œ ×©×™× ×•×™ ×˜×•×•×— ××‘×¦×¢ ×‘×§×©×ª `/api/observability/timeseries` ×¢× `start_time`/`end_time` ××“×•×™×§×™×.
- ×× ×œ××˜×¨×™×§×” ××™×Ÿ ××§×•×¨ × ×ª×•× ×™× ×¤× ×™××™, ××•×¦×’ ×”××¡×¨ *"No visual data available for this metric"* ×•× ×™×ª×Ÿ ×œ×”×©×œ×™× ××ª ×”××™×“×¢ ×“×¨×š Graph URL Template ×—×™×¦×•× ×™ (×¤×™×¨×•×˜ ×‘×”××©×š).

### ×™×›×•×œ×•×ª ×¡×™× ×•×Ÿ

- **×—×•××¨×”** â€“ `critical | anomaly | warning | info` (××• "×›×œ ×”×—×•××¨×•×ª").
- **×¡×•×’ ×”×ª×¨××”** â€“ ×©×™××•×©×™ ×œ×‘×§×¨×•×ª Deployment, ×—×¨×™×’×•×ª Error Rate ×•×›×“'.
- **Endpoint / Path** â€“ ×”×ª×××” ××œ××” ××•×œ `endpoint` ×©×©××•×¨ ×‘××¡×“.
- **×—×™×¤×•×© ×—×•×¤×©×™** â€“ ××—×¤×© ×‘Ö¾`name`, `summary` ×•Ö¾`metadata`.
- **×¤×’'×™× ×¦×™×”** â€“ `page` ×•Ö¾`per_page` ×¢× ×‘×§×¨×” ×“×•Ö¾×›×™×•×•× ×™×ª (×œ×—×¦× ×™ ×”×‘×/×§×•×“× ××¦×™×’×™× ××¦×‘ ×”×¢××•×“ ×”× ×•×›×—×™).

### ××§×¨× ×•Ö¾UI

- **×¦×‘×¢×™ ×—×•××¨×”** â€“ ×•×¨×•×“ (Critical), ×¦×”×•×‘ (Anomaly), ×›×—×•×œ (Warning), ×™×¨×•×§ (Info); ×¦×‘×¢×™× ×–×”×™× ×‘×˜××‘ ×”×™×¡×˜×•×¨×™×™×ª ×”×”×ª×¨××•×ª ×•×‘×’×¨×£ Chart.js ×›×“×™ ×œ×©××•×¨ ×¢×§×‘×™×•×ª.
- **××¦×‘ "Last updated"** â€“ ××¢×•×“×›×Ÿ ×‘×›×œ ×¨×¢× ×•×Ÿ ××§×•××™ ×›×“×™ ×œ×”×“×’×™×© ×’×™×©×” ×‘×–××Ÿ ×××ª.
- **××¦×‘ ×˜×¢×™× ×”/×©×’×™××”** â€“ ×›×œ ××§×˜×¢ ××¦×™×’ ×”×•×“×¢×ª "×˜×•×¢×Ÿ" ××• ×”×•×“×¢×ª ×©×’×™××” ×™×“×™×“×•×ª×™×ª ×›××©×¨ ×”Ö¾API ×œ× ×–××™×Ÿ.

## ğŸ“š API Reference

×›×œ ×”Ö¾Endpoints ××—×™×™×‘×™× ×”×ª×—×‘×¨×•×ª ×‘Ö¾WebApp ×•××©×ª××© ×¢× ×”×¨×©××ª Admin. ×× ××©×ª××© ×¨×’×™×œ ×™× ×¡×” ×œ×”×™×›× ×¡ ×”×•× ×™×§×‘×œ `403 {"ok": false, "error": "admin_only"}`.

### ×¤×¨××˜×¨×™ ×–××Ÿ ××©×•×ª×¤×™×

| ×¤×¨××˜×¨ | ×‘×¨×™×¨×ª ××—×“×œ | ×ª×™××•×¨ |
| --- | --- | --- |
| `timerange` | `24h` | ×˜×•×•×— ×™×—×¡×™ ×‘×¤×•×¨××˜ `Xm`, `Xh`, `Xd`. ×¢×¨×š `custom` ×“×•×¨×© `start_time`+`end_time`. |
| `start_time` / `end_time` | `None` | ×ª××¨×™×›×™ ISO 8601 (×›×•×œ×œ `Z`). ×× ×¡×•×¤×§×• ×©× ×™×”× â€“ ×”× ×’×•×‘×¨×™× ×¢×œ `timerange`. |
| `range` | `None` | Alias ×œ-`timerange` ×¢×‘×•×¨ ×ª××™××•×ª ×œ××¨×›×™×‘×™× ××—×¨×™×. |

×›×œ ×”×˜×¤×¡×™× ×‘×•×•×‘ × ×©×œ×—×™× ×¢× ×”×¤×¨××˜×¨×™× ×”× "×œ, ×›×š ×©×§×¨×™××•×ª ×™×“× ×™×•×ª ×™×ª× ×”×’×• ×–×”×” ×œÖ¾UI.

### `GET /api/observability/alerts`

- **××˜×¨×”:** ×¨×©×™××ª ×”×ª×¨××•×ª ××¤×•×¨×˜×ª ×¢× ×¡×™×›×•××™×, metadata ×•×¤×’'×™× ×¦×™×”.
- **×¤×¨××˜×¨×™× × ×•×¡×¤×™×:**
  - `severity`, `alert_type`, `endpoint`, `search` â€“ ×¡×™× ×•×Ÿ ××“×•×™×§.
  - `page` (×‘×¨×™×¨×ª ××—×“×œ 1) ×•Ö¾`per_page` (×‘×¨×™×¨×ª ××—×“×œ 50, ××§×¡×™××•× 200).

```bash
curl -H 'Accept: application/json' \
  'https://code-keeper-webapp.onrender.com/api/observability/alerts?timerange=24h&severity=critical&page=1&per_page=25'
```

×“×•×’××ª ×ª×’×•×‘×”:

```json
{
  "ok": true,
  "page": 1,
  "per_page": 25,
  "total": 87,
  "alerts": [
    {
      "timestamp": "2025-12-02T08:27:14+00:00",
      "name": "deployment_event",
      "summary": "Render deploy finished",
      "severity": "anomaly",
      "alert_type": "deployment_event",
      "endpoint": "/admin/observability",
      "duration_seconds": 42.1,
      "source": "alerts_storage",
      "silenced": false,
      "metadata": {"request_id": "5c6c...", "actor": "deploy-bot"}
    }
  ]
}
```

### `GET /api/observability/aggregations`

- **××˜×¨×”:** ×§×‘×œ×ª ××’×¨×’×¦×™×•×ª ××”×™×¨×•×ª ×¢×‘×•×¨ ×”×§×œ×¤×™× ×•×”×˜×‘×œ××•×ª ×‘×¤×× ×œ.
- **×¤×¨××˜×¨×™× × ×•×¡×¤×™×:** `limit` (×‘×¨×™×¨×ª ××—×“×œ 5, ×‘×™×Ÿ 1 ×œÖ¾20) ×¢×‘×•×¨ ×›××•×ª × ×§×•×“×•×ª ×”×§×¦×” ×”××™×˜×™×•×ª.

```bash
curl -H 'Accept: application/json' \
  'https://code-keeper-webapp.onrender.com/api/observability/aggregations?timerange=7d&limit=8'
```

```json
{
  "ok": true,
  "summary": {"total": 410, "critical": 32, "anomaly": 11, "deployment": 5},
  "top_slow_endpoints": [
    {"endpoint": "/api/snippets", "method": "POST", "avg_duration": 1.82, "max_duration": 4.91, "count": 54}
  ],
  "deployment_correlation": {
    "avg_spike_during_deployment": 1.37,
    "anomalies_not_related_to_deployment_percent": 62.5
  }
}
```

### `GET /api/observability/timeseries`

- **××˜×¨×”:** ×”×–× ×ª ×”×’×¨×¤×™× ×•××©×™×›×ª ×˜×‘×œ××•×ª Time Series ×œ×›×œ Metric × ×ª××š.
- **×¤×¨××˜×¨×™× × ×•×¡×¤×™×:**
  - `granularity` â€“ ×“×’×™××” ×‘×¤×•×¨××˜ `5m`, `1h`, `6h`, `12h` (×‘×¨×™×¨×ª ××—×“×œ `1h`). ×”×¢×¨×š ××•××¨ ××•×˜×•××˜×™×ª ×œ×©× ×™×•×ª ×•××•×—×–×¨ ×‘×©×“×” `granularity_seconds`.
  - `metric` â€“ ××—×“ ×-`alerts_count`, `response_time`, `error_rate`, `memory_usage_percent`, `cpu_usage_percent`, `disk_usage_percent`, `requests_per_minute` ××• ×›×œ ××˜×¨×™×§×” ×©××•×’×“×¨×ª ×‘×§×•×‘×¥ `config/alert_graph_sources.json` (×‘×¨×™×¨×ª ××—×“×œ `alerts_count`).

```bash
curl -H 'Accept: application/json' \
  'https://code-keeper-webapp.onrender.com/api/observability/timeseries?timerange=30d&granularity=6h&metric=error_rate'
```

```json
{
  "ok": true,
  "metric": "error_rate",
  "granularity_seconds": 21600,
  "data": [
    {"timestamp": "2025-11-30T06:00:00+00:00", "error_rate": 2.1, "count": 1880, "errors": 40},
    {"timestamp": "2025-11-30T12:00:00+00:00", "error_rate": 0.7, "count": 1475, "errors": 10}
  ]
}
```

**×”×¢×¨×”:** ×¢×‘×•×¨ `metric=response_time`/`latency_seconds` ×”××•×‘×™×™×§×˜×™× ××›×™×œ×™× `avg_duration`, `max_duration`, `count`. ×¢×‘×•×¨ ××˜×¨×™×§×•×ª ×—×™×–×•×™ (`memory_usage_percent`, `cpu_usage_percent`, `disk_usage_percent`) ×™×•×—×–×¨ ×©×“×” ×™×—×™×“ `value`. ×¢×‘×•×¨ `alerts_count` ×ª×•×—×–×¨ ×—×œ×•×§×” ×œ×¤×™ ×—×•××¨×” (`critical`, `anomaly`, `warning`, `info`, `total`). ××˜×¨×™×§×•×ª ×©××•×’×“×¨×•×ª ×“×¨×š Graph URL Template ×¦×¨×™×›×•×ª ×œ×”×—×–×™×¨ ××¢×¨×š ×©×œ `{ "timestamp": "...", "value": ... }`.

### `GET /api/observability/replay`

- **××˜×¨×”:** ×¦×™×¨ ×–××Ÿ ×××•×—×“ (×”×ª×¨××•×ª, ×“×™×¤×œ×•×™×× ×˜×™× ×•×¤×¢×•×œ×•×ª ChatOps/Quick Fix) ×œ×˜×•×‘×ª Incident Replay.
- **×¤×¨××˜×¨×™×:** ×–×”×™× ×œ×¤×™×œ×˜×¨×™ ×”×–××Ÿ (`timerange`, `start_time`, `end_time`) + `limit` (×‘×¨×™×¨×ª ××—×“×œ 200).
- **×ª×©×•×‘×”:** `{ "ok": true, "events": [...], "counts": {"alerts": n, "deployments": m, "chatops": k} }`.

### `GET /api/observability/export`

- **××˜×¨×”:** ×”×•×¨×“×ª Snapshot JSON ××œ× (×§×œ×¤×™×, ×˜×‘×œ××•×ª, Time Series ×•×”×™×¡×˜×•×¨×™×™×ª ×”×ª×¨××•×ª) ×œ×¦×•×¨×š ×©×™×œ×•×‘ ×‘-BI ×—×™×¦×•× ×™.
- **×¤×¨××˜×¨×™×:** `timerange` ××• `start_time`/`end_time`, ××•×¤×¦×™×•× ×œ×™ `alerts_limit`.
- **×”×¢×¨×š:** ××—×–×™×¨ ××•×‘×™×™×§×˜ ×¢× `summary`, `top_slow_endpoints`, ×©×œ×•×©×” Timeseries ×•×‘×œ×•×§ `alerts`. ××•××œ×¥ ×œ×©××•×¨ ××ª ×”×§×•×‘×¥ ×›×¤×™ ×©× ×©×œ×— ×•×œ×¦×¨×£ ×œ××™×™×œ×™×/Slack.

### `POST /api/observability/quickfix/track`

- **××˜×¨×”:** ×˜×œ××˜×¨×™×” ×©×œ Quick Fix (××©××©×ª ×’× ×œ×¦×™×¨ ×”×–××Ÿ ×•×’× ×œ×œ×•×’×™×).
- **×§×œ×˜:** `{ "action_id": "...", "action_label": "...", "alert": {"alert_uid": "...", "alert_type": "...", "timestamp": "..."} }`.
- **×”×¢×¨×”:** ×”× ×ª×™×‘ ××—×™×™×‘ Admin ×•× ×¡××š ×¢×œ ×”××™×¤×•×™ ×‘-`config/alert_quick_fixes.json`.

### Graph URL Template ×œ××§×•×¨×•×ª ×—×“×©×™×

- ×”×§×•×‘×¥ `config/alert_graph_sources.json` ×××¤×©×¨ ×œ×¨×©×•× ××§×•×¨×•×ª × ×ª×•× ×™× ×—×™×¦×•× ×™×™× ×œ×’×¨×¤×™ ×”×”×§×©×¨. ×›×œ ×¢×¨×š ×‘××™×œ×•×Ÿ `sources` ××’×“×™×¨ `graph_url_template` ×•×¤×¨×˜×™ ×¤×¢× ×•×—:

```json
{
  "version": 1,
  "sources": {
    "custom_metric": {
      "label": "External CPU %",
      "unit": "%",
      "category": "spike",
      "default_range": "1h",
      "graph_url_template": "https://grafana.example/api/series?metric={{metric_name}}&from={{start_ts_ms}}&to={{end_ts_ms}}",
      "allowed_hosts": ["grafana.example"],
      "timestamp_key": "ts",
      "value_key": "value",
      "headers": {"Authorization": "Bearer ..."},
      "timeout": 5
    }
  }
}
```

- ××©×ª× ×™× × ×ª××›×™× ×‘×˜××¤×œ×™×™×˜: `{{metric_name}}`, `{{start_time}}`, `{{end_time}}`, `{{granularity_seconds}}`, `{{start_ts_ms}}`, `{{end_ts_ms}}`.
- ×”-API ×”×—×™×¦×•× ×™ ×¦×¨×™×š ×œ×”×—×–×™×¨ ××¢×¨×š ×©×œ ×¨×©×•××•×ª ××• ××•×‘×™×™×§×˜ ×¢× `data` ×”××›×™×œ ×¨×©×•××•×ª. ×‘×¨×™×¨×ª ×”××—×“×œ ×”×™× ×œ×—×¤×© ×©×“×•×ª ×‘×©× `timestamp` ×•-`value`, ××š × ×™×ª×Ÿ ×œ×¢×“×›×Ÿ ×‘×¢×–×¨×ª `timestamp_key`/`value_key`.
- ×œ×›×œ ××§×•×¨ ×—×•×‘×” ×œ×”×’×“×™×¨ `allowed_hosts` â€“ ×¨×©×™××ª ×©××•×ª ×“×•××™×™×Ÿ ×××•×©×¨×™×. ×œ×¤× ×™ ×›×œ ×§×¨×™××” × ×•×•×“× ×©×”-URL ×”×¡×•×¤×™ ××©×ª××© ×‘-HTTP/S ×•×©× ×”×××¨×— × ××¦× ×‘×¨×©×™××”, ××—×¨×ª ×”×§×¨×™××” ×ª×™×—×¡× ×›×“×™ ×œ×× ×•×¢ SSRF.
- ×©××•×ª ×”××˜×¨×™×§×•×ª ×¢×¦×× ××©××©×™× ×›Ö¾Allowlist. ××¢×¨×›×ª ×”-WebApp ×ª×‘×¦×¢ ×§×¨×™××” ×—×™×¦×•× ×™×ª ×¨×§ ×× ×”××˜×¨×™×§×” ×”×•×’×“×¨×” ×‘×§×•×‘×¥ ×”×–×”; × ×™×¡×™×•×Ÿ ×œ×‘×§×© ××˜×¨×™×§×” ×©×œ× ×§×™×™××ª ×¤×©×•×˜ ×™×™×—×¡×.
- ×›×š × ×™×ª×Ÿ ×œ×—×‘×¨ Grafana/DataDog/Prometheus JSON API ×‘×œ×™ ×©×™× ×•×™ ×§×•×“: ×× ××™×Ÿ ××˜×¨×™×§×” ×¤× ×™××™×ª, ×”××©×ª××© ×™×¨××” ××ª ×”×”×•×“×¢×” *"No visual data available for this metric"* ×¢×“ ×©×™×•×’×“×¨ Template ××ª××™×.

## ğŸ” ××‘×˜×—×”, Rate Limiting ×•×§××©

- **Admin only:** ×›×œ ×”× ×ª×™×‘×™× ××©×ª××©×™× ×‘-`@login_required` ×•×‘×‘×“×™×§×ª `_require_admin_user`, ×•×œ×›×Ÿ ×¢×œ×™×›× ×œ×•×•×“× ×©×”××©×ª××© ××•×’×“×¨ ×‘Ö¾ENV `ADMIN_USER_IDS`.
- **Rate limiting:** ×‘×¨×™×¨×ª ×”××—×“×œ ×©×œ Flask-Limiter (`50 per hour`, `200 per day` ×œ×›×œ ××©×ª××©) ×—×œ×” ×’× ×¢×œ ×”Ö¾Endpoints ×”×œ×œ×•. ×—×¨×™×’×” ×ª×—×–×™×¨ `429` ×¢× payload ×¡×˜× ×“×¨×˜×™.
- **Caching:** ×©×™×¨×•×ª `services/observability_dashboard` ×©×•××¨ Cache in-memory (alerts â€“ â€120s, aggregations/timeseries â€“ â€150s). ×›×š, ×§×¨×™××•×ª ×¨×¦×™×¤×•×ª ××“×¤×“×£ ×”××¨×™×¥ auto-refresh ×œ× ×™×¢××™×¡×• ×¢×œ MongoDB.
- **Fail-open:** ×× MongoDB ××• Prometheus ××™× × ×–××™× ×™×, ×”××¢×¨×›×ª ×ª×—×–×•×¨ ×œÖ¾`internal_alerts`/××“×“×™× ××—×•×©×‘×™× ×›×“×™ ×œ×× ×•×¢ 500. ×‘××§×¨×” ×›×–×” ×”Ö¾payload ×¢×“×™×™×Ÿ ×™×¡×•××Ÿ `ok: true` ×•×”Ö¾source ×™×”×™×” `buffer`.

## ğŸ”Œ ××™× ×˜×’×¨×¦×™×•×ª ×•×“×•×’×××•×ª ×©×™××•×©

### Grafana / BI

1. ×”×•×¡×™×¤×• Data Source ××¡×•×’ *JSON API* ×•×”×’×“×™×¨×• Header `Cookie: session=...` (××• Reverse Proxy ×©××—×–×™×§ ×¡×©×Ÿ Admin).
2. ×¢×‘×•×¨ ×’×¨×£ stacked alerts â€“ ×‘×¦×¢×• ×§×¨×™××” ×œ-`/api/observability/timeseries?metric=alerts_count` ×¢× `interval` ×“×™× ××™ ×©×××¤×” ×œÖ¾`granularity`.
3. ×¢×‘×•×¨ ×˜×‘×œ×ª × ×§×•×“×•×ª ×§×¦×” â€“ ×”×©×ª××©×• ×‘Ö¾`aggregations.top_slow_endpoints` ×•×”×¦×™×’×• `avg_duration` + `max_duration` ×›×”×ª×¨××” ××”×™×¨×”.

### Slack / On-call Bot

- ×¡×§×¨×™×¤×˜ cron ×™×›×•×œ ×œ××©×•×š ×›×œ ×—××© ×“×§×•×ª ××ª `GET /api/observability/alerts?timerange=1h&severity=critical&per_page=10` ×•×œ×”×–×¨×™× ×”×•×“×¢×” ×œÖ¾Slack ×›××©×¨ `total` ×’×“×œ.
- ×”×•×¡×™×¤×• ×§×™×©×•×¨ ×—×–×¨×” ×œ×“×©×‘×•×¨×“ (`https://code-keeper-webapp.onrender.com/admin/observability`) ×›×“×™ ×©××™ ×©××§×‘×œ ××ª ×”×”×ª×¨××” ×™×•×›×œ ×œ×”×¢××™×§ ×‘×’×¨×¤×™×.

### ×©×™×œ×•×‘ ×¢× Config Radar

- ×œ×¤× ×™ ×©××¢×¨×›×•×ª ×—×™×¦×•× ×™×•×ª ×™×’×™×‘×• ×œ×”×ª×¨××”, ××•××œ×¥ ×œ×•×•×“× ×©×”×§×•× ×¤×™×’×•×¨×¦×™×” ×‘Ö¾[Config Radar](https://github.com/amirbiron/CodeBot/blob/main/GUIDES/CONFIG_RADAR_GUIDE.md) ××¢×•×“×›× ×ª (×œ××©×œ, `immediate_categories`).
- ×”×“×©×‘×•×¨×“ ××¦×™×’ × ×ª×•× ×™ ×××ª; Config Radar × ×•×ª×Ÿ ××ª ×”×¡×›××•×ª. ×©×™××•×© ×‘×©× ×™×”× ×‘×™×—×“ ×××¤×©×¨ ×œ×–×”×•×ª ×”×× ×”×—×¨×™×’×” × ×•×‘×¢×ª ××”×’×“×¨×” ×—×¡×¨×” ××• ×××™×¨×•×¢ ×××™×ª×™.

### ×¨×¤×¨× ×¡ ×œÖ¾README

- ×”Ö¾README ×›×•×œ×œ ×¡×§×™×¨×” ×¢×œ ×›×œ×œ ×™×›×•×œ×•×ª ×”×× ×œ×™×˜×™×§×” (×¡×¢×™×£ "ğŸ“Š × ×™×ª×•×— ×•××‘×—×•×Ÿ"). ××•××œ×¥ ×œ×”×•×¡×™×£ ×§×™×©×•×¨ ×™×©×™×¨ ××ª×•×š README (×¢"×¢ ×¢×“×›×•×Ÿ PR ×–×”) ×›×“×™ ×©×”×§×”×™×œ×” ×ª××¦× ××ª ×”×“×©×‘×•×¨×“ ×’× ××—×•×¥ ×œ×“×•×§×¡.

## âœ”ï¸ ××” ×”×œ××”?

- ×”×¨×—×™×‘×• ××ª ×”Ö¾API ×‘×”×ª×× ×œ×¨×©×™××ª metric-×™× ×—×“×©×” (×œ××©×œ, `db_cpu` ××• `queue_backlog`).
- ×× ××ª× ××©×œ×‘×™× Agent ×—×™×¦×•× ×™ â€“ ×¢×“×™×£ ×œ×”×¡×ª××š ×¢×œ ×”Ö¾API ×”××ª×•×¢×“ ×›××Ÿ ×××©×¨ ×¢×œ scraping ×©×œ HTML.
- × ×©××— ×œ×§×‘×œ Pull Request ×¢× ×¦×™×œ×•××™ ××¡×š ××• ×•×™×“××• ×©×œ ×—×™×‘×•×¨ Grafana/Slack ×›×“×™ ×œ×”×•×¡×™×£ ×œÖ¾Docs.
