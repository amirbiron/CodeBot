[pytest]
# חשוב: לא לשים כאן דגלים של xdist (כמו -n/--dist),
# כי בסביבות מינימליות (requirements/minimal.txt) pytest-xdist לא מותקן ואז pytest נופל על "unrecognized arguments".
# המקביליות מופעלת בצורה חכמה ב-conftest.py (רק אם xdist מותקן) וב-CI הפקודה מפורשת.
addopts = -q --maxfail=1 --disable-warnings --cov=. --cov-config=.coveragerc --cov-report=term-missing --cov-report=xml --cov-fail-under=0
testpaths =
    tests
    .
asyncio_mode = auto

markers =
    performance: בדיקות ביצועים
    heavy: טסטים כבדים (מדולגים כשמבקשים רק קלים)
    smoke: בדיקות smoke מהירות ויציבות שרצות על כל PR
    ui_full: סט בדיקות UI מלא שרץ nightly/לפני deploy
    flaky: בדיקות לא יציבות (לא חוסמות CI עד שמייצבים)
    integration: בדיקות אינטגרציה הדורשות שירותים חיצוניים (למשל MongoDB)

# Global per-test timeout to prevent silent hangs in CI
timeout = 60
timeout_method = thread

